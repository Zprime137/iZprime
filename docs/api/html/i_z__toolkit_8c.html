<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iZ-Library: src/toolkit/iZ_toolkit.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">iZ-Library<span id="projectnumber">&#160;0.0.1</span>
   </div>
   <div id="projectbrief">iZ-Library for prime sieving and generation tasks.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('i_z__toolkit_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">iZ_toolkit.c File Reference<div class="ingroups"><a class="el" href="group__iz__toolkit.html">Toolkit (iZ/iZm)</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of iZ index space helpers and iZm/VX segment machinery.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="i_z__api_8h_source.html">iZ_api.h</a>&gt;</code><br />
</div>
<p><a href="i_z__toolkit_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaffec7a5b407ee6c59ccc1678e0ab89ba" id="r_gaffec7a5b407ee6c59ccc1678e0ab89ba"><td class="memItemLeft">uint64_t&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#gaffec7a5b407ee6c59ccc1678e0ab89ba">iZ</a> (uint64_t x, int i)</td></tr>
<tr class="memdesc:gaffec7a5b407ee6c59ccc1678e0ab89ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes 6x + i for a given x and i.  <br /></td></tr>
<tr class="memitem:gaa3f0472ebd680beaa6b0759acbedd9eb" id="r_gaa3f0472ebd680beaa6b0759acbedd9eb"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a> (mpz_t z, mpz_t x, int i)</td></tr>
<tr class="memdesc:gaa3f0472ebd680beaa6b0759acbedd9eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes 6x + i for arbitrary precision values using GMP.  <br /></td></tr>
<tr class="memitem:adf61955b452b3d1401a90d803999f819" id="r_adf61955b452b3d1401a90d803999f819"><td class="memItemLeft">static int&#160;</td><td class="memItemRight"><a class="el" href="#adf61955b452b3d1401a90d803999f819">compute_k_vx</a> (<a class="el" href="struct_i_z_m.html">IZM</a> *iZm)</td></tr>
<tr class="memdesc:adf61955b452b3d1401a90d803999f819"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count how many small primes (&gt;3) divide vx.  <br /></td></tr>
<tr class="memitem:gacf776a7cedd726d8362aaf344102365d" id="r_gacf776a7cedd726d8362aaf344102365d"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#gacf776a7cedd726d8362aaf344102365d">iZm_construct_vx_base</a> (uint64_t vx, <a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *base_x5, <a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *base_x7)</td></tr>
<tr class="memdesc:gacf776a7cedd726d8362aaf344102365d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build pre-sieved base bitmaps for a VX segment.  <br /></td></tr>
<tr class="memitem:a1cb99e772f16a844ff9f04ffcd3e632f" id="r_a1cb99e772f16a844ff9f04ffcd3e632f"><td class="memItemLeft">static int&#160;</td><td class="memItemRight"><a class="el" href="#a1cb99e772f16a844ff9f04ffcd3e632f">vx_set_base_values</a> (<a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj, char *y_str)</td></tr>
<tr class="memdesc:a1cb99e772f16a844ff9f04ffcd3e632f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize mpz-dependent base fields for a VX segment object.  <br /></td></tr>
<tr class="memitem:a0acf76d4f3ff2e6e4421b9115c694823" id="r_a0acf76d4f3ff2e6e4421b9115c694823"><td class="memItemLeft">static void&#160;</td><td class="memItemRight"><a class="el" href="#a0acf76d4f3ff2e6e4421b9115c694823">vx_det_sieve</a> (<a class="el" href="struct_i_z_m.html">IZM</a> *iZm, <a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj)</td></tr>
<tr class="memdesc:a0acf76d4f3ff2e6e4421b9115c694823"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deterministic phase: mark composites using root primes.  <br /></td></tr>
<tr class="memitem:ae75ea043adeb58f25e079d1b46984d63" id="r_ae75ea043adeb58f25e079d1b46984d63"><td class="memItemLeft">static void&#160;</td><td class="memItemRight"><a class="el" href="#ae75ea043adeb58f25e079d1b46984d63">vx_prob_sieve</a> (<a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj)</td></tr>
<tr class="memdesc:ae75ea043adeb58f25e079d1b46984d63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform probabilistic sieve cleanup for large numeric ranges.  <br /></td></tr>
<tr class="memitem:ga5ada19be750a6f9b0837805ef34a1de4" id="r_ga5ada19be750a6f9b0837805ef34a1de4"><td class="memItemLeft"><a class="el" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a>&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga5ada19be750a6f9b0837805ef34a1de4">range_info_init</a> (<a class="el" href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html">INPUT_SIEVE_RANGE</a> *input_range, int vx)</td></tr>
<tr class="memdesc:ga5ada19be750a6f9b0837805ef34a1de4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map a decimal range input into iZm coordinates and segment bounds.  <br /></td></tr>
<tr class="memitem:gab053af28699e3138640445b16a1311f7" id="r_gab053af28699e3138640445b16a1311f7"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#gab053af28699e3138640445b16a1311f7">range_info_free</a> (<a class="el" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a> *info)</td></tr>
<tr class="memdesc:gab053af28699e3138640445b16a1311f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all GMP fields owned by <code class="param">info</code>.  <br /></td></tr>
<tr id="func-members-0" class="groupHeader"><td colspan="2"><div class="groupHeader">iZ Mapping Helpers</div></td></tr>
<tr class="memitem:ga865e51a5e6f28945747e2ad6988c2e4e" id="r_ga865e51a5e6f28945747e2ad6988c2e4e"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga865e51a5e6f28945747e2ad6988c2e4e">process_iZ_bitmaps</a> (<a class="el" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *primes, <a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *x5, <a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *x7, uint64_t x_limit)</td></tr>
<tr class="memdesc:ga865e51a5e6f28945747e2ad6988c2e4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Traverse iZ bitmaps, emit surviving primes, and mark composites.  <br /></td></tr>
<tr class="memitem:gadc4e21760e38081c6966fa9d9d23e940" id="r_gadc4e21760e38081c6966fa9d9d23e940"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#gadc4e21760e38081c6966fa9d9d23e940">get_root_primes</a> (<a class="el" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *primes, uint64_t limit)</td></tr>
<tr class="memdesc:gadc4e21760e38081c6966fa9d9d23e940"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate primes up to <code class="param">limit</code> for deterministic sieving.  <br /></td></tr>
<tr class="memitem:ga1dbb019b08a42984e1733f0c7c3881a0" id="r_ga1dbb019b08a42984e1733f0c7c3881a0"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga1dbb019b08a42984e1733f0c7c3881a0">check_primality</a> (mpz_t n, int rounds)</td></tr>
<tr class="memdesc:ga1dbb019b08a42984e1733f0c7c3881a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the primality of a number using GMP's probabilistic test.  <br /></td></tr>
<tr id="func-members-1" class="groupHeader"><td colspan="2"><div class="groupHeader">IZM Lifecycle</div></td></tr>
<tr class="memitem:gaeb29a4d0536bb0aa227e230539081d98" id="r_gaeb29a4d0536bb0aa227e230539081d98"><td class="memItemLeft"><a class="el" href="struct_i_z_m.html">IZM</a> *&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#gaeb29a4d0536bb0aa227e230539081d98">iZm_init</a> (size_t vx)</td></tr>
<tr class="memdesc:gaeb29a4d0536bb0aa227e230539081d98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and initialize an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object for a given VX.  <br /></td></tr>
<tr class="memitem:gaa8c21336f708189a8d18f41085468c5c" id="r_gaa8c21336f708189a8d18f41085468c5c"><td class="memItemLeft"><a class="el" href="struct_i_z_m.html">IZM</a> *&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#gaa8c21336f708189a8d18f41085468c5c">iZm_clone</a> (<a class="el" href="struct_i_z_m.html">IZM</a> *src)</td></tr>
<tr class="memdesc:gaa8c21336f708189a8d18f41085468c5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deep-copy an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object for per-worker ownership.  <br /></td></tr>
<tr class="memitem:ga81a316b2719f678e9fbc4ac8c835460c" id="r_ga81a316b2719f678e9fbc4ac8c835460c"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga81a316b2719f678e9fbc4ac8c835460c">iZm_free</a> (<a class="el" href="struct_i_z_m.html">IZM</a> **iZm)</td></tr>
<tr class="memdesc:ga81a316b2719f678e9fbc4ac8c835460c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object and set the caller pointer to NULL.  <br /></td></tr>
<tr id="func-members-2" class="groupHeader"><td colspan="2"><div class="groupHeader">VX Selection Helpers</div></td></tr>
<tr class="memitem:ga6170b19f9022bf256850f1f2ee6dd786" id="r_ga6170b19f9022bf256850f1f2ee6dd786"><td class="memItemLeft">uint64_t&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga6170b19f9022bf256850f1f2ee6dd786">compute_vx_k</a> (int k)</td></tr>
<tr class="memdesc:ga6170b19f9022bf256850f1f2ee6dd786"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate VX_{ <code class="param">k</code> }.  <br /></td></tr>
<tr class="memitem:gac92eb547227979fc0774e0529efa6180" id="r_gac92eb547227979fc0774e0529efa6180"><td class="memItemLeft">uint64_t&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#gac92eb547227979fc0774e0529efa6180">compute_l2_vx</a> (uint64_t n)</td></tr>
<tr class="memdesc:gac92eb547227979fc0774e0529efa6180"><td class="mdescLeft">&#160;</td><td class="mdescRight">Choose VX using an L2-cache-aware heuristic.  <br /></td></tr>
<tr class="memitem:ga23df437281a4315af3cff9b76fab9dd8" id="r_ga23df437281a4315af3cff9b76fab9dd8"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga23df437281a4315af3cff9b76fab9dd8">compute_max_vx</a> (mpz_t vx, int bit_size)</td></tr>
<tr class="memdesc:ga23df437281a4315af3cff9b76fab9dd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute largest VX below 2^bit_size.  <br /></td></tr>
<tr id="func-members-3" class="groupHeader"><td colspan="2"><div class="groupHeader">Modular Hit Solvers</div></td></tr>
<tr class="memitem:ga596920e4772d76fe9dc61a541b282275" id="r_ga596920e4772d76fe9dc61a541b282275"><td class="memItemLeft">uint64_t&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga596920e4772d76fe9dc61a541b282275">iZm_solve_for_x0</a> (int m_id, uint64_t p, uint64_t vx, uint64_t y)</td></tr>
<tr class="memdesc:ga596920e4772d76fe9dc61a541b282275"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve first x-hit of prime <code class="param">p</code> for line <code class="param">m_id</code> in segment y.  <br /></td></tr>
<tr class="memitem:ga3ee0fd9e3f27fd5d30fddfe7d1056c57" id="r_ga3ee0fd9e3f27fd5d30fddfe7d1056c57"><td class="memItemLeft">uint64_t&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga3ee0fd9e3f27fd5d30fddfe7d1056c57">iZm_solve_for_x0_mpz</a> (int m_id, uint64_t p, uint64_t vx, mpz_t y)</td></tr>
<tr class="memdesc:ga3ee0fd9e3f27fd5d30fddfe7d1056c57"><td class="mdescLeft">&#160;</td><td class="mdescRight">GMP variant of <a class="el" href="group__iz__toolkit.html#ga596920e4772d76fe9dc61a541b282275" title="Solve first x-hit of prime p for line m_id in segment y.">iZm_solve_for_x0()</a> for very large y.  <br /></td></tr>
<tr class="memitem:ga50cf18d6528c411820a9b081b13875ca" id="r_ga50cf18d6528c411820a9b081b13875ca"><td class="memItemLeft">int64_t&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga50cf18d6528c411820a9b081b13875ca">iZm_solve_for_y0</a> (int m_id, uint64_t p, uint64_t vx, uint64_t x)</td></tr>
<tr class="memdesc:ga50cf18d6528c411820a9b081b13875ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve first y-hit for fixed x in vertical (vy) scanning.  <br /></td></tr>
<tr id="func-members-4" class="groupHeader"><td colspan="2"><div class="groupHeader">VX Segment Lifecycle and Execution</div></td></tr>
<tr class="memitem:ga234719b01a0e090a1f66ed7766fe6d0f" id="r_ga234719b01a0e090a1f66ed7766fe6d0f"><td class="memItemLeft"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga234719b01a0e090a1f66ed7766fe6d0f">vx_init</a> (<a class="el" href="struct_i_z_m.html">IZM</a> *iZm, int start_x, int end_x, char *y_str, int mr_rounds)</td></tr>
<tr class="memdesc:ga234719b01a0e090a1f66ed7766fe6d0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize and deterministically sieve one VX segment.  <br /></td></tr>
<tr class="memitem:ga89a2804cb4fa979a32e4213ade786ec4" id="r_ga89a2804cb4fa979a32e4213ade786ec4"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga89a2804cb4fa979a32e4213ade786ec4">vx_free</a> (<a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> **vx_obj)</td></tr>
<tr class="memdesc:ga89a2804cb4fa979a32e4213ade786ec4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a VX segment and all owned resources.  <br /></td></tr>
<tr class="memitem:ga824821f174cc26db2d310a68e8c2f19e" id="r_ga824821f174cc26db2d310a68e8c2f19e"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga824821f174cc26db2d310a68e8c2f19e">vx_collect_p_gaps</a> (<a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj)</td></tr>
<tr class="memdesc:ga824821f174cc26db2d310a68e8c2f19e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract prime-gap encoding from a fully sieved segment.  <br /></td></tr>
<tr class="memitem:ga214f95ac7b685a7ff0c596afc70036b7" id="r_ga214f95ac7b685a7ff0c596afc70036b7"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga214f95ac7b685a7ff0c596afc70036b7">vx_full_sieve</a> (<a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj, int collect_p_gaps)</td></tr>
<tr class="memdesc:ga214f95ac7b685a7ff0c596afc70036b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Complete segment processing (probabilistic stage and optional gaps).  <br /></td></tr>
<tr class="memitem:ga591a1d1fae4f8a241c6b6ed7f495eae6" id="r_ga591a1d1fae4f8a241c6b6ed7f495eae6"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga591a1d1fae4f8a241c6b6ed7f495eae6">vx_stream</a> (<a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj, FILE *output)</td></tr>
<tr class="memdesc:ga591a1d1fae4f8a241c6b6ed7f495eae6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stream segment primes to an output stream.  <br /></td></tr>
<tr id="func-members-5" class="groupHeader"><td colspan="2"><div class="groupHeader">Random Prime Search Routines</div></td></tr>
<tr class="memitem:ga02e061a03533010221ce47c043ddc53c" id="r_ga02e061a03533010221ce47c043ddc53c"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga02e061a03533010221ce47c043ddc53c">vx_search_prime</a> (mpz_t p, int m_id, int vx, int bit_size)</td></tr>
<tr class="memdesc:ga02e061a03533010221ce47c043ddc53c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Horizontal iZm/VX random-prime search.  <br /></td></tr>
<tr class="memitem:ga58ea9ced15462006d8a8c223719c57f4" id="r_ga58ea9ced15462006d8a8c223719c57f4"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="group__iz__toolkit.html#ga58ea9ced15462006d8a8c223719c57f4">vy_search_prime</a> (mpz_t p, int m_id, mpz_t vx)</td></tr>
<tr class="memdesc:ga58ea9ced15462006d8a8c223719c57f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vertical iZm/VY random-prime search.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad55dff6a86df70d0e1e02c66a4344968" id="r_ad55dff6a86df70d0e1e02c66a4344968"><td class="memItemLeft">static const int&#160;</td><td class="memItemRight"><a class="el" href="#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a> []</td></tr>
<tr class="memitem:aa724ea8ac82fc99775f39770db26538d" id="r_aa724ea8ac82fc99775f39770db26538d"><td class="memItemLeft">static int&#160;</td><td class="memItemRight"><a class="el" href="#aa724ea8ac82fc99775f39770db26538d">s_primes_count</a> = sizeof(<a class="el" href="#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a>) / sizeof(int)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of iZ index space helpers and iZm/VX segment machinery. </p>

<p class="definition">Definition in file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="adf61955b452b3d1401a90d803999f819" name="adf61955b452b3d1401a90d803999f819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf61955b452b3d1401a90d803999f819">&#9670;&#160;</a></span>compute_k_vx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int compute_k_vx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_i_z_m.html">IZM</a> *</td>          <td class="paramname"><span class="paramname"><em>iZm</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Count how many small primes (&gt;3) divide vx. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iZm</td><td>Initialized toolkit context. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of pre-sieved small primes encoded in vx. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00052">52</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="i_z__toolkit_8c_source.html#l00010">s_primes</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00086">IZM::vx</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00184">iZm_init()</a>.</p>

</div>
</div>
<a id="a0acf76d4f3ff2e6e4421b9115c694823" name="a0acf76d4f3ff2e6e4421b9115c694823"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0acf76d4f3ff2e6e4421b9115c694823">&#9670;&#160;</a></span>vx_det_sieve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void vx_det_sieve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_i_z_m.html">IZM</a> *</td>          <td class="paramname"><span class="paramname"><em>iZm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *</td>          <td class="paramname"><span class="paramname"><em>vx_obj</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deterministic phase: mark composites using root primes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iZm</td><td>Toolkit context containing root-prime table and base bitmaps. </td></tr>
    <tr><td class="paramname">vx_obj</td><td>Segment object to update. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00566">566</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="int__arrays_8h_source.html#l00043">UI64_ARRAY::array</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00198">VX_SEG::bit_ops</a>, <a class="el" href="bitmap_8c_source.html#l00233">bitmap_clear_steps_simd()</a>, <a class="el" href="bitmap_8c_source.html#l00137">bitmap_get_bit()</a>, <a class="el" href="int__arrays_8h_source.html#l00042">UI64_ARRAY::count</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00193">VX_SEG::end_x</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00190">VX_SEG::is_large_limit</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00415">iZm_solve_for_x0()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00449">iZm_solve_for_x0_mpz()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00087">IZM::k_vx</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00196">VX_SEG::p_count</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00189">VX_SEG::root_limit</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00090">IZM::root_primes</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00192">VX_SEG::start_x</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00186">VX_SEG::vx</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00194">VX_SEG::x5</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00195">VX_SEG::x7</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00187">VX_SEG::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00713">vx_init()</a>.</p>

</div>
</div>
<a id="ae75ea043adeb58f25e079d1b46984d63" name="ae75ea043adeb58f25e079d1b46984d63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae75ea043adeb58f25e079d1b46984d63">&#9670;&#160;</a></span>vx_prob_sieve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void vx_prob_sieve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *</td>          <td class="paramname"><span class="paramname"><em>vx_obj</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform probabilistic sieve cleanup for large numeric ranges. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx_obj</td><td>Segment object containing deterministic survivors. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00633">633</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="bitmap_8c_source.html#l00159">bitmap_clear_bit()</a>, <a class="el" href="bitmap_8c_source.html#l00137">bitmap_get_bit()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00153">check_primality()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00193">VX_SEG::end_x</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00190">VX_SEG::is_large_limit</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00037">iZ_mpz()</a>, <a class="el" href="group__iz__logger.html#ga49528dc2f0c8d5628f13358382f8d5b4">log_info()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00191">VX_SEG::mr_rounds</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00196">VX_SEG::p_count</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00199">VX_SEG::p_test_ops</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00192">VX_SEG::start_x</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00194">VX_SEG::x5</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00195">VX_SEG::x7</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00188">VX_SEG::yvx</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00847">vx_full_sieve()</a>.</p>

</div>
</div>
<a id="a1cb99e772f16a844ff9f04ffcd3e632f" name="a1cb99e772f16a844ff9f04ffcd3e632f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cb99e772f16a844ff9f04ffcd3e632f">&#9670;&#160;</a></span>vx_set_base_values()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int vx_set_base_values </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *</td>          <td class="paramname"><span class="paramname"><em>vx_obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>y_str</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize mpz-dependent base fields for a VX segment object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx_obj</td><td>Segment object to populate. </td></tr>
    <tr><td class="paramname">y_str</td><td>Decimal y-coordinate for the segment. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success, 0 on parse/initialization failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00529">529</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="i_z__toolkit_8h_source.html#l00190">VX_SEG::is_large_limit</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00037">iZ_mpz()</a>, <a class="el" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00189">VX_SEG::root_limit</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00186">VX_SEG::vx</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00187">VX_SEG::y</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00188">VX_SEG::yvx</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00713">vx_init()</a>.</p>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="ad55dff6a86df70d0e1e02c66a4344968" name="ad55dff6a86df70d0e1e02c66a4344968"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad55dff6a86df70d0e1e02c66a4344968">&#9670;&#160;</a></span>s_primes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int s_primes[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41,</div>
<div class="line">     43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97}</div>
</div><!-- fragment --><p>Small primes used to compute and construct wheel structures. </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00010">10</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00052">compute_k_vx()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00306">compute_l2_vx()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00286">compute_vx_k()</a>, and <a class="el" href="i_z__toolkit_8c_source.html#l00363">iZm_construct_vx_base()</a>.</p>

</div>
</div>
<a id="aa724ea8ac82fc99775f39770db26538d" name="aa724ea8ac82fc99775f39770db26538d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa724ea8ac82fc99775f39770db26538d">&#9670;&#160;</a></span>s_primes_count</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int s_primes_count = sizeof(<a class="el" href="#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a>) / sizeof(int)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of entries available in <span class="tt"><a class="el" href="#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a></span>. </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00013">13</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00363">iZm_construct_vx_base()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>src</b></li><li class="navelem"><b>toolkit</b></li><li class="navelem"><a href="i_z__toolkit_8c.html">iZ_toolkit.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
