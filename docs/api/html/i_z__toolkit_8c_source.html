<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iZ-Library: src/toolkit/iZ_toolkit.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">iZ-Library<span id="projectnumber">&#160;0.0.1</span>
   </div>
   <div id="projectbrief">iZ-Library for prime sieving and generation tasks.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('i_z__toolkit_8c_source.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">iZ_toolkit.c</div></div>
</div><!--header-->
<div class="contents">
<a href="i_z__toolkit_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;<a class="code" href="i_z__api_8h.html">iZ_api.h</a>&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span></div>
<div class="foldopen" id="foldopen00010" data-start="{" data-end="};">
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno"><a class="line" href="i_z__toolkit_8c.html#ad55dff6a86df70d0e1e02c66a4344968">   10</a></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="i_z__toolkit_8c.html#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a>[] = {2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41,</div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>                               43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97};</div>
</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno"><a class="line" href="i_z__toolkit_8c.html#aa724ea8ac82fc99775f39770db26538d">   13</a></span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="i_z__toolkit_8c.html#aa724ea8ac82fc99775f39770db26538d">s_primes_count</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="i_z__toolkit_8c.html#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a>) / <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>);</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span></div>
<div class="foldopen" id="foldopen00024" data-start="{" data-end="}">
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#gaffec7a5b407ee6c59ccc1678e0ab89ba">   24</a></span><span class="keyword">inline</span> uint64_t <a class="code hl_function" href="group__iz__toolkit.html#gaffec7a5b407ee6c59ccc1678e0ab89ba">iZ</a>(uint64_t x, <span class="keywordtype">int</span> i)</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>{</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    <span class="keywordflow">return</span> 6 * x + i;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>}</div>
</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span></div>
<div class="foldopen" id="foldopen00037" data-start="{" data-end="}">
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">   37</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a>(mpz_t z, mpz_t x, <span class="keywordtype">int</span> i)</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>{</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    mpz_mul_ui(z, x, 6); <span class="comment">// z = 6 * x</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>        mpz_add_ui(z, z, i); <span class="comment">// z = z + i</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>        mpz_sub_ui(z, z, -i); <span class="comment">// z = z - i</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>}</div>
</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span></div>
<div class="foldopen" id="foldopen00052" data-start="{" data-end="}">
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno"><a class="line" href="i_z__toolkit_8c.html#adf61955b452b3d1401a90d803999f819">   52</a></span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code hl_function" href="i_z__toolkit_8c.html#adf61955b452b3d1401a90d803999f819">compute_k_vx</a>(<a class="code hl_struct" href="struct_i_z_m.html">IZM</a> *iZm)</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>{</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    <span class="keywordtype">int</span> k = 0;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    <span class="keywordflow">while</span> (iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#ac5d6cad1cb4e3d7b6c4ef7a999283615">vx</a> % <a class="code hl_variable" href="i_z__toolkit_8c.html#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a>[k + 2] == 0)</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    {</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>        k++;</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    }</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <span class="keywordflow">return</span> k;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>}</div>
</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span></div>
<div class="foldopen" id="foldopen00070" data-start="{" data-end="}">
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga865e51a5e6f28945747e2ad6988c2e4e">   70</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#ga865e51a5e6f28945747e2ad6988c2e4e">process_iZ_bitmaps</a>(<a class="code hl_struct" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *primes, <a class="code hl_struct" href="struct_b_i_t_m_a_p.html">BITMAP</a> *x5, <a class="code hl_struct" href="struct_b_i_t_m_a_p.html">BITMAP</a> *x7, uint64_t x_limit)</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>{</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    uint64_t root_limit = sqrt(6 * x_limit) + 1;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <span class="comment">// Iterate through x values in range 0 &lt; x &lt; x_n</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    <span class="keywordflow">for</span> (uint64_t x = 1; x &lt; x_limit; x++)</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    {</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        <span class="comment">// if x5[x], implying it&#39;s iZ- prime</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(x5, x))</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        {</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            uint64_t p = <a class="code hl_function" href="group__iz__toolkit.html#gaffec7a5b407ee6c59ccc1678e0ab89ba">iZ</a>(x, -1); <span class="comment">// compute p = iZ(x, -1)</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>            <a class="code hl_function" href="group__iz__arrays.html#ga51cf8a13f4a4ae5c076a1be3a3333a68">ui64_push</a>(primes, p);   <span class="comment">// add p to primes</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            <span class="comment">// if p is root prime, mark its multiples in x5, x7</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>            <span class="keywordflow">if</span> (p &lt; root_limit)</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>            {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>                <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(x5, p, p * x + x, x_limit);</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>                <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(x7, p, p * x - x, x_limit);</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>            }</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        }</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        <span class="comment">// Do the same if x7[x], inverting the xp signs</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(x7, x))</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        {</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>            uint64_t p = <a class="code hl_function" href="group__iz__toolkit.html#gaffec7a5b407ee6c59ccc1678e0ab89ba">iZ</a>(x, 1);</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>            <a class="code hl_function" href="group__iz__arrays.html#ga51cf8a13f4a4ae5c076a1be3a3333a68">ui64_push</a>(primes, p);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>            <span class="keywordflow">if</span> (p &lt; root_limit)</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>            {</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>                <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(x5, p, p * x - x, x_limit);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>                <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(x7, p, p * x + x, x_limit);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>            }</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>        }</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    }</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>}</div>
</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span></div>
<div class="foldopen" id="foldopen00112" data-start="{" data-end="}">
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#gadc4e21760e38081c6966fa9d9d23e940">  112</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#gadc4e21760e38081c6966fa9d9d23e940">get_root_primes</a>(<a class="code hl_struct" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *primes, uint64_t limit)</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>{</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    <span class="comment">// Add 2, 3 to primes</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    <a class="code hl_function" href="group__iz__arrays.html#ga51cf8a13f4a4ae5c076a1be3a3333a68">ui64_push</a>(primes, 2);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    <a class="code hl_function" href="group__iz__arrays.html#ga51cf8a13f4a4ae5c076a1be3a3333a68">ui64_push</a>(primes, 3);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    <span class="comment">// Calculate x_n, max x value in iZ space for given n</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    uint64_t x_n = limit / 6 + 1;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    <span class="comment">// Create bitmap X-Arrays x5, x7, each of size x_n + 1 bits</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    <a class="code hl_struct" href="struct_b_i_t_m_a_p.html">BITMAP</a> *x5 = <a class="code hl_function" href="group__iz__bitmap.html#ga165a40f31d911d8939771e064e2b87c1">bitmap_init</a>(x_n + 1, 1);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    <a class="code hl_struct" href="struct_b_i_t_m_a_p.html">BITMAP</a> *x7 = <a class="code hl_function" href="group__iz__bitmap.html#ga165a40f31d911d8939771e064e2b87c1">bitmap_init</a>(x_n + 1, 1);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <span class="comment">// Memory allocation failed, check logs</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="keywordflow">if</span> (!x5 || !x7)</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    {</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>        <a class="code hl_function" href="group__iz__arrays.html#gab1a0ced5e600649da6e519693a3a2851">ui64_free</a>(&amp;primes);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    }</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span> </div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <span class="comment">// Sieve logic: mark composites and collect primes up to limit</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <a class="code hl_function" href="group__iz__toolkit.html#ga865e51a5e6f28945747e2ad6988c2e4e">process_iZ_bitmaps</a>(primes, x5, x7, x_n);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="comment">// Cleanup: free memory of x5, x7</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    <a class="code hl_function" href="group__iz__bitmap.html#ga66cb254c9bf38d7adfe83d723baa2e15">bitmap_free</a>(&amp;x5);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <a class="code hl_function" href="group__iz__bitmap.html#ga66cb254c9bf38d7adfe83d723baa2e15">bitmap_free</a>(&amp;x7);</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>}</div>
</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span></div>
<div class="foldopen" id="foldopen00153" data-start="{" data-end="}">
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga1dbb019b08a42984e1733f0c7c3881a0">  153</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group__iz__toolkit.html#ga1dbb019b08a42984e1733f0c7c3881a0">check_primality</a>(mpz_t n, <span class="keywordtype">int</span> rounds)</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>{</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    <span class="comment">// GMP&#39;s mpz_probab_prime_p returns:</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="comment">// 0 if n is composite,</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    <span class="comment">// 1 if n is probably prime (without being certain),</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    <span class="comment">// 2 if n is definitely prime (only for small n).</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <span class="keywordtype">int</span> is_prime = mpz_probab_prime_p(n, rounds);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <span class="comment">// ToDo: implement Baillieâ€“PSW primality test for a deterministic alternative to Miller-Rabin, which would return a boolean result instead of a probability.</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <span class="keywordflow">return</span> is_prime;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>}</div>
</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span><span class="comment">// =========================================================</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span><span class="comment">// * iZm structure:</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span><span class="comment">// =========================================================</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span></div>
<div class="foldopen" id="foldopen00184" data-start="{" data-end="}">
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#gaeb29a4d0536bb0aa227e230539081d98">  184</a></span><a class="code hl_struct" href="struct_i_z_m.html">IZM</a> *<a class="code hl_function" href="group__iz__toolkit.html#gaeb29a4d0536bb0aa227e230539081d98">iZm_init</a>(<span class="keywordtype">size_t</span> vx)</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>{</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="comment">// validate vx</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    assert(vx &gt;= 35 &amp;&amp; <span class="stringliteral">&quot;vx must be at least 35.&quot;</span>);</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <a class="code hl_struct" href="struct_i_z_m.html">IZM</a> *iZm = malloc(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct_i_z_m.html">IZM</a>));</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <span class="keywordflow">if</span> (!iZm)</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    {</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        <a class="code hl_function" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error</a>(<span class="stringliteral">&quot;Memory allocation failed for iZm.&quot;</span>);</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    }</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#ac5d6cad1cb4e3d7b6c4ef7a999283615">vx</a> = vx;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="comment">// get root primes for deterministic sieving</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a> = <a class="code hl_function" href="group__iz__api.html#gaeff7d8923d54b5d606c51301bc9bc0e7">SiZ</a>(vx);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    <span class="comment">// iZm-&gt;root_primes = root_limit &lt; pow(10, 7) ? SiZ(root_limit) : SiZm(root_limit);</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="keywordflow">if</span> (!iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a>)</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    {</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        <a class="code hl_function" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error</a>(<span class="stringliteral">&quot;Root primes generation failed for iZm.&quot;</span>);</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        free(iZm);</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    }</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#aa0cd5920cd875d959ee2c40b7c845382">k_vx</a> = <a class="code hl_function" href="i_z__toolkit_8c.html#adf61955b452b3d1401a90d803999f819">compute_k_vx</a>(iZm);</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <span class="comment">// initialize base bitmaps</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afbda5590cfc085366c41769a8054fcde">base_x5</a> = <a class="code hl_function" href="group__iz__bitmap.html#ga165a40f31d911d8939771e064e2b87c1">bitmap_init</a>(vx + 10, 1);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afe3d89b8ae3ad315e952093c945e1073">base_x7</a> = <a class="code hl_function" href="group__iz__bitmap.html#ga165a40f31d911d8939771e064e2b87c1">bitmap_init</a>(vx + 10, 1);</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <span class="keywordflow">if</span> (!iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afbda5590cfc085366c41769a8054fcde">base_x5</a> || !iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afe3d89b8ae3ad315e952093c945e1073">base_x7</a>)</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    {</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        <a class="code hl_function" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error</a>(<span class="stringliteral">&quot;Bitmap initialization failed for iZm base segment.&quot;</span>);</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>        <a class="code hl_function" href="group__iz__toolkit.html#ga81a316b2719f678e9fbc4ac8c835460c">iZm_free</a>(&amp;iZm);</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>        <a class="code hl_function" href="group__iz__arrays.html#gab1a0ced5e600649da6e519693a3a2851">ui64_free</a>(&amp;iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a>);</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    }</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <span class="comment">// construct pre-sieved base_x5, base_x7 bitmaps</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    <a class="code hl_function" href="group__iz__toolkit.html#gacf776a7cedd726d8362aaf344102365d">iZm_construct_vx_base</a>(vx, iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afbda5590cfc085366c41769a8054fcde">base_x5</a>, iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afe3d89b8ae3ad315e952093c945e1073">base_x7</a>);</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <span class="keywordflow">return</span> iZm;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>}</div>
</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span></div>
<div class="foldopen" id="foldopen00232" data-start="{" data-end="}">
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#gaa8c21336f708189a8d18f41085468c5c">  232</a></span><a class="code hl_struct" href="struct_i_z_m.html">IZM</a> *<a class="code hl_function" href="group__iz__toolkit.html#gaa8c21336f708189a8d18f41085468c5c">iZm_clone</a>(<a class="code hl_struct" href="struct_i_z_m.html">IZM</a> *src)</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>{</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    assert(src &amp;&amp; <span class="stringliteral">&quot;Invalid source IZM structure for cloning.&quot;</span>);</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    <a class="code hl_struct" href="struct_i_z_m.html">IZM</a> *clone = malloc(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct_i_z_m.html">IZM</a>));</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    assert(clone &amp;&amp; <span class="stringliteral">&quot;Memory allocation failed for iZm clone.&quot;</span>);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    clone-&gt;<a class="code hl_variable" href="struct_i_z_m.html#ac5d6cad1cb4e3d7b6c4ef7a999283615">vx</a> = src-&gt;<a class="code hl_variable" href="struct_i_z_m.html#ac5d6cad1cb4e3d7b6c4ef7a999283615">vx</a>;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    clone-&gt;<a class="code hl_variable" href="struct_i_z_m.html#aa0cd5920cd875d959ee2c40b7c845382">k_vx</a> = src-&gt;<a class="code hl_variable" href="struct_i_z_m.html#aa0cd5920cd875d959ee2c40b7c845382">k_vx</a>;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    clone-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a> = <a class="code hl_function" href="group__iz__arrays.html#gaf9ef1b739df3c37089c62c7f1adbfdce">ui64_init</a>(src-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a>-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a9579279ed0a82bc8e7e36365d8dc03df">capacity</a>);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    <span class="keywordflow">if</span> (clone-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a> == NULL)</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    {</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>        <a class="code hl_function" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error</a>(<span class="stringliteral">&quot;Memory allocation failed for root primes in iZm clone.&quot;</span>);</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        <a class="code hl_function" href="group__iz__toolkit.html#ga81a316b2719f678e9fbc4ac8c835460c">iZm_free</a>(&amp;clone);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    }</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <span class="comment">// copy root primes</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    memcpy(clone-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a>-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a337d001ba534fed8a25bb9b80351f332">array</a>, src-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a>-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a337d001ba534fed8a25bb9b80351f332">array</a>, src-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a>-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a5eb007453bedeebe1332d5c2dddaa7c8">count</a> * <span class="keyword">sizeof</span>(uint64_t));</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    clone-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a>-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a5eb007453bedeebe1332d5c2dddaa7c8">count</a> = src-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a>-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a5eb007453bedeebe1332d5c2dddaa7c8">count</a>;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    <span class="comment">// clone base bitmaps</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    clone-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afbda5590cfc085366c41769a8054fcde">base_x5</a> = <a class="code hl_function" href="group__iz__bitmap.html#gabc118534bd59159ed55c509bd1b795e9">bitmap_clone</a>(src-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afbda5590cfc085366c41769a8054fcde">base_x5</a>);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    clone-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afe3d89b8ae3ad315e952093c945e1073">base_x7</a> = <a class="code hl_function" href="group__iz__bitmap.html#gabc118534bd59159ed55c509bd1b795e9">bitmap_clone</a>(src-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afe3d89b8ae3ad315e952093c945e1073">base_x7</a>);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    <span class="keywordflow">return</span> clone;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>}</div>
</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span></div>
<div class="foldopen" id="foldopen00266" data-start="{" data-end="}">
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga81a316b2719f678e9fbc4ac8c835460c">  266</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#ga81a316b2719f678e9fbc4ac8c835460c">iZm_free</a>(<a class="code hl_struct" href="struct_i_z_m.html">IZM</a> **iZm)</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>{</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <span class="keywordflow">if</span> (iZm == NULL || *iZm == NULL)</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    <span class="comment">// Free root primes object allocated in iZm_init</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <a class="code hl_function" href="group__iz__arrays.html#gab1a0ced5e600649da6e519693a3a2851">ui64_free</a>(&amp;(*iZm)-&gt;root_primes);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    <a class="code hl_function" href="group__iz__bitmap.html#ga66cb254c9bf38d7adfe83d723baa2e15">bitmap_free</a>(&amp;(*iZm)-&gt;base_x5);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <a class="code hl_function" href="group__iz__bitmap.html#ga66cb254c9bf38d7adfe83d723baa2e15">bitmap_free</a>(&amp;(*iZm)-&gt;base_x7);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    free(*iZm);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    *iZm = NULL;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>}</div>
</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span></div>
<div class="foldopen" id="foldopen00286" data-start="{" data-end="}">
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga6170b19f9022bf256850f1f2ee6dd786">  286</a></span>uint64_t <a class="code hl_function" href="group__iz__toolkit.html#ga6170b19f9022bf256850f1f2ee6dd786">compute_vx_k</a>(<span class="keywordtype">int</span> k)</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>{</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    uint64_t vx = 1;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>    k += 2;    <span class="comment">// adjust k to account for skipping 2 and 3</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    <span class="keywordtype">int</span> i = 2; <span class="comment">// start from prime 5</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span> </div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    <span class="keywordflow">while</span> (i &lt; k &amp;&amp; <a class="code hl_variable" href="i_z__toolkit_8c.html#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a>[i] * vx &lt; UINT64_MAX)</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    {</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>        vx *= <a class="code hl_variable" href="i_z__toolkit_8c.html#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a>[i++];</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    }</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    <span class="keywordflow">return</span> vx;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>}</div>
</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span></div>
<div class="foldopen" id="foldopen00306" data-start="{" data-end="}">
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#gac92eb547227979fc0774e0529efa6180">  306</a></span>uint64_t <a class="code hl_function" href="group__iz__toolkit.html#gac92eb547227979fc0774e0529efa6180">compute_l2_vx</a>(uint64_t n)</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>{</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    uint64_t l2 = <a class="code hl_function" href="group__iz__utils.html#gac79290998392d17d4420f651f7ad31e9">get_cpu_L2_cache_size_bits</a>();</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    uint64_t x_n = n / 6;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    uint64_t vx = 35; <span class="comment">// minimum useful vx size</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <span class="keywordtype">int</span> k = 4;        <span class="comment">// pointing to prime 11 in s_primes</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    <span class="comment">// while vx * k-th prime doesn&#39;t exceed x_n and l2 cache size</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    <span class="keywordflow">while</span> (vx * <a class="code hl_variable" href="i_z__toolkit_8c.html#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a>[k] &lt; <a class="code hl_define" href="group__iz__utils.html#ga3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(l2, x_n))</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    {</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>        vx *= <a class="code hl_variable" href="i_z__toolkit_8c.html#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a>[k];</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        k++;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    }</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span> </div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <span class="keywordflow">return</span> vx;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>}</div>
</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span></div>
<div class="foldopen" id="foldopen00331" data-start="{" data-end="}">
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga23df437281a4315af3cff9b76fab9dd8">  331</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#ga23df437281a4315af3cff9b76fab9dd8">compute_max_vx</a>(mpz_t vx, <span class="keywordtype">int</span> bit_size)</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>{</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <span class="comment">// get some primes to compute the primorial vx</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <a class="code hl_struct" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *primes = <a class="code hl_function" href="group__iz__api.html#gaeff7d8923d54b5d606c51301bc9bc0e7">SiZ</a>(10000);</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    assert(primes &amp;&amp; <span class="stringliteral">&quot;Failed to generate primes&quot;</span>);</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="keywordtype">int</span> i = 2;                        <span class="comment">// to skip 2, 3</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    mpz_set_ui(vx, primes-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a337d001ba534fed8a25bb9b80351f332">array</a>[i]); <span class="comment">// set vx = 5</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <span class="comment">// while vx * primes-&gt;array[i] &lt; 2^bit_size</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    <span class="keywordflow">while</span> (mpz_sizeinbase(vx, 2) &lt; (<span class="keywordtype">size_t</span>)bit_size)</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    {</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        i++;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        mpz_mul_ui(vx, vx, primes-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a337d001ba534fed8a25bb9b80351f332">array</a>[i]);</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    }</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    mpz_div_ui(vx, vx, primes-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a337d001ba534fed8a25bb9b80351f332">array</a>[i]); <span class="comment">// divide by the last prime</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>}</div>
</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span></div>
<div class="foldopen" id="foldopen00363" data-start="{" data-end="}">
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#gacf776a7cedd726d8362aaf344102365d">  363</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#gacf776a7cedd726d8362aaf344102365d">iZm_construct_vx_base</a>(uint64_t vx, <a class="code hl_struct" href="struct_b_i_t_m_a_p.html">BITMAP</a> *base_x5, <a class="code hl_struct" href="struct_b_i_t_m_a_p.html">BITMAP</a> *base_x7)</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>{</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    assert(base_x5 &amp;&amp; base_x7 &amp;&amp; <span class="stringliteral">&quot;Invalid bitmaps passed to iZm_construct_vx_base.&quot;</span>);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    <a class="code hl_function" href="group__iz__bitmap.html#gad0afb1000bb11c5aca082e45f813ded2">bitmap_set_all</a>(base_x5);</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    <a class="code hl_function" href="group__iz__bitmap.html#gad0afb1000bb11c5aca082e45f813ded2">bitmap_set_all</a>(base_x7);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    <a class="code hl_function" href="group__iz__bitmap.html#ga958df9e667d4516791537c988fb01999">bitmap_clear_bit</a>(base_x5, 0); <span class="comment">// clear the 0th bit</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <a class="code hl_function" href="group__iz__bitmap.html#ga958df9e667d4516791537c988fb01999">bitmap_clear_bit</a>(base_x7, 0); <span class="comment">// clear the 0th bit</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    <span class="comment">// iterate through small primes that divide vx</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt; <a class="code hl_variable" href="i_z__toolkit_8c.html#aa724ea8ac82fc99775f39770db26538d">s_primes_count</a>; i++)</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    {</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        <span class="keywordtype">int</span> p = <a class="code hl_variable" href="i_z__toolkit_8c.html#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a>[i];</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        <span class="keywordflow">if</span> (vx % p != 0)</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        <span class="keywordtype">int</span> ip = (p % 6 == 1) ? 1 : -1;</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>        <span class="keywordtype">int</span> xp = (p + 1) / 6;</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>        <span class="comment">// clear composites in iZ- and iZ+</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        <span class="keywordflow">if</span> (ip == -1)</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        {</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga958df9e667d4516791537c988fb01999">bitmap_clear_bit</a>(base_x5, xp);                        <span class="comment">// clear the prime itself</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(base_x5, p, p * xp + xp, vx); <span class="comment">// mark composites in iZ-</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(base_x7, p, p * xp - xp, vx); <span class="comment">// mark composites in iZ+</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>        }</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        {</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga958df9e667d4516791537c988fb01999">bitmap_clear_bit</a>(base_x7, xp);                        <span class="comment">// clear the prime itself</span></div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(base_x5, p, p * xp - xp, vx); <span class="comment">// mark composites in iZ-</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(base_x7, p, p * xp + xp, vx); <span class="comment">// mark composites in iZ+</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>        }</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    }</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>}</div>
</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span></div>
<div class="foldopen" id="foldopen00415" data-start="{" data-end="}">
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga596920e4772d76fe9dc61a541b282275">  415</a></span>uint64_t <a class="code hl_function" href="group__iz__toolkit.html#ga596920e4772d76fe9dc61a541b282275">iZm_solve_for_x0</a>(<span class="keywordtype">int</span> m_id, uint64_t p, uint64_t vx, uint64_t y)</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>{</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    uint64_t xp = (p + 1) / 6;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    <span class="keywordtype">int</span> ip = (p % 6 == 1) ? 1 : -1;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <span class="comment">// Immediate solution check for y = 0</span></div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    <span class="keywordflow">if</span> (y == 0)</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    {</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        <span class="comment">// compute p * xp + m_id * ip * xp</span></div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>        <span class="keywordflow">return</span> p * xp + m_id * ip * xp;</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    }</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span> </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    <span class="comment">// Normalize x_p to x_p if p_id = m_id, else to p - x_p</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    xp = (m_id == ip) ? xp : p - xp;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    uint64_t yvx = vx * y;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span> </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    <span class="comment">// Compute the first composite hit of p in the yth vx segment in iZm index space</span></div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    uint64_t x = p &lt; vx ? p - (yvx - xp) % p : (yvx - xp) % p;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <span class="keywordflow">return</span> x;</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>}</div>
</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span></div>
<div class="foldopen" id="foldopen00449" data-start="{" data-end="}">
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga3ee0fd9e3f27fd5d30fddfe7d1056c57">  449</a></span>uint64_t <a class="code hl_function" href="group__iz__toolkit.html#ga3ee0fd9e3f27fd5d30fddfe7d1056c57">iZm_solve_for_x0_mpz</a>(<span class="keywordtype">int</span> m_id, uint64_t p, uint64_t vx, mpz_t y)</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>{</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    mpz_t tmp;</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    mpz_init(tmp);</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span> </div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    <span class="comment">// 1. Normalize x_p to x_p if p_id = m_id, else to p - x_p</span></div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    uint64_t xp = (p + 1) / 6;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <span class="keywordtype">int</span> ip = (p % 6 == 1) ? 1 : -1;</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    xp = (m_id == ip) ? xp : p - xp;</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    mpz_mul_ui(tmp, y, vx);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    mpz_sub_ui(tmp, tmp, xp);</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>    mpz_mod_ui(tmp, tmp, p);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    uint64_t x = p &lt; vx ? p - mpz_get_ui(tmp) : mpz_get_ui(tmp);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span> </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    mpz_clear(tmp);</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    <span class="keywordflow">return</span> x;</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>}</div>
</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span></div>
<div class="foldopen" id="foldopen00490" data-start="{" data-end="}">
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga50cf18d6528c411820a9b081b13875ca">  490</a></span>int64_t <a class="code hl_function" href="group__iz__toolkit.html#ga50cf18d6528c411820a9b081b13875ca">iZm_solve_for_y0</a>(<span class="keywordtype">int</span> m_id, uint64_t p, uint64_t vx, uint64_t x)</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>{</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    <span class="comment">// No solution check, if vx and p are not coprime</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__utils.html#ga05d1ac8d90873705cd22e1c83345fa71">gcd</a>(vx, p) != 1)</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    {</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>        printf(<span class="stringliteral">&quot;There&#39;s no solution for the given parameters\n&quot;</span>);</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        <span class="keywordflow">return</span> -1; <span class="comment">// No solution can be found</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    }</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>    uint64_t xp = (p + 1) / 6;</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>    <span class="keywordtype">int</span> ip = (p % 6 == 1) ? 1 : -1;</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>    xp = (m_id == ip) ? xp : p - xp;</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    <span class="comment">// Immediate solution check</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    <span class="keywordflow">if</span> (x % p == xp)</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span> </div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    <span class="comment">// Compute delta</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>    uint64_t x_mod_p = x % p;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    uint64_t delta = (xp + p - x_mod_p) % p;</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>    <span class="comment">// Find modular inverse</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    uint64_t vx_inv = <a class="code hl_function" href="group__iz__utils.html#ga595ea61a3090228f6f23a32b046feaef">modular_inverse</a>(vx % p, p);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span> </div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    <span class="comment">// Compute and return y</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    uint64_t y = (delta * vx_inv) % p;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    <span class="keywordflow">return</span> y;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>}</div>
</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span> </div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span><span class="comment">// ===================================================</span></div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span><span class="comment">// * VX_SEG structure:</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span><span class="comment">// ===================================================</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span></div>
<div class="foldopen" id="foldopen00529" data-start="{" data-end="}">
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno"><a class="line" href="i_z__toolkit_8c.html#a1cb99e772f16a844ff9f04ffcd3e632f">  529</a></span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code hl_function" href="i_z__toolkit_8c.html#a1cb99e772f16a844ff9f04ffcd3e632f">vx_set_base_values</a>(<a class="code hl_struct" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj, <span class="keywordtype">char</span> *y_str)</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>{</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span> </div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>    <span class="comment">// assert y_str is numeric</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    mpz_t y_tmp;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>    mpz_init(y_tmp);</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    <span class="keywordflow">if</span> (mpz_set_str(y_tmp, y_str, 10) != 0)</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>    {</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>        <a class="code hl_function" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error</a>(<span class="stringliteral">&quot;Invalid numeric string for y in vx_set_base_values\n&quot;</span>);</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        mpz_clear(y_tmp);</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    }</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    mpz_init_set(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5696dc17af745d6e74c1ccbaee34f107">y</a>, y_tmp);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    mpz_clear(y_tmp);</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span> </div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>    <span class="comment">// Compute yvx = y * vx</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    mpz_init(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a7f75ee96453b5bb07d0efa9acead960b">yvx</a>);</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>    mpz_mul_ui(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a7f75ee96453b5bb07d0efa9acead960b">yvx</a>, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5696dc17af745d6e74c1ccbaee34f107">y</a>, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af73da08033e4261e7fd397f6f900edc1">vx</a>);</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span> </div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>    <span class="comment">// Compute root_limit = sqrt(iZ(vx * (y+1), 1))</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    mpz_init(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af74e0169f2702d9fbc4f7e3d0993539f">root_limit</a>);</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    mpz_add_ui(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af74e0169f2702d9fbc4f7e3d0993539f">root_limit</a>, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a7f75ee96453b5bb07d0efa9acead960b">yvx</a>, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af73da08033e4261e7fd397f6f900edc1">vx</a>);</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    <a class="code hl_function" href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af74e0169f2702d9fbc4f7e3d0993539f">root_limit</a>, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af74e0169f2702d9fbc4f7e3d0993539f">root_limit</a>, 1);</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    mpz_sqrt(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af74e0169f2702d9fbc4f7e3d0993539f">root_limit</a>, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af74e0169f2702d9fbc4f7e3d0993539f">root_limit</a>);</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span> </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    <span class="comment">// Set is_large_limit to determine if probabilistic primality test is needed</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>    <span class="comment">// if root_limit &gt; vx</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">is_large_limit</a> = mpz_cmp_ui(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af74e0169f2702d9fbc4f7e3d0993539f">root_limit</a>, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af73da08033e4261e7fd397f6f900edc1">vx</a>) &gt; 0;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>}</div>
</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span></div>
<div class="foldopen" id="foldopen00566" data-start="{" data-end="}">
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno"><a class="line" href="i_z__toolkit_8c.html#a0acf76d4f3ff2e6e4421b9115c694823">  566</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="i_z__toolkit_8c.html#a0acf76d4f3ff2e6e4421b9115c694823">vx_det_sieve</a>(<a class="code hl_struct" href="struct_i_z_m.html">IZM</a> *iZm, <a class="code hl_struct" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj)</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>{</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    assert(iZm &amp;&amp; <span class="stringliteral">&quot;iZm is NULL in vx_det_sieve&quot;</span>);</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    assert(vx_obj &amp;&amp; <span class="stringliteral">&quot;vx_obj is NULL in vx_det_sieve&quot;</span>);</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>    <span class="keywordtype">int</span> vx = vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af73da08033e4261e7fd397f6f900edc1">vx</a>; <span class="comment">// segment size</span></div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span> </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    <span class="comment">// * Deterministic Sieve: Mark composites of primes &lt; vx in x5, x7</span></div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    <span class="keywordtype">int</span> start_x = vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a8f766c26d7a5bc718a748ea0401cd3fc">start_x</a>;</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    <span class="keywordtype">int</span> end_x = vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#ada8599db1f49096440074feaa3513fba">end_x</a>;</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    <span class="keywordtype">int</span> k = 2 + iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#aa0cd5920cd875d959ee2c40b7c845382">k_vx</a>; <span class="comment">// skip 2, 3 and pre-sieved k_vx primes</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    <a class="code hl_struct" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *root_primes = iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">root_primes</a>;</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    <span class="comment">// if y &lt; 2^64, use iZm_solve_for_x0 version for efficiency</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>    <span class="keywordflow">if</span> (mpz_sizeinbase(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5696dc17af745d6e74c1ccbaee34f107">y</a>, 2) &lt;= 64)</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    {</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        uint64_t y = mpz_get_ui(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5696dc17af745d6e74c1ccbaee34f107">y</a>);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        uint64_t root_limit = mpz_get_ui(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af74e0169f2702d9fbc4f7e3d0993539f">root_limit</a>);</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span> </div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        <span class="comment">// Iterate through root primes, skipping the first k pre-sieved primes</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = k; i &lt; root_primes-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a5eb007453bedeebe1332d5c2dddaa7c8">count</a>; i++)</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        {</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>            uint64_t p = root_primes-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a337d001ba534fed8a25bb9b80351f332">array</a>[i];</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span> </div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>            <span class="keywordflow">if</span> (p &gt; root_limit)</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span> </div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>            <span class="comment">// Mark composites of p in x5 and x7</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a40f181e2538f16411d5815bc71b8b757">x5</a>, p, <a class="code hl_function" href="group__iz__toolkit.html#ga596920e4772d76fe9dc61a541b282275">iZm_solve_for_x0</a>(-1, p, vx, y), end_x);</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a0f26a18865664cff47076ffd33b3b0ca">x7</a>, p, <a class="code hl_function" href="group__iz__toolkit.html#ga596920e4772d76fe9dc61a541b282275">iZm_solve_for_x0</a>(1, p, vx, y), end_x);</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span> </div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>            vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a537a59185c9aaf9e4dbc77a5c0814d42">bit_ops</a> += (2 * end_x) / p; <span class="comment">// approximate number of bit operations</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        }</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>    }</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    {</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        <span class="comment">// the same as above but using iZm_solve_for_x0_mpz version</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = k; i &lt; root_primes-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a5eb007453bedeebe1332d5c2dddaa7c8">count</a>; i++)</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        {</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>            <span class="keywordtype">int</span> p = root_primes-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a337d001ba534fed8a25bb9b80351f332">array</a>[i];</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span> </div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a40f181e2538f16411d5815bc71b8b757">x5</a>, p, <a class="code hl_function" href="group__iz__toolkit.html#ga3ee0fd9e3f27fd5d30fddfe7d1056c57">iZm_solve_for_x0_mpz</a>(-1, p, vx, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5696dc17af745d6e74c1ccbaee34f107">y</a>), end_x);</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a0f26a18865664cff47076ffd33b3b0ca">x7</a>, p, <a class="code hl_function" href="group__iz__toolkit.html#ga3ee0fd9e3f27fd5d30fddfe7d1056c57">iZm_solve_for_x0_mpz</a>(1, p, vx, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5696dc17af745d6e74c1ccbaee34f107">y</a>), end_x);</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>            vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a537a59185c9aaf9e4dbc77a5c0814d42">bit_ops</a> += (2 * end_x) / p;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>        }</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    }</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    <span class="comment">// if no further probabilistic testing is needed,</span></div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>    <span class="comment">// count unmarked bits in x5 and x7 as p_count</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>    <span class="keywordflow">if</span> (!vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">is_large_limit</a>)</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    {</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>        vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">p_count</a> = 0;</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = start_x; x &lt;= end_x; x++)</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>        {</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a40f181e2538f16411d5815bc71b8b757">x5</a>, x))</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">p_count</a>++;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a0f26a18865664cff47076ffd33b3b0ca">x7</a>, x))</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>                vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">p_count</a>++;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>        }</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    }</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>}</div>
</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span></div>
<div class="foldopen" id="foldopen00633" data-start="{" data-end="}">
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno"><a class="line" href="i_z__toolkit_8c.html#ae75ea043adeb58f25e079d1b46984d63">  633</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="i_z__toolkit_8c.html#ae75ea043adeb58f25e079d1b46984d63">vx_prob_sieve</a>(<a class="code hl_struct" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj)</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>{</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    <span class="comment">// If is_large_limit is false, no need for probabilistic testing</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>    <span class="keywordflow">if</span> (!vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">is_large_limit</a>)</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    {</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        <a class="code hl_function" href="group__iz__logger.html#ga49528dc2f0c8d5628f13358382f8d5b4">log_info</a>(<span class="stringliteral">&quot;vx_obj-&gt;is_large_limit is false, no need for probabilistic testing&quot;</span>);</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>    }</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span> </div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>    <span class="comment">// Initialize GMP reusable variables p, x_p</span></div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    mpz_t p, x_p;</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>    mpz_init(p);</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    mpz_init(x_p);</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span> </div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    <span class="keywordtype">int</span> r = vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a37fa278f6fceded67c8a852299e90dd9">mr_rounds</a>;</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    <span class="keywordtype">int</span> s = vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a8f766c26d7a5bc718a748ea0401cd3fc">start_x</a> &lt;= 1 ? 1 : vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a8f766c26d7a5bc718a748ea0401cd3fc">start_x</a>;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span> </div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    <span class="comment">// Iterate through x values in the range start_x &lt;= x &lt;= end_x</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = s; x &lt;= vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#ada8599db1f49096440074feaa3513fba">end_x</a>; x++)</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>    {</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>        <span class="comment">// Check if iZ(vx * y + x, -1) is prime, if not, clear x in x5</span></div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a40f181e2538f16411d5815bc71b8b757">x5</a>, x))</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>        {</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>            <span class="comment">// Compute x_p = yvx + x</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>            mpz_add_ui(x_p, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a7f75ee96453b5bb07d0efa9acead960b">yvx</a>, x);</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>            <a class="code hl_function" href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a>(p, x_p, -1); <span class="comment">// Compute p = iZ(x_p, -1)</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>            <span class="keywordtype">int</span> is_prime = <a class="code hl_function" href="group__iz__toolkit.html#ga1dbb019b08a42984e1733f0c7c3881a0">check_primality</a>(p, r);</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>            vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a3e464acdf8995998d7b8120d02d38347">p_test_ops</a>++;</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span> </div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>            <span class="comment">// if is_prime, increment count, else clear composite from x5</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>            <span class="keywordflow">if</span> (is_prime)</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            {</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>                vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">p_count</a>++;</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>            }</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>            {</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>                <a class="code hl_function" href="group__iz__bitmap.html#ga958df9e667d4516791537c988fb01999">bitmap_clear_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a40f181e2538f16411d5815bc71b8b757">x5</a>, x); <span class="comment">// Clear composite from x5</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>            }</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>        }</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>        <span class="comment">// same for the 6x+1 candidate</span></div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a0f26a18865664cff47076ffd33b3b0ca">x7</a>, x))</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>        {</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>            mpz_add_ui(x_p, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a7f75ee96453b5bb07d0efa9acead960b">yvx</a>, x);</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>            <a class="code hl_function" href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a>(p, x_p, 1); <span class="comment">// Compute p = iZ(x_p, 1)</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>            <span class="keywordtype">int</span> is_prime = <a class="code hl_function" href="group__iz__toolkit.html#ga1dbb019b08a42984e1733f0c7c3881a0">check_primality</a>(p, r);</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>            vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a3e464acdf8995998d7b8120d02d38347">p_test_ops</a>++;</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>            <span class="keywordflow">if</span> (is_prime)</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>            {</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>                vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">p_count</a>++;</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>            }</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>            {</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>                <a class="code hl_function" href="group__iz__bitmap.html#ga958df9e667d4516791537c988fb01999">bitmap_clear_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a0f26a18865664cff47076ffd33b3b0ca">x7</a>, x); <span class="comment">// Clear composite from x7</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>            }</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>        }</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>    }</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span> </div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">is_large_limit</a> = 0; <span class="comment">// all composites cleared</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    <span class="comment">// Cleanup</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    mpz_clears(p, x_p, NULL);</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>}</div>
</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span></div>
<div class="foldopen" id="foldopen00713" data-start="{" data-end="}">
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga234719b01a0e090a1f66ed7766fe6d0f">  713</a></span><a class="code hl_struct" href="struct_v_x___s_e_g.html">VX_SEG</a> *<a class="code hl_function" href="group__iz__toolkit.html#ga234719b01a0e090a1f66ed7766fe6d0f">vx_init</a>(<a class="code hl_struct" href="struct_i_z_m.html">IZM</a> *iZm, <span class="keywordtype">int</span> start_x, <span class="keywordtype">int</span> end_x, <span class="keywordtype">char</span> *y_str, <span class="keywordtype">int</span> mr_rounds)</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>{</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    <span class="comment">// assert vx &gt; 5 and not a multiple of 2 or 3</span></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>    assert(iZm &amp;&amp; <span class="stringliteral">&quot;iZm is NULL in vx_init&quot;</span>);</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    assert(y_str &amp;&amp; <span class="stringliteral">&quot;y_str is NULL in vx_init&quot;</span>);</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span> </div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>    <a class="code hl_struct" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj = malloc(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct_v_x___s_e_g.html">VX_SEG</a>));</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    <span class="keywordflow">if</span> (vx_obj == NULL)</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>    {</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>        <a class="code hl_function" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error</a>(<span class="stringliteral">&quot;Memory allocation failed in vx_init\n&quot;</span>);</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    }</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span> </div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    <span class="comment">// Initialize struct members</span></div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af73da08033e4261e7fd397f6f900edc1">vx</a> = iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#ac5d6cad1cb4e3d7b6c4ef7a999283615">vx</a>;</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    <span class="comment">// Set base values</span></div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="i_z__toolkit_8c.html#a1cb99e772f16a844ff9f04ffcd3e632f">vx_set_base_values</a>(vx_obj, y_str))</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>        <span class="comment">// check logs</span></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>        free(vx_obj);</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    }</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span> </div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a37fa278f6fceded67c8a852299e90dd9">mr_rounds</a> = (mr_rounds == 0) ? <a class="code hl_define" href="group__iz__toolkit.html#gaa00f10dbfb5d0730503a789900de9134">MR_ROUNDS</a> : mr_rounds; <span class="comment">// default 25 rounds</span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a8f766c26d7a5bc718a748ea0401cd3fc">start_x</a> = <a class="code hl_define" href="group__iz__utils.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(start_x, 1);</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#ada8599db1f49096440074feaa3513fba">end_x</a> = <a class="code hl_define" href="group__iz__utils.html#ga3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(end_x, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#af73da08033e4261e7fd397f6f900edc1">vx</a>);</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a40f181e2538f16411d5815bc71b8b757">x5</a> = <a class="code hl_function" href="group__iz__bitmap.html#gabc118534bd59159ed55c509bd1b795e9">bitmap_clone</a>(iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afbda5590cfc085366c41769a8054fcde">base_x5</a>);</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a0f26a18865664cff47076ffd33b3b0ca">x7</a> = <a class="code hl_function" href="group__iz__bitmap.html#gabc118534bd59159ed55c509bd1b795e9">bitmap_clone</a>(iZm-&gt;<a class="code hl_variable" href="struct_i_z_m.html#afe3d89b8ae3ad315e952093c945e1073">base_x7</a>);</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">p_count</a> = 0;</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a25bbcd26bb0e69a6b9584594a714b8b5">p_gaps</a> = NULL;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a537a59185c9aaf9e4dbc77a5c0814d42">bit_ops</a> = 0;</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a3e464acdf8995998d7b8120d02d38347">p_test_ops</a> = 0;</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span> </div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>    <span class="comment">// perform deterministic sieving to prepare for probabilistic sieving or streaming</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>    <a class="code hl_function" href="i_z__toolkit_8c.html#a0acf76d4f3ff2e6e4421b9115c694823">vx_det_sieve</a>(iZm, vx_obj);</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span> </div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>    <span class="keywordflow">return</span> vx_obj;</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>}</div>
</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span></div>
<div class="foldopen" id="foldopen00759" data-start="{" data-end="}">
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga89a2804cb4fa979a32e4213ade786ec4">  759</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#ga89a2804cb4fa979a32e4213ade786ec4">vx_free</a>(<a class="code hl_struct" href="struct_v_x___s_e_g.html">VX_SEG</a> **vx_obj)</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>{</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    <span class="keywordflow">if</span> (vx_obj == NULL || *vx_obj == NULL)</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span> </div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    <span class="comment">// clear bitmaps</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    <a class="code hl_function" href="group__iz__bitmap.html#ga66cb254c9bf38d7adfe83d723baa2e15">bitmap_free</a>(&amp;(*vx_obj)-&gt;x5);</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    <a class="code hl_function" href="group__iz__bitmap.html#ga66cb254c9bf38d7adfe83d723baa2e15">bitmap_free</a>(&amp;(*vx_obj)-&gt;x7);</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    <span class="comment">// clear p_gaps array</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    <a class="code hl_function" href="group__iz__arrays.html#ga6711fa1c3d7f6f57924486106423e18b">ui16_free</a>(&amp;(*vx_obj)-&gt;p_gaps);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span> </div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>    <span class="comment">// clear mpz_t variables</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>    mpz_clears((*vx_obj)-&gt;y, (*vx_obj)-&gt;yvx, (*vx_obj)-&gt;root_limit, NULL);</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span> </div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    free(*vx_obj);</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>    *vx_obj = NULL;</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>}</div>
</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span></div>
<div class="foldopen" id="foldopen00787" data-start="{" data-end="}">
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga824821f174cc26db2d310a68e8c2f19e">  787</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#ga824821f174cc26db2d310a68e8c2f19e">vx_collect_p_gaps</a>(<a class="code hl_struct" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj)</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>{</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>    assert(vx_obj &amp;&amp; vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">p_count</a> &gt; 0 &amp;&amp; <span class="stringliteral">&quot;Invalid vx_obj in vx_collect_p_gaps&quot;</span>);</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>    assert(mpz_cmp_ui(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5696dc17af745d6e74c1ccbaee34f107">y</a>, 0) &gt; 0 &amp;&amp; <span class="stringliteral">&quot;First segment requires special handling in vx_collect_p_gaps&quot;</span>);</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    <span class="keywordflow">if</span> (vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">is_large_limit</a>)</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>    {</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>        <a class="code hl_function" href="group__iz__toolkit.html#ga214f95ac7b685a7ff0c596afc70036b7">vx_full_sieve</a>(vx_obj, 0);</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>    }</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span> </div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a25bbcd26bb0e69a6b9584594a714b8b5">p_gaps</a> = <a class="code hl_function" href="group__iz__arrays.html#ga495a195fcf45ae02c9402bcb389e7343">ui16_init</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">p_count</a> + 2);</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>    assert(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a25bbcd26bb0e69a6b9584594a714b8b5">p_gaps</a> &amp;&amp; <span class="stringliteral">&quot;Memory allocation failed for vx_obj-&gt;p_gaps in vx_collect_p_gaps&quot;</span>);</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span> </div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>    <span class="comment">// Initialize gap counter</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    <span class="keywordtype">int</span> gap = 0;</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    <span class="comment">// Iterate through x values in the range start_x &lt;= x &lt;= end_x</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a8f766c26d7a5bc718a748ea0401cd3fc">start_x</a>; x &lt;= vx_obj-&gt;end_x; x++)</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    {</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>        <span class="comment">// Increment gap by 4 since: iZ(x, -1) - iZ(x-1, 1) = 4</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>        gap += 4;</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span> </div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>        <span class="comment">// Check if iZ(vx * y + x, -1) is prime</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a40f181e2538f16411d5815bc71b8b757">x5</a>, x))</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>        {</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>            <span class="comment">// Append gap to p_gaps</span></div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>            <a class="code hl_function" href="group__iz__arrays.html#gaf19906d91639a464ff36cc425968bdae">ui16_push</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a25bbcd26bb0e69a6b9584594a714b8b5">p_gaps</a>, gap);</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>            gap = 0; <span class="comment">// Reset gap</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>        }</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span> </div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>        <span class="comment">// Increment gap by 2</span></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>        gap += 2;</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>        <span class="comment">// Check if iZ(vx * y + x, 1) is prime</span></div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a0f26a18865664cff47076ffd33b3b0ca">x7</a>, x))</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>        {</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>            <span class="comment">// Append gap to p_gaps</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>            <a class="code hl_function" href="group__iz__arrays.html#gaf19906d91639a464ff36cc425968bdae">ui16_push</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a25bbcd26bb0e69a6b9584594a714b8b5">p_gaps</a>, gap);</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>            gap = 0; <span class="comment">// Reset gap</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>        }</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    }</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span> </div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    <span class="comment">// append final gap for backward calculations</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    <a class="code hl_function" href="group__iz__arrays.html#gaf19906d91639a464ff36cc425968bdae">ui16_push</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a25bbcd26bb0e69a6b9584594a714b8b5">p_gaps</a>, gap);</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>}</div>
</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span></div>
<div class="foldopen" id="foldopen00847" data-start="{" data-end="}">
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga214f95ac7b685a7ff0c596afc70036b7">  847</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#ga214f95ac7b685a7ff0c596afc70036b7">vx_full_sieve</a>(<a class="code hl_struct" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj, <span class="keywordtype">int</span> collect_p_gaps)</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>{</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>    assert(vx_obj &amp;&amp; <span class="stringliteral">&quot;vx_obj is NULL in vx_full_sieve&quot;</span>);</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span> </div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>    <span class="comment">// If is_large_limit is true, perform probabilistic primality tests</span></div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>    <span class="keywordflow">if</span> (vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">is_large_limit</a>)</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>        <a class="code hl_function" href="i_z__toolkit_8c.html#ae75ea043adeb58f25e079d1b46984d63">vx_prob_sieve</a>(vx_obj);</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span> </div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>    <span class="comment">// If collect_p_gaps is true, populate the p_gaps array</span></div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>    <span class="keywordflow">if</span> (collect_p_gaps)</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>        <a class="code hl_function" href="group__iz__toolkit.html#ga824821f174cc26db2d310a68e8c2f19e">vx_collect_p_gaps</a>(vx_obj);</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>}</div>
</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span></div>
<div class="foldopen" id="foldopen00866" data-start="{" data-end="}">
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga591a1d1fae4f8a241c6b6ed7f495eae6">  866</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#ga591a1d1fae4f8a241c6b6ed7f495eae6">vx_stream</a>(<a class="code hl_struct" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj, FILE *output)</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>{</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>    assert(vx_obj &amp;&amp; <span class="stringliteral">&quot;vx_obj is NULL in vx_stream&quot;</span>);</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    assert(output &amp;&amp; <span class="stringliteral">&quot;output stream is NULL in vx_stream&quot;</span>);</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span> </div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>    <span class="comment">// Initialize GMP reusable variables p, x_p</span></div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    mpz_t p, x_p;</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>    mpz_init(p);</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>    mpz_init(x_p);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span> </div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>    <span class="keywordtype">int</span> r = vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a37fa278f6fceded67c8a852299e90dd9">mr_rounds</a>;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span> </div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>    <span class="comment">// Iterate through x values in the range start_x &lt;= x &lt;= end_x</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a8f766c26d7a5bc718a748ea0401cd3fc">start_x</a>; x &lt;= vx_obj-&gt;end_x; x++)</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>    {</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>        <span class="comment">// Check if iZ(vx * y + x, -1) is prime, if not, clear x in x5</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a40f181e2538f16411d5815bc71b8b757">x5</a>, x))</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>        {</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>            <span class="comment">// Compute x_p = yvx + x</span></div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>            mpz_add_ui(x_p, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a7f75ee96453b5bb07d0efa9acead960b">yvx</a>, x);</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>            <a class="code hl_function" href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a>(p, x_p, -1); <span class="comment">// Compute p = iZ(x_p, -1)</span></div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>            <span class="keywordtype">int</span> is_prime = 1;</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span> </div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>            <span class="keywordflow">if</span> (vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">is_large_limit</a>)</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>            {</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>                vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a3e464acdf8995998d7b8120d02d38347">p_test_ops</a>++;</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>                is_prime = <a class="code hl_function" href="group__iz__toolkit.html#ga1dbb019b08a42984e1733f0c7c3881a0">check_primality</a>(p, r);</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>            }</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span> </div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>            <span class="keywordflow">if</span> (is_prime)</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>            {</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>                <span class="keywordflow">if</span> (vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">is_large_limit</a>)</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>                {</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>                    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">p_count</a>++; <span class="comment">// otherwise already counted in det_sieve</span></div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>                }</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>                gmp_fprintf(output, <span class="stringliteral">&quot;%Zd &quot;</span>, p);</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>            }</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>            {</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>                <a class="code hl_function" href="group__iz__bitmap.html#ga958df9e667d4516791537c988fb01999">bitmap_clear_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a40f181e2538f16411d5815bc71b8b757">x5</a>, x); <span class="comment">// Clear composite from x5</span></div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>            }</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>        }</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span> </div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>        <span class="comment">// test iZ(vx * y + x, 1) for primality</span></div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a0f26a18865664cff47076ffd33b3b0ca">x7</a>, x))</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>        {</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>            mpz_add_ui(x_p, vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a7f75ee96453b5bb07d0efa9acead960b">yvx</a>, x);</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>            <a class="code hl_function" href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a>(p, x_p, 1); <span class="comment">// Compute p = iZ(x_p, 1)</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>            <span class="keywordtype">int</span> is_prime = 1;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span> </div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>            <span class="keywordflow">if</span> (vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">is_large_limit</a>)</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>            {</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>                vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a3e464acdf8995998d7b8120d02d38347">p_test_ops</a>++;</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>                is_prime = <a class="code hl_function" href="group__iz__toolkit.html#ga1dbb019b08a42984e1733f0c7c3881a0">check_primality</a>(p, r);</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>            }</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span> </div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>            <span class="keywordflow">if</span> (is_prime)</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>            {</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>                <span class="keywordflow">if</span> (vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">is_large_limit</a>)</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>                {</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>                    vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">p_count</a>++;</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>                }</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>                gmp_fprintf(output, <span class="stringliteral">&quot;%Zd &quot;</span>, p);</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>            }</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>            {</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>                <a class="code hl_function" href="group__iz__bitmap.html#ga958df9e667d4516791537c988fb01999">bitmap_clear_bit</a>(vx_obj-&gt;<a class="code hl_variable" href="struct_v_x___s_e_g.html#a0f26a18865664cff47076ffd33b3b0ca">x7</a>, x); <span class="comment">// Clear composite from x7</span></div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>            }</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>        }</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>    }</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span> </div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>    mpz_clears(p, x_p, NULL);</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>}</div>
</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span> </div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span><span class="comment">// ==================================================</span></div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span><span class="comment">// * IZM_RANGE_INFO structure:</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span><span class="comment">// ==================================================</span></div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span> </div>
<div class="foldopen" id="foldopen00944" data-start="{" data-end="}">
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga5ada19be750a6f9b0837805ef34a1de4">  944</a></span><a class="code hl_struct" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a> <a class="code hl_function" href="group__iz__toolkit.html#ga5ada19be750a6f9b0837805ef34a1de4">range_info_init</a>(<a class="code hl_struct" href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html">INPUT_SIEVE_RANGE</a> *input_range, <span class="keywordtype">int</span> vx)</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>{</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>    <a class="code hl_struct" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a> info = {0};</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>    info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a1946eaa4ccabece4bd5bd2eb7d59881a">vx</a> = vx;</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>    info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a3f8fe0b07e9ac77cf634438cfff9a31b">y_range</a> = -1;</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span> </div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>    mpz_inits(info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a8e9a581955081eb9709028a3a81ebdef">Zs</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a28b5500837aa3d2cf68145ee5934afad">Ze</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#aec64414685210cc45b6d75249b170561">Xs</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#acc00a32b6cffc91a9e947ecbb6ea97dc">Xe</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a79e2a9589301aef116ef5d6e0f729cbe">Ys</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#aa89816e932bfef3052a120c3971b09c7">Ye</a>, NULL);</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span> </div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>    <span class="keywordflow">if</span> (!input_range || !input_range-&gt;<a class="code hl_variable" href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html#aa130dc66a14ad2622c250382fcef83b5">start</a> || vx &lt; 35 || mpz_set_str(info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a8e9a581955081eb9709028a3a81ebdef">Zs</a>, input_range-&gt;<a class="code hl_variable" href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html#aa130dc66a14ad2622c250382fcef83b5">start</a>, 10) != 0)</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>    {</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>        <a class="code hl_function" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error</a>(<span class="stringliteral">&quot;range_info_init: invalid input.&quot;</span>);</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>        <span class="keywordflow">return</span> info;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>    }</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span> </div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>    <span class="keywordflow">if</span> (input_range-&gt;<a class="code hl_variable" href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html#aad5d9f7a094db43297ca9fff6cf4ddd9">range</a> == 0)</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    {</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>        mpz_set(info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a28b5500837aa3d2cf68145ee5934afad">Ze</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a8e9a581955081eb9709028a3a81ebdef">Zs</a>);</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>    }</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    {</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>        <span class="comment">// inclusive upper bound for range size semantics: [start, start + range - 1]</span></div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>        mpz_add_ui(info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a28b5500837aa3d2cf68145ee5934afad">Ze</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a8e9a581955081eb9709028a3a81ebdef">Zs</a>, input_range-&gt;<a class="code hl_variable" href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html#aad5d9f7a094db43297ca9fff6cf4ddd9">range</a> - 1);</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>    }</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span> </div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>    mpz_fdiv_q_ui(info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#aec64414685210cc45b6d75249b170561">Xs</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a8e9a581955081eb9709028a3a81ebdef">Zs</a>, 6);</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    mpz_fdiv_q_ui(info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#acc00a32b6cffc91a9e947ecbb6ea97dc">Xe</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a28b5500837aa3d2cf68145ee5934afad">Ze</a>, 6);</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>    mpz_fdiv_q_ui(info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a79e2a9589301aef116ef5d6e0f729cbe">Ys</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#aec64414685210cc45b6d75249b170561">Xs</a>, vx);</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>    mpz_fdiv_q_ui(info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#aa89816e932bfef3052a120c3971b09c7">Ye</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#acc00a32b6cffc91a9e947ecbb6ea97dc">Xe</a>, vx);</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span> </div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>    mpz_t y_delta;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>    mpz_init(y_delta);</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>    mpz_sub(y_delta, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#aa89816e932bfef3052a120c3971b09c7">Ye</a>, info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a79e2a9589301aef116ef5d6e0f729cbe">Ys</a>);</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span> </div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>    <span class="keywordflow">if</span> (mpz_sgn(y_delta) &lt; 0 || !mpz_fits_sint_p(y_delta))</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>    {</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>        <a class="code hl_function" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error</a>(<span class="stringliteral">&quot;range_info_init: computed y-range is out of supported bounds.&quot;</span>);</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>        mpz_clear(y_delta);</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>        <span class="keywordflow">return</span> info;</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>    }</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span> </div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>    info.<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a3f8fe0b07e9ac77cf634438cfff9a31b">y_range</a> = (int)mpz_get_si(y_delta);</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>    mpz_clear(y_delta);</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span> </div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>    <span class="keywordflow">return</span> info;</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>}</div>
</div>
<div class="foldopen" id="foldopen00989" data-start="{" data-end="}">
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#gab053af28699e3138640445b16a1311f7">  989</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group__iz__toolkit.html#gab053af28699e3138640445b16a1311f7">range_info_free</a>(<a class="code hl_struct" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a> *info)</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>{</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    <span class="keywordflow">if</span> (info == NULL)</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span> </div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    mpz_clears(info-&gt;<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a8e9a581955081eb9709028a3a81ebdef">Zs</a>, info-&gt;<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a28b5500837aa3d2cf68145ee5934afad">Ze</a>, info-&gt;<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#aec64414685210cc45b6d75249b170561">Xs</a>, info-&gt;<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#acc00a32b6cffc91a9e947ecbb6ea97dc">Xe</a>, info-&gt;<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a79e2a9589301aef116ef5d6e0f729cbe">Ys</a>, info-&gt;<a class="code hl_variable" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#aa89816e932bfef3052a120c3971b09c7">Ye</a>, NULL);</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>}</div>
</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span> </div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span><span class="comment">// ==================================================</span></div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span><span class="comment">// * iZm Search primes routines:</span></div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span><span class="comment">// ==================================================</span></div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span></div>
<div class="foldopen" id="foldopen01017" data-start="{" data-end="}">
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga02e061a03533010221ce47c043ddc53c"> 1017</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group__iz__toolkit.html#ga02e061a03533010221ce47c043ddc53c">vx_search_prime</a>(mpz_t p, <span class="keywordtype">int</span> m_id, <span class="keywordtype">int</span> vx, <span class="keywordtype">int</span> bit_size)</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>{</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>    <span class="comment">// assert p is not NULL</span></div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>    assert(p &amp;&amp; <span class="stringliteral">&quot;p cannot be NULL in vx_search_prime.&quot;</span>);</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span> </div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>    bit_size = <a class="code hl_define" href="group__iz__utils.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(bit_size, 10);</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span> </div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>    <span class="comment">// set m_id randomly if not provided</span></div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    <span class="keywordflow">if</span> (m_id != -1 &amp;&amp; m_id != 1)</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>        m_id = (rand() % 2) ? 1 : -1;</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span> </div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>    gmp_randstate_t state;</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>    gmp_randinit_default(state);</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>    <a class="code hl_function" href="group__iz__utils.html#ga66ae2bd59e23d5bfc0103ceebbbdfa64">gmp_seed_randstate</a>(state);</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span> </div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>    <a class="code hl_struct" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *root_primes = <a class="code hl_function" href="group__iz__api.html#ga9ca94c578547d87c05b381034897f3a6">SiZm</a>(vx);</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>    <span class="keywordflow">if</span> (!root_primes)</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>    {</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>        <a class="code hl_function" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error</a>(<span class="stringliteral">&quot;Failed to initialize root primes in vx_search_prime&quot;</span>);</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>        gmp_randclear(state);</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    }</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span> </div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>    mpz_t z, x_z, y, yvx;</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>    mpz_init(z);</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>    mpz_init(x_z);</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>    mpz_init(y);</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>    mpz_init(yvx);</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span> </div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>    mpz_urandomb(y, state, bit_size);</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>    mpz_fdiv_q_ui(y, y, 6 * vx);</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>    mpz_mul_ui(yvx, y, vx); <span class="comment">// compute yvx = vx * y</span></div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span> </div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>    <span class="keywordtype">int</span> found = 0;</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>    <span class="keywordflow">while</span> (!found)</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>    {</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>        <a class="code hl_struct" href="struct_b_i_t_m_a_p.html">BITMAP</a> *bitmap = <a class="code hl_function" href="group__iz__bitmap.html#ga165a40f31d911d8939771e064e2b87c1">bitmap_init</a>(vx + 10, 1);</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span> </div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>        <span class="comment">// sieve the bitmap with root primes skipping 2 and 3</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt; root_primes-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a5eb007453bedeebe1332d5c2dddaa7c8">count</a>; i++)</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>        {</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>            uint64_t q = root_primes-&gt;<a class="code hl_variable" href="struct_u_i64___a_r_r_a_y.html#a337d001ba534fed8a25bb9b80351f332">array</a>[i];</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>            <span class="comment">// mark composites of q in the bitmap</span></div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>            <a class="code hl_function" href="group__iz__bitmap.html#ga8589bfd273ccc48de55072eeefd1dd93">bitmap_clear_steps</a>(bitmap, q, <a class="code hl_function" href="group__iz__toolkit.html#ga3ee0fd9e3f27fd5d30fddfe7d1056c57">iZm_solve_for_x0_mpz</a>(m_id, q, vx, y), vx);</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>        }</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span> </div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>        <span class="keywordtype">int</span> random_x = rand() % (vx / 2); <span class="comment">// random x &lt; vx/2</span></div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = random_x; x &lt; vx; x++)</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>        {</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>            <span class="comment">// check if z is prime candidate in bitmap</span></div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a>(bitmap, x))</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>            {</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>                <span class="comment">// compute x_z = vx * y + x</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>                mpz_add_ui(x_z, yvx, x);</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>                <a class="code hl_function" href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a>(z, x_z, m_id);</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>                <span class="comment">// check if z is prime</span></div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>                found = <a class="code hl_function" href="group__iz__toolkit.html#ga1dbb019b08a42984e1733f0c7c3881a0">check_primality</a>(z, <a class="code hl_define" href="group__iz__toolkit.html#gaa00f10dbfb5d0730503a789900de9134">MR_ROUNDS</a>);</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span> </div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>                <span class="comment">// if z is prime, set p = z</span></div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>                <span class="keywordflow">if</span> (found)</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>                {</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>                    mpz_set(p, z);</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>                }</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>            }</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>        }</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span> </div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>        <span class="comment">// cleanup</span></div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>        <a class="code hl_function" href="group__iz__bitmap.html#ga66cb254c9bf38d7adfe83d723baa2e15">bitmap_free</a>(&amp;bitmap);</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span> </div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>        <span class="comment">// increment y by 1 for next vx segment</span></div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>        mpz_add_ui(y, y, 1);</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>        mpz_add_ui(yvx, yvx, vx);</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>    }</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span> </div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>    <a class="code hl_function" href="group__iz__arrays.html#gab1a0ced5e600649da6e519693a3a2851">ui64_free</a>(&amp;root_primes);</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>    mpz_clears(z, x_z, y, yvx, NULL);</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>    gmp_randclear(state);</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span> </div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>    <span class="keywordflow">return</span> found;</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>}</div>
</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span></div>
<div class="foldopen" id="foldopen01114" data-start="{" data-end="}">
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"><a class="line" href="group__iz__toolkit.html#ga58ea9ced15462006d8a8c223719c57f4"> 1114</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group__iz__toolkit.html#ga58ea9ced15462006d8a8c223719c57f4">vy_search_prime</a>(mpz_t p, <span class="keywordtype">int</span> m_id, mpz_t vx)</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>{</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>    assert(p &amp;&amp; vx &amp;&amp; <span class="stringliteral">&quot;Input parameters cannot be NULL&quot;</span>);</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span> </div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>    <span class="keywordtype">int</span> found = 0; <span class="comment">// flag to indicate if a prime was found</span></div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span> </div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>    <span class="comment">// set m_id randomly if not provided</span></div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>    <span class="keywordflow">if</span> (m_id != -1 &amp;&amp; m_id != 1)</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>        m_id = (rand() % 2) ? 1 : -1;</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span> </div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>    gmp_randstate_t state;</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>    gmp_randinit_default(state);</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>    <a class="code hl_function" href="group__iz__utils.html#ga66ae2bd59e23d5bfc0103ceebbbdfa64">gmp_seed_randstate</a>(state); <span class="comment">// seed random state</span></div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span> </div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>    mpz_t z, g;</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>    mpz_init(z);</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>    mpz_init(g);</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span> </div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>    <span class="comment">// set random x value in the range of vx</span></div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>    mpz_urandomm(z, state, vx);</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>    <span class="comment">// compute z = 6 * z + i</span></div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>    <a class="code hl_function" href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a>(z, z, m_id);</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span> </div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>    <span class="comment">// search for x value such that gcd(iZ(x, m_id), z) = 1</span></div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>    <span class="keywordflow">for</span> (;;)</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>    {</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>        <span class="comment">// increment z by 6 to advance x by 1</span></div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>        mpz_add_ui(z, z, 6);</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span> </div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>        <span class="comment">// Compute g = gcd(vx, z)</span></div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>        mpz_gcd(g, vx, z);</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span> </div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>        <span class="comment">// break if g = 1,</span></div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>        <span class="comment">// implying current x value can yield primes of the form iZ(x + vx * y, p_id)</span></div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>        <span class="keywordflow">if</span> (mpz_cmp_ui(g, 1) == 0)</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>    }</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span> </div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>    <span class="comment">// set g = 6 * vx to use as a step</span></div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    mpz_mul_ui(g, vx, 6);</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>    <span class="comment">// add z by rand * g</span></div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>    <span class="keywordtype">int</span> rand_steps = rand() % 100;</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>    mpz_addmul_ui(z, g, rand_steps);</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span> </div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>    <span class="keywordflow">while</span> (!found)</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>    {</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>        <span class="comment">// increment z by 6 * vx to advance y by 1</span></div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>        mpz_add(z, z, g);</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span> </div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>        <span class="comment">// check if z is prime</span></div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>        found = <a class="code hl_function" href="group__iz__toolkit.html#ga1dbb019b08a42984e1733f0c7c3881a0">check_primality</a>(z, <a class="code hl_define" href="group__iz__toolkit.html#gaa00f10dbfb5d0730503a789900de9134">MR_ROUNDS</a>);</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span> </div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>        <span class="comment">// if z is prime, set p = z</span></div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>        <span class="keywordflow">if</span> (found)</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>            mpz_set(p, z);</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>    }</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span> </div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>    <span class="comment">// cleanup</span></div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>    gmp_randclear(state);</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>    mpz_clears(z, g, NULL);</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span> </div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>    <span class="keywordflow">return</span> found;</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>}</div>
</div>
<div class="ttc" id="agroup__iz__api_html_ga9ca94c578547d87c05b381034897f3a6"><div class="ttname"><a href="group__iz__api.html#ga9ca94c578547d87c05b381034897f3a6">SiZm</a></div><div class="ttdeci">UI64_ARRAY * SiZm(uint64_t n)</div><div class="ttdoc">Segmented Sieve-iZm (VX segmented, horizontal processing).</div><div class="ttdef"><b>Definition</b> <a href="prime__sieve_8c_source.html#l00516">prime_sieve.c:516</a></div></div>
<div class="ttc" id="agroup__iz__api_html_gaeff7d8923d54b5d606c51301bc9bc0e7"><div class="ttname"><a href="group__iz__api.html#gaeff7d8923d54b5d606c51301bc9bc0e7">SiZ</a></div><div class="ttdeci">UI64_ARRAY * SiZ(uint64_t n)</div><div class="ttdoc">Solid Sieve-iZ (wheel 6, iZ index space).</div><div class="ttdef"><b>Definition</b> <a href="prime__sieve_8c_source.html#l00444">prime_sieve.c:444</a></div></div>
<div class="ttc" id="agroup__iz__arrays_html_ga495a195fcf45ae02c9402bcb389e7343"><div class="ttname"><a href="group__iz__arrays.html#ga495a195fcf45ae02c9402bcb389e7343">ui16_init</a></div><div class="ttdeci">UI16_ARRAY * ui16_init(int capacity)</div><div class="ttdoc">Allocate a UI16 array with an initial capacity.</div></div>
<div class="ttc" id="agroup__iz__arrays_html_ga51cf8a13f4a4ae5c076a1be3a3333a68"><div class="ttname"><a href="group__iz__arrays.html#ga51cf8a13f4a4ae5c076a1be3a3333a68">ui64_push</a></div><div class="ttdeci">void ui64_push(UI64_ARRAY *array, uint64_t element)</div><div class="ttdoc">Append a uint64 value, growing storage if needed.</div></div>
<div class="ttc" id="agroup__iz__arrays_html_ga6711fa1c3d7f6f57924486106423e18b"><div class="ttname"><a href="group__iz__arrays.html#ga6711fa1c3d7f6f57924486106423e18b">ui16_free</a></div><div class="ttdeci">void ui16_free(UI16_ARRAY **array)</div><div class="ttdoc">Free a UI16 array and null the caller pointer.</div></div>
<div class="ttc" id="agroup__iz__arrays_html_gab1a0ced5e600649da6e519693a3a2851"><div class="ttname"><a href="group__iz__arrays.html#gab1a0ced5e600649da6e519693a3a2851">ui64_free</a></div><div class="ttdeci">void ui64_free(UI64_ARRAY **array)</div><div class="ttdoc">Free a UI64 array and null the caller pointer.</div></div>
<div class="ttc" id="agroup__iz__arrays_html_gaf19906d91639a464ff36cc425968bdae"><div class="ttname"><a href="group__iz__arrays.html#gaf19906d91639a464ff36cc425968bdae">ui16_push</a></div><div class="ttdeci">void ui16_push(UI16_ARRAY *array, uint16_t element)</div><div class="ttdoc">Append a uint16 value, growing storage if needed.</div></div>
<div class="ttc" id="agroup__iz__arrays_html_gaf9ef1b739df3c37089c62c7f1adbfdce"><div class="ttname"><a href="group__iz__arrays.html#gaf9ef1b739df3c37089c62c7f1adbfdce">ui64_init</a></div><div class="ttdeci">UI64_ARRAY * ui64_init(int capacity)</div><div class="ttdoc">Allocate a UI64 array with an initial capacity.</div></div>
<div class="ttc" id="agroup__iz__bitmap_html_ga165a40f31d911d8939771e064e2b87c1"><div class="ttname"><a href="group__iz__bitmap.html#ga165a40f31d911d8939771e064e2b87c1">bitmap_init</a></div><div class="ttdeci">BITMAP * bitmap_init(size_t size, int set_bits)</div><div class="ttdoc">Allocate a bitmap with size bits.</div><div class="ttdef"><b>Definition</b> <a href="bitmap_8c_source.html#l00057">bitmap.c:57</a></div></div>
<div class="ttc" id="agroup__iz__bitmap_html_ga66cb254c9bf38d7adfe83d723baa2e15"><div class="ttname"><a href="group__iz__bitmap.html#ga66cb254c9bf38d7adfe83d723baa2e15">bitmap_free</a></div><div class="ttdeci">void bitmap_free(BITMAP **bitmap)</div><div class="ttdoc">Free a bitmap and set the caller pointer to NULL.</div><div class="ttdef"><b>Definition</b> <a href="bitmap_8c_source.html#l00103">bitmap.c:103</a></div></div>
<div class="ttc" id="agroup__iz__bitmap_html_ga7a2c67bab864cee11a8ffcf2f5b6ce8f"><div class="ttname"><a href="group__iz__bitmap.html#ga7a2c67bab864cee11a8ffcf2f5b6ce8f">bitmap_get_bit</a></div><div class="ttdeci">int bitmap_get_bit(BITMAP *bitmap, size_t idx)</div><div class="ttdoc">Read bit value at idx.</div><div class="ttdef"><b>Definition</b> <a href="bitmap_8c_source.html#l00137">bitmap.c:137</a></div></div>
<div class="ttc" id="agroup__iz__bitmap_html_ga80c50898b0382af34259c599a4b329f7"><div class="ttname"><a href="group__iz__bitmap.html#ga80c50898b0382af34259c599a4b329f7">bitmap_clear_steps_simd</a></div><div class="ttdeci">void bitmap_clear_steps_simd(BITMAP *bitmap, uint64_t step, uint64_t start_idx, uint64_t limit)</div><div class="ttdoc">SIMD-accelerated variant of bitmap_clear_steps().</div><div class="ttdef"><b>Definition</b> <a href="bitmap_8c_source.html#l00233">bitmap.c:233</a></div></div>
<div class="ttc" id="agroup__iz__bitmap_html_ga8589bfd273ccc48de55072eeefd1dd93"><div class="ttname"><a href="group__iz__bitmap.html#ga8589bfd273ccc48de55072eeefd1dd93">bitmap_clear_steps</a></div><div class="ttdeci">void bitmap_clear_steps(BITMAP *bitmap, uint64_t step, uint64_t start_idx, uint64_t limit)</div><div class="ttdoc">Clear every step-th bit from start_idx up to limit.</div><div class="ttdef"><b>Definition</b> <a href="bitmap_8c_source.html#l00210">bitmap.c:210</a></div></div>
<div class="ttc" id="agroup__iz__bitmap_html_ga958df9e667d4516791537c988fb01999"><div class="ttname"><a href="group__iz__bitmap.html#ga958df9e667d4516791537c988fb01999">bitmap_clear_bit</a></div><div class="ttdeci">void bitmap_clear_bit(BITMAP *bitmap, size_t idx)</div><div class="ttdoc">Clear bit at idx (set to 0).</div><div class="ttdef"><b>Definition</b> <a href="bitmap_8c_source.html#l00159">bitmap.c:159</a></div></div>
<div class="ttc" id="agroup__iz__bitmap_html_gabc118534bd59159ed55c509bd1b795e9"><div class="ttname"><a href="group__iz__bitmap.html#gabc118534bd59159ed55c509bd1b795e9">bitmap_clone</a></div><div class="ttdeci">BITMAP * bitmap_clone(BITMAP *src)</div><div class="ttdoc">Deep-copy a bitmap, including data and checksum.</div><div class="ttdef"><b>Definition</b> <a href="bitmap_8c_source.html#l00382">bitmap.c:382</a></div></div>
<div class="ttc" id="agroup__iz__bitmap_html_gad0afb1000bb11c5aca082e45f813ded2"><div class="ttname"><a href="group__iz__bitmap.html#gad0afb1000bb11c5aca082e45f813ded2">bitmap_set_all</a></div><div class="ttdeci">void bitmap_set_all(BITMAP *bitmap)</div><div class="ttdoc">Set all bits to 1.</div><div class="ttdef"><b>Definition</b> <a href="bitmap_8c_source.html#l00170">bitmap.c:170</a></div></div>
<div class="ttc" id="agroup__iz__logger_html_ga3dc3bd5ec0c013065ffc731ea33271d5"><div class="ttname"><a href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error</a></div><div class="ttdeci">void void void void void void void log_error(const char *format,...) LOGGER_FORMAT_PRINTF(1</div><div class="ttdoc">Logs an error message.</div></div>
<div class="ttc" id="agroup__iz__logger_html_ga49528dc2f0c8d5628f13358382f8d5b4"><div class="ttname"><a href="group__iz__logger.html#ga49528dc2f0c8d5628f13358382f8d5b4">log_info</a></div><div class="ttdeci">void void void void void log_info(const char *format,...) LOGGER_FORMAT_PRINTF(1</div><div class="ttdoc">Logs an info message.</div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga02e061a03533010221ce47c043ddc53c"><div class="ttname"><a href="group__iz__toolkit.html#ga02e061a03533010221ce47c043ddc53c">vx_search_prime</a></div><div class="ttdeci">int vx_search_prime(mpz_t p, int m_id, int vx, int bit_size)</div><div class="ttdoc">Horizontal iZm/VX random-prime search.</div><div class="ttdef"><b>Definition</b> <a href="#l01017">iZ_toolkit.c:1017</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga1dbb019b08a42984e1733f0c7c3881a0"><div class="ttname"><a href="group__iz__toolkit.html#ga1dbb019b08a42984e1733f0c7c3881a0">check_primality</a></div><div class="ttdeci">int check_primality(mpz_t n, int rounds)</div><div class="ttdoc">Check the primality of a number using GMP&#39;s probabilistic test.</div><div class="ttdef"><b>Definition</b> <a href="#l00153">iZ_toolkit.c:153</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga214f95ac7b685a7ff0c596afc70036b7"><div class="ttname"><a href="group__iz__toolkit.html#ga214f95ac7b685a7ff0c596afc70036b7">vx_full_sieve</a></div><div class="ttdeci">void vx_full_sieve(VX_SEG *vx_obj, int collect_p_gaps)</div><div class="ttdoc">Complete segment processing (probabilistic stage and optional gaps).</div><div class="ttdef"><b>Definition</b> <a href="#l00847">iZ_toolkit.c:847</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga234719b01a0e090a1f66ed7766fe6d0f"><div class="ttname"><a href="group__iz__toolkit.html#ga234719b01a0e090a1f66ed7766fe6d0f">vx_init</a></div><div class="ttdeci">VX_SEG * vx_init(IZM *iZm, int start_x, int end_x, char *y_str, int mr_rounds)</div><div class="ttdoc">Initialize and deterministically sieve one VX segment.</div><div class="ttdef"><b>Definition</b> <a href="#l00713">iZ_toolkit.c:713</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga23df437281a4315af3cff9b76fab9dd8"><div class="ttname"><a href="group__iz__toolkit.html#ga23df437281a4315af3cff9b76fab9dd8">compute_max_vx</a></div><div class="ttdeci">void compute_max_vx(mpz_t vx, int bit_size)</div><div class="ttdoc">Compute largest VX below 2^bit_size.</div><div class="ttdef"><b>Definition</b> <a href="#l00331">iZ_toolkit.c:331</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga3ee0fd9e3f27fd5d30fddfe7d1056c57"><div class="ttname"><a href="group__iz__toolkit.html#ga3ee0fd9e3f27fd5d30fddfe7d1056c57">iZm_solve_for_x0_mpz</a></div><div class="ttdeci">uint64_t iZm_solve_for_x0_mpz(int m_id, uint64_t p, uint64_t vx, mpz_t y)</div><div class="ttdoc">GMP variant of iZm_solve_for_x0() for very large y.</div><div class="ttdef"><b>Definition</b> <a href="#l00449">iZ_toolkit.c:449</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga50cf18d6528c411820a9b081b13875ca"><div class="ttname"><a href="group__iz__toolkit.html#ga50cf18d6528c411820a9b081b13875ca">iZm_solve_for_y0</a></div><div class="ttdeci">int64_t iZm_solve_for_y0(int m_id, uint64_t p, uint64_t vx, uint64_t x)</div><div class="ttdoc">Solve first y-hit for fixed x in vertical (vy) scanning.</div><div class="ttdef"><b>Definition</b> <a href="#l00490">iZ_toolkit.c:490</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga58ea9ced15462006d8a8c223719c57f4"><div class="ttname"><a href="group__iz__toolkit.html#ga58ea9ced15462006d8a8c223719c57f4">vy_search_prime</a></div><div class="ttdeci">int vy_search_prime(mpz_t p, int m_id, mpz_t vx)</div><div class="ttdoc">Vertical iZm/VY random-prime search.</div><div class="ttdef"><b>Definition</b> <a href="#l01114">iZ_toolkit.c:1114</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga591a1d1fae4f8a241c6b6ed7f495eae6"><div class="ttname"><a href="group__iz__toolkit.html#ga591a1d1fae4f8a241c6b6ed7f495eae6">vx_stream</a></div><div class="ttdeci">void vx_stream(VX_SEG *vx_obj, FILE *output)</div><div class="ttdoc">Stream segment primes to an output stream.</div><div class="ttdef"><b>Definition</b> <a href="#l00866">iZ_toolkit.c:866</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga596920e4772d76fe9dc61a541b282275"><div class="ttname"><a href="group__iz__toolkit.html#ga596920e4772d76fe9dc61a541b282275">iZm_solve_for_x0</a></div><div class="ttdeci">uint64_t iZm_solve_for_x0(int m_id, uint64_t p, uint64_t vx, uint64_t y)</div><div class="ttdoc">Solve first x-hit of prime p for line m_id in segment y.</div><div class="ttdef"><b>Definition</b> <a href="#l00415">iZ_toolkit.c:415</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga5ada19be750a6f9b0837805ef34a1de4"><div class="ttname"><a href="group__iz__toolkit.html#ga5ada19be750a6f9b0837805ef34a1de4">range_info_init</a></div><div class="ttdeci">IZM_RANGE_INFO range_info_init(INPUT_SIEVE_RANGE *input_range, int vx)</div><div class="ttdoc">Map a decimal range input into iZm coordinates and segment bounds.</div><div class="ttdef"><b>Definition</b> <a href="#l00944">iZ_toolkit.c:944</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga6170b19f9022bf256850f1f2ee6dd786"><div class="ttname"><a href="group__iz__toolkit.html#ga6170b19f9022bf256850f1f2ee6dd786">compute_vx_k</a></div><div class="ttdeci">uint64_t compute_vx_k(int k)</div><div class="ttdoc">Calculate VX_{ k }.</div><div class="ttdef"><b>Definition</b> <a href="#l00286">iZ_toolkit.c:286</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga81a316b2719f678e9fbc4ac8c835460c"><div class="ttname"><a href="group__iz__toolkit.html#ga81a316b2719f678e9fbc4ac8c835460c">iZm_free</a></div><div class="ttdeci">void iZm_free(IZM **iZm)</div><div class="ttdoc">Release an IZM object and set the caller pointer to NULL.</div><div class="ttdef"><b>Definition</b> <a href="#l00266">iZ_toolkit.c:266</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga824821f174cc26db2d310a68e8c2f19e"><div class="ttname"><a href="group__iz__toolkit.html#ga824821f174cc26db2d310a68e8c2f19e">vx_collect_p_gaps</a></div><div class="ttdeci">void vx_collect_p_gaps(VX_SEG *vx_obj)</div><div class="ttdoc">Extract prime-gap encoding from a fully sieved segment.</div><div class="ttdef"><b>Definition</b> <a href="#l00787">iZ_toolkit.c:787</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga865e51a5e6f28945747e2ad6988c2e4e"><div class="ttname"><a href="group__iz__toolkit.html#ga865e51a5e6f28945747e2ad6988c2e4e">process_iZ_bitmaps</a></div><div class="ttdeci">void process_iZ_bitmaps(UI64_ARRAY *primes, BITMAP *x5, BITMAP *x7, uint64_t x_limit)</div><div class="ttdoc">Traverse iZ bitmaps, emit surviving primes, and mark composites.</div><div class="ttdef"><b>Definition</b> <a href="#l00070">iZ_toolkit.c:70</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_ga89a2804cb4fa979a32e4213ade786ec4"><div class="ttname"><a href="group__iz__toolkit.html#ga89a2804cb4fa979a32e4213ade786ec4">vx_free</a></div><div class="ttdeci">void vx_free(VX_SEG **vx_obj)</div><div class="ttdoc">Free a VX segment and all owned resources.</div><div class="ttdef"><b>Definition</b> <a href="#l00759">iZ_toolkit.c:759</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_gaa00f10dbfb5d0730503a789900de9134"><div class="ttname"><a href="group__iz__toolkit.html#gaa00f10dbfb5d0730503a789900de9134">MR_ROUNDS</a></div><div class="ttdeci">#define MR_ROUNDS</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00079">iZ_toolkit.h:79</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_gaa3f0472ebd680beaa6b0759acbedd9eb"><div class="ttname"><a href="group__iz__toolkit.html#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a></div><div class="ttdeci">void iZ_mpz(mpz_t z, mpz_t x, int i)</div><div class="ttdoc">Computes 6x + i for arbitrary precision values using GMP.</div><div class="ttdef"><b>Definition</b> <a href="#l00037">iZ_toolkit.c:37</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_gaa8c21336f708189a8d18f41085468c5c"><div class="ttname"><a href="group__iz__toolkit.html#gaa8c21336f708189a8d18f41085468c5c">iZm_clone</a></div><div class="ttdeci">IZM * iZm_clone(IZM *src)</div><div class="ttdoc">Deep-copy an IZM object for per-worker ownership.</div><div class="ttdef"><b>Definition</b> <a href="#l00232">iZ_toolkit.c:232</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_gab053af28699e3138640445b16a1311f7"><div class="ttname"><a href="group__iz__toolkit.html#gab053af28699e3138640445b16a1311f7">range_info_free</a></div><div class="ttdeci">void range_info_free(IZM_RANGE_INFO *info)</div><div class="ttdoc">Clear all GMP fields owned by info.</div><div class="ttdef"><b>Definition</b> <a href="#l00989">iZ_toolkit.c:989</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_gac92eb547227979fc0774e0529efa6180"><div class="ttname"><a href="group__iz__toolkit.html#gac92eb547227979fc0774e0529efa6180">compute_l2_vx</a></div><div class="ttdeci">uint64_t compute_l2_vx(uint64_t n)</div><div class="ttdoc">Choose VX using an L2-cache-aware heuristic.</div><div class="ttdef"><b>Definition</b> <a href="#l00306">iZ_toolkit.c:306</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_gacf776a7cedd726d8362aaf344102365d"><div class="ttname"><a href="group__iz__toolkit.html#gacf776a7cedd726d8362aaf344102365d">iZm_construct_vx_base</a></div><div class="ttdeci">void iZm_construct_vx_base(uint64_t vx, BITMAP *base_x5, BITMAP *base_x7)</div><div class="ttdoc">Build pre-sieved base bitmaps for a VX segment.</div><div class="ttdef"><b>Definition</b> <a href="#l00363">iZ_toolkit.c:363</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_gadc4e21760e38081c6966fa9d9d23e940"><div class="ttname"><a href="group__iz__toolkit.html#gadc4e21760e38081c6966fa9d9d23e940">get_root_primes</a></div><div class="ttdeci">void get_root_primes(UI64_ARRAY *primes, uint64_t limit)</div><div class="ttdoc">Generate primes up to limit for deterministic sieving.</div><div class="ttdef"><b>Definition</b> <a href="#l00112">iZ_toolkit.c:112</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_gaeb29a4d0536bb0aa227e230539081d98"><div class="ttname"><a href="group__iz__toolkit.html#gaeb29a4d0536bb0aa227e230539081d98">iZm_init</a></div><div class="ttdeci">IZM * iZm_init(size_t vx)</div><div class="ttdoc">Allocate and initialize an IZM object for a given VX.</div><div class="ttdef"><b>Definition</b> <a href="#l00184">iZ_toolkit.c:184</a></div></div>
<div class="ttc" id="agroup__iz__toolkit_html_gaffec7a5b407ee6c59ccc1678e0ab89ba"><div class="ttname"><a href="group__iz__toolkit.html#gaffec7a5b407ee6c59ccc1678e0ab89ba">iZ</a></div><div class="ttdeci">uint64_t iZ(uint64_t x, int i)</div><div class="ttdoc">Computes 6x + i for a given x and i.</div><div class="ttdef"><b>Definition</b> <a href="#l00024">iZ_toolkit.c:24</a></div></div>
<div class="ttc" id="agroup__iz__utils_html_ga05d1ac8d90873705cd22e1c83345fa71"><div class="ttname"><a href="group__iz__utils.html#ga05d1ac8d90873705cd22e1c83345fa71">gcd</a></div><div class="ttdeci">uint64_t gcd(uint64_t a, uint64_t b)</div><div class="ttdoc">Compute the greatest common divisor of a and b.</div><div class="ttdef"><b>Definition</b> <a href="utils_8c_source.html#l00425">utils.c:425</a></div></div>
<div class="ttc" id="agroup__iz__utils_html_ga3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="group__iz__utils.html#ga3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdoc">Return the smaller of two expressions.</div><div class="ttdef"><b>Definition</b> <a href="utils_8h_source.html#l00048">utils.h:48</a></div></div>
<div class="ttc" id="agroup__iz__utils_html_ga595ea61a3090228f6f23a32b046feaef"><div class="ttname"><a href="group__iz__utils.html#ga595ea61a3090228f6f23a32b046feaef">modular_inverse</a></div><div class="ttdeci">uint64_t modular_inverse(uint64_t a, uint64_t m)</div><div class="ttdoc">Compute the modular inverse of a modulo m.</div><div class="ttdef"><b>Definition</b> <a href="utils_8c_source.html#l00453">utils.c:453</a></div></div>
<div class="ttc" id="agroup__iz__utils_html_ga66ae2bd59e23d5bfc0103ceebbbdfa64"><div class="ttname"><a href="group__iz__utils.html#ga66ae2bd59e23d5bfc0103ceebbbdfa64">gmp_seed_randstate</a></div><div class="ttdeci">void gmp_seed_randstate(gmp_randstate_t state)</div><div class="ttdoc">Seed a GMP random state.</div><div class="ttdef"><b>Definition</b> <a href="utils_8c_source.html#l00486">utils.c:486</a></div></div>
<div class="ttc" id="agroup__iz__utils_html_gac79290998392d17d4420f651f7ad31e9"><div class="ttname"><a href="group__iz__utils.html#gac79290998392d17d4420f651f7ad31e9">get_cpu_L2_cache_size_bits</a></div><div class="ttdeci">int get_cpu_L2_cache_size_bits(void)</div><div class="ttdoc">Return the CPU L2 cache size in bits (best effort).</div><div class="ttdef"><b>Definition</b> <a href="utils_8c_source.html#l00531">utils.c:531</a></div></div>
<div class="ttc" id="agroup__iz__utils_html_gafa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="group__iz__utils.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdoc">Return the larger of two expressions.</div><div class="ttdef"><b>Definition</b> <a href="utils_8h_source.html#l00052">utils.h:52</a></div></div>
<div class="ttc" id="ai_z__api_8h_html"><div class="ttname"><a href="i_z__api_8h.html">iZ_api.h</a></div><div class="ttdoc">Public API for prime sieving, range scans, and prime generation.</div></div>
<div class="ttc" id="ai_z__toolkit_8c_html_a0acf76d4f3ff2e6e4421b9115c694823"><div class="ttname"><a href="i_z__toolkit_8c.html#a0acf76d4f3ff2e6e4421b9115c694823">vx_det_sieve</a></div><div class="ttdeci">static void vx_det_sieve(IZM *iZm, VX_SEG *vx_obj)</div><div class="ttdoc">Deterministic phase: mark composites using root primes.</div><div class="ttdef"><b>Definition</b> <a href="#l00566">iZ_toolkit.c:566</a></div></div>
<div class="ttc" id="ai_z__toolkit_8c_html_a1cb99e772f16a844ff9f04ffcd3e632f"><div class="ttname"><a href="i_z__toolkit_8c.html#a1cb99e772f16a844ff9f04ffcd3e632f">vx_set_base_values</a></div><div class="ttdeci">static int vx_set_base_values(VX_SEG *vx_obj, char *y_str)</div><div class="ttdoc">Initialize mpz-dependent base fields for a VX segment object.</div><div class="ttdef"><b>Definition</b> <a href="#l00529">iZ_toolkit.c:529</a></div></div>
<div class="ttc" id="ai_z__toolkit_8c_html_aa724ea8ac82fc99775f39770db26538d"><div class="ttname"><a href="i_z__toolkit_8c.html#aa724ea8ac82fc99775f39770db26538d">s_primes_count</a></div><div class="ttdeci">static int s_primes_count</div><div class="ttdef"><b>Definition</b> <a href="#l00013">iZ_toolkit.c:13</a></div></div>
<div class="ttc" id="ai_z__toolkit_8c_html_ad55dff6a86df70d0e1e02c66a4344968"><div class="ttname"><a href="i_z__toolkit_8c.html#ad55dff6a86df70d0e1e02c66a4344968">s_primes</a></div><div class="ttdeci">static const int s_primes[]</div><div class="ttdef"><b>Definition</b> <a href="#l00010">iZ_toolkit.c:10</a></div></div>
<div class="ttc" id="ai_z__toolkit_8c_html_adf61955b452b3d1401a90d803999f819"><div class="ttname"><a href="i_z__toolkit_8c.html#adf61955b452b3d1401a90d803999f819">compute_k_vx</a></div><div class="ttdeci">static int compute_k_vx(IZM *iZm)</div><div class="ttdoc">Count how many small primes (&gt;3) divide vx.</div><div class="ttdef"><b>Definition</b> <a href="#l00052">iZ_toolkit.c:52</a></div></div>
<div class="ttc" id="ai_z__toolkit_8c_html_ae75ea043adeb58f25e079d1b46984d63"><div class="ttname"><a href="i_z__toolkit_8c.html#ae75ea043adeb58f25e079d1b46984d63">vx_prob_sieve</a></div><div class="ttdeci">static void vx_prob_sieve(VX_SEG *vx_obj)</div><div class="ttdoc">Perform probabilistic sieve cleanup for large numeric ranges.</div><div class="ttdef"><b>Definition</b> <a href="#l00633">iZ_toolkit.c:633</a></div></div>
<div class="ttc" id="astruct_b_i_t_m_a_p_html"><div class="ttname"><a href="struct_b_i_t_m_a_p.html">BITMAP</a></div><div class="ttdoc">Packed bit-array with optional SHA-256 checksum.</div><div class="ttdef"><b>Definition</b> <a href="bitmap_8h_source.html#l00026">bitmap.h:27</a></div></div>
<div class="ttc" id="astruct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e_html"><div class="ttname"><a href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html">INPUT_SIEVE_RANGE</a></div><div class="ttdoc">Input parameters for range sieving/counting.</div><div class="ttdef"><b>Definition</b> <a href="i_z__api_8h_source.html#l00124">iZ_api.h:125</a></div></div>
<div class="ttc" id="astruct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e_html_aa130dc66a14ad2622c250382fcef83b5"><div class="ttname"><a href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html#aa130dc66a14ad2622c250382fcef83b5">INPUT_SIEVE_RANGE::start</a></div><div class="ttdeci">char * start</div><div class="ttdoc">Start of range as a base-10 numeric string.</div><div class="ttdef"><b>Definition</b> <a href="i_z__api_8h_source.html#l00126">iZ_api.h:126</a></div></div>
<div class="ttc" id="astruct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e_html_aad5d9f7a094db43297ca9fff6cf4ddd9"><div class="ttname"><a href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html#aad5d9f7a094db43297ca9fff6cf4ddd9">INPUT_SIEVE_RANGE::range</a></div><div class="ttdeci">uint64_t range</div><div class="ttdoc">Interval size (number of integers to cover).</div><div class="ttdef"><b>Definition</b> <a href="i_z__api_8h_source.html#l00127">iZ_api.h:127</a></div></div>
<div class="ttc" id="astruct_i_z_m___r_a_n_g_e___i_n_f_o_html"><div class="ttname"><a href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a></div><div class="ttdoc">Precomputed iZm coordinates for an inclusive numeric interval.</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00254">iZ_toolkit.h:255</a></div></div>
<div class="ttc" id="astruct_i_z_m___r_a_n_g_e___i_n_f_o_html_a1946eaa4ccabece4bd5bd2eb7d59881a"><div class="ttname"><a href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a1946eaa4ccabece4bd5bd2eb7d59881a">IZM_RANGE_INFO::vx</a></div><div class="ttdeci">int vx</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00256">iZ_toolkit.h:256</a></div></div>
<div class="ttc" id="astruct_i_z_m___r_a_n_g_e___i_n_f_o_html_a28b5500837aa3d2cf68145ee5934afad"><div class="ttname"><a href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a28b5500837aa3d2cf68145ee5934afad">IZM_RANGE_INFO::Ze</a></div><div class="ttdeci">mpz_t Ze</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00258">iZ_toolkit.h:258</a></div></div>
<div class="ttc" id="astruct_i_z_m___r_a_n_g_e___i_n_f_o_html_a3f8fe0b07e9ac77cf634438cfff9a31b"><div class="ttname"><a href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a3f8fe0b07e9ac77cf634438cfff9a31b">IZM_RANGE_INFO::y_range</a></div><div class="ttdeci">int y_range</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00263">iZ_toolkit.h:263</a></div></div>
<div class="ttc" id="astruct_i_z_m___r_a_n_g_e___i_n_f_o_html_a79e2a9589301aef116ef5d6e0f729cbe"><div class="ttname"><a href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a79e2a9589301aef116ef5d6e0f729cbe">IZM_RANGE_INFO::Ys</a></div><div class="ttdeci">mpz_t Ys</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00261">iZ_toolkit.h:261</a></div></div>
<div class="ttc" id="astruct_i_z_m___r_a_n_g_e___i_n_f_o_html_a8e9a581955081eb9709028a3a81ebdef"><div class="ttname"><a href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#a8e9a581955081eb9709028a3a81ebdef">IZM_RANGE_INFO::Zs</a></div><div class="ttdeci">mpz_t Zs</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00257">iZ_toolkit.h:257</a></div></div>
<div class="ttc" id="astruct_i_z_m___r_a_n_g_e___i_n_f_o_html_aa89816e932bfef3052a120c3971b09c7"><div class="ttname"><a href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#aa89816e932bfef3052a120c3971b09c7">IZM_RANGE_INFO::Ye</a></div><div class="ttdeci">mpz_t Ye</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00262">iZ_toolkit.h:262</a></div></div>
<div class="ttc" id="astruct_i_z_m___r_a_n_g_e___i_n_f_o_html_acc00a32b6cffc91a9e947ecbb6ea97dc"><div class="ttname"><a href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#acc00a32b6cffc91a9e947ecbb6ea97dc">IZM_RANGE_INFO::Xe</a></div><div class="ttdeci">mpz_t Xe</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00260">iZ_toolkit.h:260</a></div></div>
<div class="ttc" id="astruct_i_z_m___r_a_n_g_e___i_n_f_o_html_aec64414685210cc45b6d75249b170561"><div class="ttname"><a href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#aec64414685210cc45b6d75249b170561">IZM_RANGE_INFO::Xs</a></div><div class="ttdeci">mpz_t Xs</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00259">iZ_toolkit.h:259</a></div></div>
<div class="ttc" id="astruct_i_z_m_html"><div class="ttname"><a href="struct_i_z_m.html">IZM</a></div><div class="ttdoc">Precomputed iZm assets for repeated VX-segment sieving.</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00084">iZ_toolkit.h:85</a></div></div>
<div class="ttc" id="astruct_i_z_m_html_a145d315e6751952fbf0d6b45af951e1b"><div class="ttname"><a href="struct_i_z_m.html#a145d315e6751952fbf0d6b45af951e1b">IZM::root_primes</a></div><div class="ttdeci">UI64_ARRAY * root_primes</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00090">iZ_toolkit.h:90</a></div></div>
<div class="ttc" id="astruct_i_z_m_html_aa0cd5920cd875d959ee2c40b7c845382"><div class="ttname"><a href="struct_i_z_m.html#aa0cd5920cd875d959ee2c40b7c845382">IZM::k_vx</a></div><div class="ttdeci">int k_vx</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00087">iZ_toolkit.h:87</a></div></div>
<div class="ttc" id="astruct_i_z_m_html_ac5d6cad1cb4e3d7b6c4ef7a999283615"><div class="ttname"><a href="struct_i_z_m.html#ac5d6cad1cb4e3d7b6c4ef7a999283615">IZM::vx</a></div><div class="ttdeci">int vx</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00086">iZ_toolkit.h:86</a></div></div>
<div class="ttc" id="astruct_i_z_m_html_afbda5590cfc085366c41769a8054fcde"><div class="ttname"><a href="struct_i_z_m.html#afbda5590cfc085366c41769a8054fcde">IZM::base_x5</a></div><div class="ttdeci">BITMAP * base_x5</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00088">iZ_toolkit.h:88</a></div></div>
<div class="ttc" id="astruct_i_z_m_html_afe3d89b8ae3ad315e952093c945e1073"><div class="ttname"><a href="struct_i_z_m.html#afe3d89b8ae3ad315e952093c945e1073">IZM::base_x7</a></div><div class="ttdeci">BITMAP * base_x7</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00089">iZ_toolkit.h:89</a></div></div>
<div class="ttc" id="astruct_u_i64___a_r_r_a_y_html"><div class="ttname"><a href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a></div><div class="ttdoc">Dynamic array for uint64_t values.</div><div class="ttdef"><b>Definition</b> <a href="int__arrays_8h_source.html#l00039">int_arrays.h:40</a></div></div>
<div class="ttc" id="astruct_u_i64___a_r_r_a_y_html_a337d001ba534fed8a25bb9b80351f332"><div class="ttname"><a href="struct_u_i64___a_r_r_a_y.html#a337d001ba534fed8a25bb9b80351f332">UI64_ARRAY::array</a></div><div class="ttdeci">uint64_t * array</div><div class="ttdef"><b>Definition</b> <a href="int__arrays_8h_source.html#l00043">int_arrays.h:43</a></div></div>
<div class="ttc" id="astruct_u_i64___a_r_r_a_y_html_a5eb007453bedeebe1332d5c2dddaa7c8"><div class="ttname"><a href="struct_u_i64___a_r_r_a_y.html#a5eb007453bedeebe1332d5c2dddaa7c8">UI64_ARRAY::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition</b> <a href="int__arrays_8h_source.html#l00042">int_arrays.h:42</a></div></div>
<div class="ttc" id="astruct_u_i64___a_r_r_a_y_html_a9579279ed0a82bc8e7e36365d8dc03df"><div class="ttname"><a href="struct_u_i64___a_r_r_a_y.html#a9579279ed0a82bc8e7e36365d8dc03df">UI64_ARRAY::capacity</a></div><div class="ttdeci">int capacity</div><div class="ttdef"><b>Definition</b> <a href="int__arrays_8h_source.html#l00041">int_arrays.h:41</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html"><div class="ttname"><a href="struct_v_x___s_e_g.html">VX_SEG</a></div><div class="ttdoc">Runtime state for one VX segment at a specific y.</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00184">iZ_toolkit.h:185</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a0f26a18865664cff47076ffd33b3b0ca"><div class="ttname"><a href="struct_v_x___s_e_g.html#a0f26a18865664cff47076ffd33b3b0ca">VX_SEG::x7</a></div><div class="ttdeci">BITMAP * x7</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00195">iZ_toolkit.h:195</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a25bbcd26bb0e69a6b9584594a714b8b5"><div class="ttname"><a href="struct_v_x___s_e_g.html#a25bbcd26bb0e69a6b9584594a714b8b5">VX_SEG::p_gaps</a></div><div class="ttdeci">UI16_ARRAY * p_gaps</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00197">iZ_toolkit.h:197</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a37fa278f6fceded67c8a852299e90dd9"><div class="ttname"><a href="struct_v_x___s_e_g.html#a37fa278f6fceded67c8a852299e90dd9">VX_SEG::mr_rounds</a></div><div class="ttdeci">int mr_rounds</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00191">iZ_toolkit.h:191</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a3e464acdf8995998d7b8120d02d38347"><div class="ttname"><a href="struct_v_x___s_e_g.html#a3e464acdf8995998d7b8120d02d38347">VX_SEG::p_test_ops</a></div><div class="ttdeci">int p_test_ops</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00199">iZ_toolkit.h:199</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a40f181e2538f16411d5815bc71b8b757"><div class="ttname"><a href="struct_v_x___s_e_g.html#a40f181e2538f16411d5815bc71b8b757">VX_SEG::x5</a></div><div class="ttdeci">BITMAP * x5</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00194">iZ_toolkit.h:194</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a4216a3e0c60c73e96a17b3f5e46af885"><div class="ttname"><a href="struct_v_x___s_e_g.html#a4216a3e0c60c73e96a17b3f5e46af885">VX_SEG::is_large_limit</a></div><div class="ttdeci">int is_large_limit</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00190">iZ_toolkit.h:190</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a537a59185c9aaf9e4dbc77a5c0814d42"><div class="ttname"><a href="struct_v_x___s_e_g.html#a537a59185c9aaf9e4dbc77a5c0814d42">VX_SEG::bit_ops</a></div><div class="ttdeci">int bit_ops</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00198">iZ_toolkit.h:198</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a5696dc17af745d6e74c1ccbaee34f107"><div class="ttname"><a href="struct_v_x___s_e_g.html#a5696dc17af745d6e74c1ccbaee34f107">VX_SEG::y</a></div><div class="ttdeci">mpz_t y</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00187">iZ_toolkit.h:187</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a5f0828d3ca77feea9d7ac78d6639f194"><div class="ttname"><a href="struct_v_x___s_e_g.html#a5f0828d3ca77feea9d7ac78d6639f194">VX_SEG::p_count</a></div><div class="ttdeci">int p_count</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00196">iZ_toolkit.h:196</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a7f75ee96453b5bb07d0efa9acead960b"><div class="ttname"><a href="struct_v_x___s_e_g.html#a7f75ee96453b5bb07d0efa9acead960b">VX_SEG::yvx</a></div><div class="ttdeci">mpz_t yvx</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00188">iZ_toolkit.h:188</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_a8f766c26d7a5bc718a748ea0401cd3fc"><div class="ttname"><a href="struct_v_x___s_e_g.html#a8f766c26d7a5bc718a748ea0401cd3fc">VX_SEG::start_x</a></div><div class="ttdeci">int start_x</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00192">iZ_toolkit.h:192</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_ada8599db1f49096440074feaa3513fba"><div class="ttname"><a href="struct_v_x___s_e_g.html#ada8599db1f49096440074feaa3513fba">VX_SEG::end_x</a></div><div class="ttdeci">int end_x</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00193">iZ_toolkit.h:193</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_af73da08033e4261e7fd397f6f900edc1"><div class="ttname"><a href="struct_v_x___s_e_g.html#af73da08033e4261e7fd397f6f900edc1">VX_SEG::vx</a></div><div class="ttdeci">int vx</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00186">iZ_toolkit.h:186</a></div></div>
<div class="ttc" id="astruct_v_x___s_e_g_html_af74e0169f2702d9fbc4f7e3d0993539f"><div class="ttname"><a href="struct_v_x___s_e_g.html#af74e0169f2702d9fbc4f7e3d0993539f">VX_SEG::root_limit</a></div><div class="ttdeci">mpz_t root_limit</div><div class="ttdef"><b>Definition</b> <a href="i_z__toolkit_8h_source.html#l00189">iZ_toolkit.h:189</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>src</b></li><li class="navelem"><b>toolkit</b></li><li class="navelem"><a href="i_z__toolkit_8c.html">iZ_toolkit.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
