<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iZ-Library: Toolkit (iZ/iZm)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">iZ-Library<span id="projectnumber">&#160;0.0.1</span>
   </div>
   <div id="projectbrief">iZ-Library for prime sieving and generation tasks.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group__iz__toolkit.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Toolkit (iZ/iZm) </div></div>
</div><!--header-->
<div class="contents">

<p>Internal building blocks for SiZ and SiZm implementations.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-files" class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:iZ_5Ftoolkit_2Ec" id="r_iZ_5Ftoolkit_2Ec"><td class="memItemLeft">file &#160;</td><td class="memItemRight"><a class="el" href="i_z__toolkit_8c.html">iZ_toolkit.c</a></td></tr>
<tr class="memdesc:i_z__toolkit_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of iZ index space helpers and iZm/VX segment machinery. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:IZM" id="r_IZM"><td class="memItemLeft">struct &#160;</td><td class="memItemRight"><a class="el" href="struct_i_z_m.html">IZM</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precomputed iZm assets for repeated VX-segment sieving.  <a href="struct_i_z_m.html#details">More...</a><br /></td></tr>
<tr class="memitem:VX_5FSEG" id="r_VX_5FSEG"><td class="memItemLeft">struct &#160;</td><td class="memItemRight"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runtime state for one VX segment at a specific y.  <a href="struct_v_x___s_e_g.html#details">More...</a><br /></td></tr>
<tr class="memitem:IZM_5FRANGE_5FINFO" id="r_IZM_5FRANGE_5FINFO"><td class="memItemLeft">struct &#160;</td><td class="memItemRight"><a class="el" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precomputed iZm coordinates for an inclusive numeric interval.  <a href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaa00f10dbfb5d0730503a789900de9134" id="r_gaa00f10dbfb5d0730503a789900de9134"><td class="memItemLeft">#define&#160;</td><td class="memItemRight"><a class="el" href="#gaa00f10dbfb5d0730503a789900de9134">MR_ROUNDS</a>&#160;&#160;&#160;25</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gacf776a7cedd726d8362aaf344102365d" id="r_gacf776a7cedd726d8362aaf344102365d"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#gacf776a7cedd726d8362aaf344102365d">iZm_construct_vx_base</a> (uint64_t vx, <a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *base_x5, <a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *base_x7)</td></tr>
<tr class="memdesc:gacf776a7cedd726d8362aaf344102365d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build pre-sieved base bitmaps for a VX segment.  <br /></td></tr>
<tr class="memitem:ga5ada19be750a6f9b0837805ef34a1de4" id="r_ga5ada19be750a6f9b0837805ef34a1de4"><td class="memItemLeft"><a class="el" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a>&#160;</td><td class="memItemRight"><a class="el" href="#ga5ada19be750a6f9b0837805ef34a1de4">range_info_init</a> (<a class="el" href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html">INPUT_SIEVE_RANGE</a> *input_range, int vx)</td></tr>
<tr class="memdesc:ga5ada19be750a6f9b0837805ef34a1de4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map a decimal range input into iZm coordinates and segment bounds.  <br /></td></tr>
<tr class="memitem:gab053af28699e3138640445b16a1311f7" id="r_gab053af28699e3138640445b16a1311f7"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#gab053af28699e3138640445b16a1311f7">range_info_free</a> (<a class="el" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a> *info)</td></tr>
<tr class="memdesc:gab053af28699e3138640445b16a1311f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all GMP fields owned by <code class="param">info</code>.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-member-group" class="groupheader"><a id="member-group" name="member-group"></a>
iZ Mapping Helpers</h2></td></tr>
<tr class="memitem:gaffec7a5b407ee6c59ccc1678e0ab89ba" id="r_gaffec7a5b407ee6c59ccc1678e0ab89ba"><td class="memItemLeft">uint64_t&#160;</td><td class="memItemRight"><a class="el" href="#gaffec7a5b407ee6c59ccc1678e0ab89ba">iZ</a> (uint64_t x, int i)</td></tr>
<tr class="memdesc:gaffec7a5b407ee6c59ccc1678e0ab89ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map iZ coordinates to an integer: <span class="tt">6*x + i</span>.  <br /></td></tr>
<tr class="memitem:gaa3f0472ebd680beaa6b0759acbedd9eb" id="r_gaa3f0472ebd680beaa6b0759acbedd9eb"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#gaa3f0472ebd680beaa6b0759acbedd9eb">iZ_mpz</a> (mpz_t z, mpz_t x, int i)</td></tr>
<tr class="memdesc:gaa3f0472ebd680beaa6b0759acbedd9eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">GMP variant of <a class="el" href="#gaffec7a5b407ee6c59ccc1678e0ab89ba" title="Map iZ coordinates to an integer: 6*x + i.">iZ()</a>.  <br /></td></tr>
<tr class="memitem:ga865e51a5e6f28945747e2ad6988c2e4e" id="r_ga865e51a5e6f28945747e2ad6988c2e4e"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#ga865e51a5e6f28945747e2ad6988c2e4e">process_iZ_bitmaps</a> (<a class="el" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *primes, <a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *x5, <a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *x7, uint64_t x_limit)</td></tr>
<tr class="memdesc:ga865e51a5e6f28945747e2ad6988c2e4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Traverse iZ bitmaps, emit surviving primes, and mark composites.  <br /></td></tr>
<tr class="memitem:gadc4e21760e38081c6966fa9d9d23e940" id="r_gadc4e21760e38081c6966fa9d9d23e940"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#gadc4e21760e38081c6966fa9d9d23e940">get_root_primes</a> (<a class="el" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *primes, uint64_t limit)</td></tr>
<tr class="memdesc:gadc4e21760e38081c6966fa9d9d23e940"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate primes up to <code class="param">limit</code> for deterministic sieving.  <br /></td></tr>
<tr class="memitem:ga1dbb019b08a42984e1733f0c7c3881a0" id="r_ga1dbb019b08a42984e1733f0c7c3881a0"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="#ga1dbb019b08a42984e1733f0c7c3881a0">check_primality</a> (mpz_t n, int rounds)</td></tr>
<tr class="memdesc:ga1dbb019b08a42984e1733f0c7c3881a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the primality of a number using GMP's probabilistic test.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-member-group" class="groupheader"><a id="member-group" name="member-group"></a>
IZM Lifecycle</h2></td></tr>
<tr class="memitem:gaeb29a4d0536bb0aa227e230539081d98" id="r_gaeb29a4d0536bb0aa227e230539081d98"><td class="memItemLeft"><a class="el" href="struct_i_z_m.html">IZM</a> *&#160;</td><td class="memItemRight"><a class="el" href="#gaeb29a4d0536bb0aa227e230539081d98">iZm_init</a> (size_t vx)</td></tr>
<tr class="memdesc:gaeb29a4d0536bb0aa227e230539081d98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and initialize an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object for a given VX.  <br /></td></tr>
<tr class="memitem:gaa8c21336f708189a8d18f41085468c5c" id="r_gaa8c21336f708189a8d18f41085468c5c"><td class="memItemLeft"><a class="el" href="struct_i_z_m.html">IZM</a> *&#160;</td><td class="memItemRight"><a class="el" href="#gaa8c21336f708189a8d18f41085468c5c">iZm_clone</a> (<a class="el" href="struct_i_z_m.html">IZM</a> *src)</td></tr>
<tr class="memdesc:gaa8c21336f708189a8d18f41085468c5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deep-copy an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object for per-worker ownership.  <br /></td></tr>
<tr class="memitem:ga81a316b2719f678e9fbc4ac8c835460c" id="r_ga81a316b2719f678e9fbc4ac8c835460c"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#ga81a316b2719f678e9fbc4ac8c835460c">iZm_free</a> (<a class="el" href="struct_i_z_m.html">IZM</a> **iZm)</td></tr>
<tr class="memdesc:ga81a316b2719f678e9fbc4ac8c835460c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object and set the caller pointer to NULL.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-member-group" class="groupheader"><a id="member-group" name="member-group"></a>
VX Selection Helpers</h2></td></tr>
<tr class="memitem:ga6170b19f9022bf256850f1f2ee6dd786" id="r_ga6170b19f9022bf256850f1f2ee6dd786"><td class="memItemLeft">uint64_t&#160;</td><td class="memItemRight"><a class="el" href="#ga6170b19f9022bf256850f1f2ee6dd786">compute_vx_k</a> (int k)</td></tr>
<tr class="memdesc:ga6170b19f9022bf256850f1f2ee6dd786"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate VX_{ <code class="param">k</code> }.  <br /></td></tr>
<tr class="memitem:gac92eb547227979fc0774e0529efa6180" id="r_gac92eb547227979fc0774e0529efa6180"><td class="memItemLeft">uint64_t&#160;</td><td class="memItemRight"><a class="el" href="#gac92eb547227979fc0774e0529efa6180">compute_l2_vx</a> (uint64_t n)</td></tr>
<tr class="memdesc:gac92eb547227979fc0774e0529efa6180"><td class="mdescLeft">&#160;</td><td class="mdescRight">Choose VX using an L2-cache-aware heuristic.  <br /></td></tr>
<tr class="memitem:ga23df437281a4315af3cff9b76fab9dd8" id="r_ga23df437281a4315af3cff9b76fab9dd8"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#ga23df437281a4315af3cff9b76fab9dd8">compute_max_vx</a> (mpz_t vx, int bit_size)</td></tr>
<tr class="memdesc:ga23df437281a4315af3cff9b76fab9dd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute largest VX below 2^bit_size.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-member-group" class="groupheader"><a id="member-group" name="member-group"></a>
Modular Hit Solvers</h2></td></tr>
<tr class="memitem:ga596920e4772d76fe9dc61a541b282275" id="r_ga596920e4772d76fe9dc61a541b282275"><td class="memItemLeft">uint64_t&#160;</td><td class="memItemRight"><a class="el" href="#ga596920e4772d76fe9dc61a541b282275">iZm_solve_for_x0</a> (int m_id, uint64_t p, uint64_t vx, uint64_t y)</td></tr>
<tr class="memdesc:ga596920e4772d76fe9dc61a541b282275"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve first x-hit of prime <code class="param">p</code> for line <code class="param">m_id</code> in segment y.  <br /></td></tr>
<tr class="memitem:ga3ee0fd9e3f27fd5d30fddfe7d1056c57" id="r_ga3ee0fd9e3f27fd5d30fddfe7d1056c57"><td class="memItemLeft">uint64_t&#160;</td><td class="memItemRight"><a class="el" href="#ga3ee0fd9e3f27fd5d30fddfe7d1056c57">iZm_solve_for_x0_mpz</a> (int m_id, uint64_t p, uint64_t vx, mpz_t y)</td></tr>
<tr class="memdesc:ga3ee0fd9e3f27fd5d30fddfe7d1056c57"><td class="mdescLeft">&#160;</td><td class="mdescRight">GMP variant of <a class="el" href="#ga596920e4772d76fe9dc61a541b282275" title="Solve first x-hit of prime p for line m_id in segment y.">iZm_solve_for_x0()</a> for very large y.  <br /></td></tr>
<tr class="memitem:ga50cf18d6528c411820a9b081b13875ca" id="r_ga50cf18d6528c411820a9b081b13875ca"><td class="memItemLeft">int64_t&#160;</td><td class="memItemRight"><a class="el" href="#ga50cf18d6528c411820a9b081b13875ca">iZm_solve_for_y0</a> (int m_id, uint64_t p, uint64_t vx, uint64_t x)</td></tr>
<tr class="memdesc:ga50cf18d6528c411820a9b081b13875ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve first y-hit for fixed x in vertical (vy) scanning.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-member-group" class="groupheader"><a id="member-group" name="member-group"></a>
VX Segment Lifecycle and Execution</h2></td></tr>
<tr class="memitem:ga234719b01a0e090a1f66ed7766fe6d0f" id="r_ga234719b01a0e090a1f66ed7766fe6d0f"><td class="memItemLeft"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *&#160;</td><td class="memItemRight"><a class="el" href="#ga234719b01a0e090a1f66ed7766fe6d0f">vx_init</a> (<a class="el" href="struct_i_z_m.html">IZM</a> *iZm, int start_x, int end_x, char *y_str, int mr_rounds)</td></tr>
<tr class="memdesc:ga234719b01a0e090a1f66ed7766fe6d0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize and deterministically sieve one VX segment.  <br /></td></tr>
<tr class="memitem:ga89a2804cb4fa979a32e4213ade786ec4" id="r_ga89a2804cb4fa979a32e4213ade786ec4"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#ga89a2804cb4fa979a32e4213ade786ec4">vx_free</a> (<a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> **vx_obj)</td></tr>
<tr class="memdesc:ga89a2804cb4fa979a32e4213ade786ec4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a VX segment and all owned resources.  <br /></td></tr>
<tr class="memitem:ga824821f174cc26db2d310a68e8c2f19e" id="r_ga824821f174cc26db2d310a68e8c2f19e"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#ga824821f174cc26db2d310a68e8c2f19e">vx_collect_p_gaps</a> (<a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj)</td></tr>
<tr class="memdesc:ga824821f174cc26db2d310a68e8c2f19e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract prime-gap encoding from a fully sieved segment.  <br /></td></tr>
<tr class="memitem:ga214f95ac7b685a7ff0c596afc70036b7" id="r_ga214f95ac7b685a7ff0c596afc70036b7"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#ga214f95ac7b685a7ff0c596afc70036b7">vx_full_sieve</a> (<a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj, int collect_p_gaps)</td></tr>
<tr class="memdesc:ga214f95ac7b685a7ff0c596afc70036b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Complete segment processing (probabilistic stage and optional gaps).  <br /></td></tr>
<tr class="memitem:ga591a1d1fae4f8a241c6b6ed7f495eae6" id="r_ga591a1d1fae4f8a241c6b6ed7f495eae6"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#ga591a1d1fae4f8a241c6b6ed7f495eae6">vx_stream</a> (<a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *vx_obj, FILE *output)</td></tr>
<tr class="memdesc:ga591a1d1fae4f8a241c6b6ed7f495eae6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stream segment primes to an output stream.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-member-group" class="groupheader"><a id="member-group" name="member-group"></a>
Random Prime Search Routines</h2></td></tr>
<tr class="memitem:ga02e061a03533010221ce47c043ddc53c" id="r_ga02e061a03533010221ce47c043ddc53c"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="#ga02e061a03533010221ce47c043ddc53c">vx_search_prime</a> (mpz_t p, int m_id, int vx, int bit_size)</td></tr>
<tr class="memdesc:ga02e061a03533010221ce47c043ddc53c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Horizontal iZm/VX random-prime search.  <br /></td></tr>
<tr class="memitem:ga58ea9ced15462006d8a8c223719c57f4" id="r_ga58ea9ced15462006d8a8c223719c57f4"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="#ga58ea9ced15462006d8a8c223719c57f4">vy_search_prime</a> (mpz_t p, int m_id, mpz_t vx)</td></tr>
<tr class="memdesc:ga58ea9ced15462006d8a8c223719c57f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vertical iZm/VY random-prime search.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-member-group" class="groupheader"><a id="member-group" name="member-group"></a>
Toolkit Tests</h2></td></tr>
<tr class="memitem:gaa10871fd00b11d294cfe98df45120dc0" id="r_gaa10871fd00b11d294cfe98df45120dc0"><td class="memItemLeft"><a id="gaa10871fd00b11d294cfe98df45120dc0" name="gaa10871fd00b11d294cfe98df45120dc0"></a>
int&#160;</td><td class="memItemRight"><b>TEST_IZM</b> (int verbose)</td></tr>
<tr class="memdesc:gaa10871fd00b11d294cfe98df45120dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> construction and solver tests. <br /></td></tr>
<tr class="memitem:gab8ec56858686f5bbccad8bc101cb9f8d" id="r_gab8ec56858686f5bbccad8bc101cb9f8d"><td class="memItemLeft"><a id="gab8ec56858686f5bbccad8bc101cb9f8d" name="gab8ec56858686f5bbccad8bc101cb9f8d"></a>
int&#160;</td><td class="memItemRight"><b>TEST_VX_SEG</b> (int verbose)</td></tr>
<tr class="memdesc:gab8ec56858686f5bbccad8bc101cb9f8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run VX segment tests. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-member-group" class="groupheader"><a id="member-group" name="member-group"></a>
Standard VX Sizes (primorial products excluding 2,3)</h2></td></tr>
<tr class="memitem:ga6a2cce58f5622e3d2b97c2dd251aade1" id="r_ga6a2cce58f5622e3d2b97c2dd251aade1"><td class="memItemLeft">#define&#160;</td><td class="memItemRight"><a class="el" href="#ga6a2cce58f5622e3d2b97c2dd251aade1">VX2</a>&#160;&#160;&#160;(5 * 7ULL)</td></tr>
<tr class="memitem:ga5272963aed063a5501e96731a4dc2334" id="r_ga5272963aed063a5501e96731a4dc2334"><td class="memItemLeft">#define&#160;</td><td class="memItemRight"><a class="el" href="#ga5272963aed063a5501e96731a4dc2334">VX3</a>&#160;&#160;&#160;(<a class="el" href="#ga6a2cce58f5622e3d2b97c2dd251aade1">VX2</a> * 11ULL)</td></tr>
<tr class="memitem:gad288993421c2fa2e3d37d449cc0134c9" id="r_gad288993421c2fa2e3d37d449cc0134c9"><td class="memItemLeft">#define&#160;</td><td class="memItemRight"><a class="el" href="#gad288993421c2fa2e3d37d449cc0134c9">VX4</a>&#160;&#160;&#160;(<a class="el" href="#ga5272963aed063a5501e96731a4dc2334">VX3</a> * 13ULL)</td></tr>
<tr class="memitem:ga70f1e9557da83099d06828cc5d9719b0" id="r_ga70f1e9557da83099d06828cc5d9719b0"><td class="memItemLeft">#define&#160;</td><td class="memItemRight"><a class="el" href="#ga70f1e9557da83099d06828cc5d9719b0">VX5</a>&#160;&#160;&#160;(<a class="el" href="#gad288993421c2fa2e3d37d449cc0134c9">VX4</a> * 17ULL)</td></tr>
<tr class="memitem:ga7510fdd07a68973d711e47ff3296e3ba" id="r_ga7510fdd07a68973d711e47ff3296e3ba"><td class="memItemLeft">#define&#160;</td><td class="memItemRight"><a class="el" href="#ga7510fdd07a68973d711e47ff3296e3ba">VX6</a>&#160;&#160;&#160;(<a class="el" href="#ga70f1e9557da83099d06828cc5d9719b0">VX5</a> * 19ULL)</td></tr>
<tr class="memitem:gac9b1091e8f0d8749a07c83b66d559ff4" id="r_gac9b1091e8f0d8749a07c83b66d559ff4"><td class="memItemLeft">#define&#160;</td><td class="memItemRight"><a class="el" href="#gac9b1091e8f0d8749a07c83b66d559ff4">VX7</a>&#160;&#160;&#160;(<a class="el" href="#ga7510fdd07a68973d711e47ff3296e3ba">VX6</a> * 23ULL)</td></tr>
<tr class="memitem:ga2c3010de7df0076f6693afe35114c236" id="r_ga2c3010de7df0076f6693afe35114c236"><td class="memItemLeft">#define&#160;</td><td class="memItemRight"><a class="el" href="#ga2c3010de7df0076f6693afe35114c236">VX8</a>&#160;&#160;&#160;(<a class="el" href="#gac9b1091e8f0d8749a07c83b66d559ff4">VX7</a> * 29ULL)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Internal building blocks for SiZ and SiZm implementations. </p>
</div><a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="gaa00f10dbfb5d0730503a789900de9134" name="gaa00f10dbfb5d0730503a789900de9134"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa00f10dbfb5d0730503a789900de9134">&#9670;&#160;</a></span>MR_ROUNDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MR_ROUNDS&#160;&#160;&#160;25</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default Miller-Rabin rounds used by toolkit search/sieve helpers. </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8h_source.html#l00079">79</a> of file <a class="el" href="i_z__toolkit_8h_source.html">iZ_toolkit.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00819">iZ_next_prime()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00713">vx_init()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l01017">vx_search_prime()</a>, and <a class="el" href="i_z__toolkit_8c_source.html#l01114">vy_search_prime()</a>.</p>

</div>
</div>
<a id="ga6a2cce58f5622e3d2b97c2dd251aade1" name="ga6a2cce58f5622e3d2b97c2dd251aade1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6a2cce58f5622e3d2b97c2dd251aade1">&#9670;&#160;</a></span>VX2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VX2&#160;&#160;&#160;(5 * 7ULL)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>35 </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8h_source.html#l00069">69</a> of file <a class="el" href="i_z__toolkit_8h_source.html">iZ_toolkit.h</a>.</p>

</div>
</div>
<a id="ga5272963aed063a5501e96731a4dc2334" name="ga5272963aed063a5501e96731a4dc2334"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5272963aed063a5501e96731a4dc2334">&#9670;&#160;</a></span>VX3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VX3&#160;&#160;&#160;(<a class="el" href="#ga6a2cce58f5622e3d2b97c2dd251aade1">VX2</a> * 11ULL)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>385 </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8h_source.html#l00070">70</a> of file <a class="el" href="i_z__toolkit_8h_source.html">iZ_toolkit.h</a>.</p>

</div>
</div>
<a id="gad288993421c2fa2e3d37d449cc0134c9" name="gad288993421c2fa2e3d37d449cc0134c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad288993421c2fa2e3d37d449cc0134c9">&#9670;&#160;</a></span>VX4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VX4&#160;&#160;&#160;(<a class="el" href="#ga5272963aed063a5501e96731a4dc2334">VX3</a> * 13ULL)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>5005 </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8h_source.html#l00071">71</a> of file <a class="el" href="i_z__toolkit_8h_source.html">iZ_toolkit.h</a>.</p>

</div>
</div>
<a id="ga70f1e9557da83099d06828cc5d9719b0" name="ga70f1e9557da83099d06828cc5d9719b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga70f1e9557da83099d06828cc5d9719b0">&#9670;&#160;</a></span>VX5</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VX5&#160;&#160;&#160;(<a class="el" href="#gad288993421c2fa2e3d37d449cc0134c9">VX4</a> * 17ULL)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>85085 </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8h_source.html#l00072">72</a> of file <a class="el" href="i_z__toolkit_8h_source.html">iZ_toolkit.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00819">iZ_next_prime()</a>, and <a class="el" href="i_z__apps_8c_source.html#l00692">vx_random_prime()</a>.</p>

</div>
</div>
<a id="ga7510fdd07a68973d711e47ff3296e3ba" name="ga7510fdd07a68973d711e47ff3296e3ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7510fdd07a68973d711e47ff3296e3ba">&#9670;&#160;</a></span>VX6</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VX6&#160;&#160;&#160;(<a class="el" href="#ga70f1e9557da83099d06828cc5d9719b0">VX5</a> * 19ULL)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>1616615 </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8h_source.html#l00073">73</a> of file <a class="el" href="i_z__toolkit_8h_source.html">iZ_toolkit.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00819">iZ_next_prime()</a>, <a class="el" href="i_z__apps_8c_source.html#l00035">SiZ_stream()</a>, and <a class="el" href="i_z__apps_8c_source.html#l00692">vx_random_prime()</a>.</p>

</div>
</div>
<a id="gac9b1091e8f0d8749a07c83b66d559ff4" name="gac9b1091e8f0d8749a07c83b66d559ff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac9b1091e8f0d8749a07c83b66d559ff4">&#9670;&#160;</a></span>VX7</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VX7&#160;&#160;&#160;(<a class="el" href="#ga7510fdd07a68973d711e47ff3296e3ba">VX6</a> * 23ULL)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>37260615 </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8h_source.html#l00074">74</a> of file <a class="el" href="i_z__toolkit_8h_source.html">iZ_toolkit.h</a>.</p>

</div>
</div>
<a id="ga2c3010de7df0076f6693afe35114c236" name="ga2c3010de7df0076f6693afe35114c236"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2c3010de7df0076f6693afe35114c236">&#9670;&#160;</a></span>VX8</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VX8&#160;&#160;&#160;(<a class="el" href="#gac9b1091e8f0d8749a07c83b66d559ff4">VX7</a> * 29ULL)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>1080558835 </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8h_source.html#l00075">75</a> of file <a class="el" href="i_z__toolkit_8h_source.html">iZ_toolkit.h</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga1dbb019b08a42984e1733f0c7c3881a0" name="ga1dbb019b08a42984e1733f0c7c3881a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1dbb019b08a42984e1733f0c7c3881a0">&#9670;&#160;</a></span>check_primality()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_primality </td>
          <td>(</td>
          <td class="paramtype">mpz_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>rounds</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the primality of a number using GMP's probabilistic test. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number to check. </td></tr>
    <tr><td class="paramname">rounds</td><td>Number of Miller-Rabin rounds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero if probably prime, 0 if composite.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number to check. </td></tr>
    <tr><td class="paramname">rounds</td><td>Number of Miller-Rabin rounds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero if probably prime, 0 if composite.</dd></dl>
<p>This function serves as a single source of truth for primality testing, wrapping GMP's <span class="tt">mpz_probab_prime_p</span> function, allowing for changes to the underlying primality testing method in the future without affecting the API. </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00153">153</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00633">vx_prob_sieve()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l01017">vx_search_prime()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00866">vx_stream()</a>, and <a class="el" href="i_z__toolkit_8c_source.html#l01114">vy_search_prime()</a>.</p>

</div>
</div>
<a id="gac92eb547227979fc0774e0529efa6180" name="gac92eb547227979fc0774e0529efa6180"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac92eb547227979fc0774e0529efa6180">&#9670;&#160;</a></span>compute_l2_vx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t compute_l2_vx </td>
          <td>(</td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Choose VX using an L2-cache-aware heuristic. </p>
<p>Choose a cache-aware VX size based on detected L2 capacity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Target numeric limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Selected VX size.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Target numeric sieve bound. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>L2 compatible VX size. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00306">306</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="utils_8c_source.html#l00531">get_cpu_L2_cache_size_bits()</a>, <a class="el" href="utils_8h_source.html#l00048">MIN</a>, and <a class="el" href="i_z__toolkit_8c_source.html#l00010">s_primes</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00184">SiZ_count()</a>, and <a class="el" href="prime__sieve_8c_source.html#l00516">SiZm()</a>.</p>

</div>
</div>
<a id="ga23df437281a4315af3cff9b76fab9dd8" name="ga23df437281a4315af3cff9b76fab9dd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga23df437281a4315af3cff9b76fab9dd8">&#9670;&#160;</a></span>compute_max_vx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_max_vx </td>
          <td>(</td>
          <td class="paramtype">mpz_t</td>          <td class="paramname"><span class="paramname"><em>vx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>bit_size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute largest VX below 2^bit_size. </p>
<p>Compute the maximum vx such that vx &lt; 2^bit_size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx</td><td>Output mpz_t containing VX. </td></tr>
    <tr><td class="paramname">bit_size</td><td>Bit-size ceiling.</td></tr>
  </table>
  </dd>
</dl>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx</td><td>mpz_t variable to store the computed maximum vx value. </td></tr>
    <tr><td class="paramname">bit_size</td><td>Integer representing the bit size limit for vx. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00331">331</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="int__arrays_8h_source.html#l00043">UI64_ARRAY::array</a>, and <a class="el" href="prime__sieve_8c_source.html#l00444">SiZ()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00545">vy_random_prime()</a>.</p>

</div>
</div>
<a id="ga6170b19f9022bf256850f1f2ee6dd786" name="ga6170b19f9022bf256850f1f2ee6dd786"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6170b19f9022bf256850f1f2ee6dd786">&#9670;&#160;</a></span>compute_vx_k()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t compute_vx_k </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>k</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate VX_{ <code class="param">k</code> }. </p>
<p>Calculate a VX_{k} as the product of the first k primes &gt; 3.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>Number of multiplicative prime factors (&gt;3). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Selected VX size.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>number of consecutive primes (&gt; 3) to include in the product. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Computed VX_k value. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00286">286</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="i_z__toolkit_8c_source.html#l00010">s_primes</a>.</p>

</div>
</div>
<a id="gadc4e21760e38081c6966fa9d9d23e940" name="gadc4e21760e38081c6966fa9d9d23e940"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadc4e21760e38081c6966fa9d9d23e940">&#9670;&#160;</a></span>get_root_primes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_root_primes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *</td>          <td class="paramname"><span class="paramname"><em>primes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>limit</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate primes up to <code class="param">limit</code> for deterministic sieving. </p>
<p>Generate root primes up to <code class="param">limit</code> using iZ bitmap traversal.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">primes</td><td>Output array, appended in ascending order. </td></tr>
    <tr><td class="paramname">limit</td><td>Numeric upper bound.</td></tr>
    <tr><td class="paramname">primes</td><td>Destination array. </td></tr>
    <tr><td class="paramname">limit</td><td>Numeric upper bound. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00112">112</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="bitmap_8c_source.html#l00103">bitmap_free()</a>, <a class="el" href="bitmap_8c_source.html#l00057">bitmap_init()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00070">process_iZ_bitmaps()</a>, <a class="el" href="group__iz__arrays.html#gab1a0ced5e600649da6e519693a3a2851">ui64_free()</a>, and <a class="el" href="group__iz__arrays.html#ga51cf8a13f4a4ae5c076a1be3a3333a68">ui64_push()</a>.</p>

<p class="reference">Referenced by <a class="el" href="prime__sieve_8c_source.html#l00623">SiZm_vy()</a>.</p>

</div>
</div>
<a id="gaffec7a5b407ee6c59ccc1678e0ab89ba" name="gaffec7a5b407ee6c59ccc1678e0ab89ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaffec7a5b407ee6c59ccc1678e0ab89ba">&#9670;&#160;</a></span>iZ()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t iZ </td>
          <td>(</td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>i</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Map iZ coordinates to an integer: <span class="tt">6*x + i</span>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>iZ x-coordinate. </td></tr>
    <tr><td class="paramname">i</td><td>Matrix identifier, typically -1 or +1. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Mapped integer value.</dd></dl>
<p>Map iZ coordinates to an integer: <span class="tt">6*x + i</span>.</p>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>(uint64_t) The value of <span class="tt">x</span> in <span class="tt">6x + i</span>. </td></tr>
    <tr><td class="paramname">i</td><td>(int) The value of <span class="tt">i</span> in <span class="tt">6x + i</span>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The computed value <span class="tt">6x + i</span> as a 64-bit unsigned integer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00024">24</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00070">process_iZ_bitmaps()</a>, <a class="el" href="prime__sieve_8c_source.html#l00516">SiZm()</a>, and <a class="el" href="prime__sieve_8c_source.html#l00623">SiZm_vy()</a>.</p>

</div>
</div>
<a id="gaa3f0472ebd680beaa6b0759acbedd9eb" name="gaa3f0472ebd680beaa6b0759acbedd9eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa3f0472ebd680beaa6b0759acbedd9eb">&#9670;&#160;</a></span>iZ_mpz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iZ_mpz </td>
          <td>(</td>
          <td class="paramtype">mpz_t</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mpz_t</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>i</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GMP variant of <a class="el" href="#gaffec7a5b407ee6c59ccc1678e0ab89ba" title="Map iZ coordinates to an integer: 6*x + i.">iZ()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z</td><td>Output value. </td></tr>
    <tr><td class="paramname">x</td><td>Input x-coordinate. </td></tr>
    <tr><td class="paramname">i</td><td>Matrix identifier, typically -1 or +1.</td></tr>
  </table>
  </dd>
</dl>
<p>GMP variant of <a class="el" href="#gaffec7a5b407ee6c59ccc1678e0ab89ba" title="Map iZ coordinates to an integer: 6*x + i.">iZ()</a>.</p>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z</td><td>(mpz_t) The result of the calculation <span class="tt">6x + i</span>. </td></tr>
    <tr><td class="paramname">x</td><td>(mpz_t) The input value of <span class="tt">x</span> in <span class="tt">6x + i</span>. </td></tr>
    <tr><td class="paramname">i</td><td>(int) The value of <span class="tt">i</span> in <span class="tt">6x + i</span>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00037">37</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00819">iZ_next_prime()</a>, <a class="el" href="i_z__apps_8c_source.html#l00184">SiZ_count()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00633">vx_prob_sieve()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l01017">vx_search_prime()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00529">vx_set_base_values()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00866">vx_stream()</a>, and <a class="el" href="i_z__toolkit_8c_source.html#l01114">vy_search_prime()</a>.</p>

</div>
</div>
<a id="gaa8c21336f708189a8d18f41085468c5c" name="gaa8c21336f708189a8d18f41085468c5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa8c21336f708189a8d18f41085468c5c">&#9670;&#160;</a></span>iZm_clone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_i_z_m.html">IZM</a> * iZm_clone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_i_z_m.html">IZM</a> *</td>          <td class="paramname"><span class="paramname"><em>src</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deep-copy an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object for per-worker ownership. </p>
<p>Deep-copy an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object for independent worker usage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Source <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> instance. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Newly allocated clone, or NULL on failure.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Source <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Cloned <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object, or NULL on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00232">232</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="int__arrays_8h_source.html#l00043">UI64_ARRAY::array</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00088">IZM::base_x5</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00089">IZM::base_x7</a>, <a class="el" href="bitmap_8c_source.html#l00382">bitmap_clone()</a>, <a class="el" href="int__arrays_8h_source.html#l00041">UI64_ARRAY::capacity</a>, <a class="el" href="int__arrays_8h_source.html#l00042">UI64_ARRAY::count</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00266">iZm_free()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00087">IZM::k_vx</a>, <a class="el" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00090">IZM::root_primes</a>, <a class="el" href="group__iz__arrays.html#gaf9ef1b739df3c37089c62c7f1adbfdce">ui64_init()</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00086">IZM::vx</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00184">SiZ_count()</a>.</p>

</div>
</div>
<a id="gacf776a7cedd726d8362aaf344102365d" name="gacf776a7cedd726d8362aaf344102365d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacf776a7cedd726d8362aaf344102365d">&#9670;&#160;</a></span>iZm_construct_vx_base()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iZm_construct_vx_base </td>
          <td>(</td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>vx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *</td>          <td class="paramname"><span class="paramname"><em>base_x5</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *</td>          <td class="paramname"><span class="paramname"><em>base_x7</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build pre-sieved base bitmaps for a VX segment. </p>
<p>Constructs a pre-sieved iZm base segment of size vx.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx</td><td>Segment width. </td></tr>
    <tr><td class="paramname">base_x5</td><td>Output bitmap for 6x-1 candidates. </td></tr>
    <tr><td class="paramname">base_x7</td><td>Output bitmap for 6x+1 candidates.</td></tr>
  </table>
  </dd>
</dl>
<p>Description: This function constructs a pre-sieved iZm base segment of size vx. It marks all composites of small primes that divide vx in the bitmaps base_x5 (iZ-) and base_x7 (iZ+). This pre-sieved base can then be used as a template for sieving all vx segments.</p>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iZm</td><td>Pointer to the <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> structure containing the base segment bitmaps. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00363">363</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="bitmap_8c_source.html#l00159">bitmap_clear_bit()</a>, <a class="el" href="bitmap_8c_source.html#l00233">bitmap_clear_steps_simd()</a>, <a class="el" href="bitmap_8c_source.html#l00170">bitmap_set_all()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00010">s_primes</a>, and <a class="el" href="i_z__toolkit_8c_source.html#l00013">s_primes_count</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00184">iZm_init()</a>, and <a class="el" href="prime__sieve_8c_source.html#l00516">SiZm()</a>.</p>

</div>
</div>
<a id="ga81a316b2719f678e9fbc4ac8c835460c" name="ga81a316b2719f678e9fbc4ac8c835460c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga81a316b2719f678e9fbc4ac8c835460c">&#9670;&#160;</a></span>iZm_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iZm_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_i_z_m.html">IZM</a> **</td>          <td class="paramname"><span class="paramname"><em>iZm</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object and set the caller pointer to NULL. </p>
<p>Free the memory allocated for an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iZm</td><td>Address of an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> pointer.</td></tr>
  </table>
  </dd>
</dl>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iZm</td><td>A pointer to the <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> structure to be freed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00266">266</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="bitmap_8c_source.html#l00103">bitmap_free()</a>, and <a class="el" href="group__iz__arrays.html#gab1a0ced5e600649da6e519693a3a2851">ui64_free()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00819">iZ_next_prime()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00232">iZm_clone()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00184">iZm_init()</a>, <a class="el" href="i_z__apps_8c_source.html#l00184">SiZ_count()</a>, and <a class="el" href="i_z__apps_8c_source.html#l00035">SiZ_stream()</a>.</p>

</div>
</div>
<a id="gaeb29a4d0536bb0aa227e230539081d98" name="gaeb29a4d0536bb0aa227e230539081d98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeb29a4d0536bb0aa227e230539081d98">&#9670;&#160;</a></span>iZm_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_i_z_m.html">IZM</a> * iZm_init </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>vx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate and initialize an <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object for a given VX. </p>
<p>Initialize an iZm structure for a given vx size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx</td><td>Segment width; must be odd, not divisible by 3, and &gt;= 35. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Initialized <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> object, or NULL on failure.</dd></dl>
<p>This function initializes an iZm structure for a specified vx size. It allocates memory for the structure, generates root primes for deterministic sieving, initializes base bitmaps, and constructs pre-sieved base segments for iZm5 and iZm7.</p>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx</td><td>The size of the segment for the iZm structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the initialized <a class="el" href="struct_i_z_m.html" title="Precomputed iZm assets for repeated VX-segment sieving.">IZM</a> structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00184">184</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="i_z__toolkit_8h_source.html#l00088">IZM::base_x5</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00089">IZM::base_x7</a>, <a class="el" href="bitmap_8c_source.html#l00057">bitmap_init()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00052">compute_k_vx()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00363">iZm_construct_vx_base()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00266">iZm_free()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00087">IZM::k_vx</a>, <a class="el" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00090">IZM::root_primes</a>, <a class="el" href="prime__sieve_8c_source.html#l00444">SiZ()</a>, <a class="el" href="group__iz__arrays.html#gab1a0ced5e600649da6e519693a3a2851">ui64_free()</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00086">IZM::vx</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00819">iZ_next_prime()</a>, <a class="el" href="i_z__apps_8c_source.html#l00184">SiZ_count()</a>, and <a class="el" href="i_z__apps_8c_source.html#l00035">SiZ_stream()</a>.</p>

</div>
</div>
<a id="ga596920e4772d76fe9dc61a541b282275" name="ga596920e4772d76fe9dc61a541b282275"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga596920e4772d76fe9dc61a541b282275">&#9670;&#160;</a></span>iZm_solve_for_x0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t iZm_solve_for_x0 </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>m_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>vx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>y</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve first x-hit of prime <code class="param">p</code> for line <code class="param">m_id</code> in segment y. </p>
<p>Compute the first composite hit of p in the yth vx segment in iZm index space.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m_id</td><td>Line id (-1 for x5, +1 for x7). </td></tr>
    <tr><td class="paramname">p</td><td>Prime used for marking. </td></tr>
    <tr><td class="paramname">vx</td><td>Segment width. </td></tr>
    <tr><td class="paramname">y</td><td>Segment index. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>First x index to clear for this prime/line.</dd></dl>
<p>Description: This function solves for the smallest x that satisfies: (x + vx * y)  x_p (mod p), where x_p is normalized based on the m_id and p to either x_p or p - x_p, then computes x and returns it.</p>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m_id</td><td>int matrix identifier (-1 for iZm5, 1 for iZm7). </td></tr>
    <tr><td class="paramname">p</td><td>Unsigned 64-bit integer parameter. </td></tr>
    <tr><td class="paramname">vx</td><td>size_t parameter representing the vx value. </td></tr>
    <tr><td class="paramname">y</td><td>Unsigned 64-bit integer parameter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The computed x value as a 64-bit unsigned integer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00415">415</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="prime__sieve_8c_source.html#l00516">SiZm()</a>, and <a class="el" href="i_z__toolkit_8c_source.html#l00566">vx_det_sieve()</a>.</p>

</div>
</div>
<a id="ga3ee0fd9e3f27fd5d30fddfe7d1056c57" name="ga3ee0fd9e3f27fd5d30fddfe7d1056c57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ee0fd9e3f27fd5d30fddfe7d1056c57">&#9670;&#160;</a></span>iZm_solve_for_x0_mpz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t iZm_solve_for_x0_mpz </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>m_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>vx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mpz_t</td>          <td class="paramname"><span class="paramname"><em>y</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GMP variant of <a class="el" href="#ga596920e4772d76fe9dc61a541b282275" title="Solve first x-hit of prime p for line m_id in segment y.">iZm_solve_for_x0()</a> for very large y. </p>
<p>Solve for x given m_id, p, vx, and y using GMP. Same as above but using GMP. Suitable for arbitrary y values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m_id</td><td>Line id (-1 for x5, +1 for x7). </td></tr>
    <tr><td class="paramname">p</td><td>Prime used for marking. </td></tr>
    <tr><td class="paramname">vx</td><td>Segment width. </td></tr>
    <tr><td class="paramname">y</td><td>Segment index as mpz. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>First x index to clear for this prime/line.</dd></dl>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m_id</td><td>int matrix identifier (-1 for iZm5, 1 for iZm7). </td></tr>
    <tr><td class="paramname">p</td><td>Unsigned 64-bit integer parameter. </td></tr>
    <tr><td class="paramname">vx</td><td>Size_t parameter representing the vx value. </td></tr>
    <tr><td class="paramname">y</td><td>mpz_t parameter representing the y value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The computed x value as a 64-bit unsigned integer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00449">449</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00566">vx_det_sieve()</a>, and <a class="el" href="i_z__toolkit_8c_source.html#l01017">vx_search_prime()</a>.</p>

</div>
</div>
<a id="ga50cf18d6528c411820a9b081b13875ca" name="ga50cf18d6528c411820a9b081b13875ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga50cf18d6528c411820a9b081b13875ca">&#9670;&#160;</a></span>iZm_solve_for_y0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t iZm_solve_for_y0 </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>m_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>vx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>x</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve first y-hit for fixed x in vertical (vy) scanning. </p>
<p>Compute the first composite hit of p in the xth vy segment in iZm of width vx.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m_id</td><td>Line id (-1 for x5, +1 for x7). </td></tr>
    <tr><td class="paramname">p</td><td>Prime used for marking. </td></tr>
    <tr><td class="paramname">vx</td><td>Segment width. </td></tr>
    <tr><td class="paramname">x</td><td>Fixed x-coordinate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>y index on success, -1 when no modular solution exists.</dd></dl>
<p>Description: This function solves for the smallest y that satisfies the equation (x + vx * y)  x_p (mod p), where x_p is normalized based on the m_id and p. The function checks if p and vx are co-primes, and if not, it returns -1 indicating no solution can be found. If they are co-primes, it calculates the multiplicative inverse of vx modulo p and computes y using the formula y = (delta * vx_inv) % p, where delta is the difference between x_p and x modulo p.</p>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m_id</td><td>int matrix identifier (-1 for iZm5, 1 for iZm7). </td></tr>
    <tr><td class="paramname">p</td><td>Unsigned 64-bit integer parameter. </td></tr>
    <tr><td class="paramname">vx</td><td>Size_t parameter representing the vx value. </td></tr>
    <tr><td class="paramname">x</td><td>Unsigned 64-bit integer parameter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The computed y value as a 64-bit unsigned integer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00490">490</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="utils_8c_source.html#l00425">gcd()</a>, and <a class="el" href="utils_8c_source.html#l00453">modular_inverse()</a>.</p>

<p class="reference">Referenced by <a class="el" href="prime__sieve_8c_source.html#l00623">SiZm_vy()</a>.</p>

</div>
</div>
<a id="ga865e51a5e6f28945747e2ad6988c2e4e" name="ga865e51a5e6f28945747e2ad6988c2e4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga865e51a5e6f28945747e2ad6988c2e4e">&#9670;&#160;</a></span>process_iZ_bitmaps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void process_iZ_bitmaps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_u_i64___a_r_r_a_y.html">UI64_ARRAY</a> *</td>          <td class="paramname"><span class="paramname"><em>primes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *</td>          <td class="paramname"><span class="paramname"><em>x5</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_i_t_m_a_p.html">BITMAP</a> *</td>          <td class="paramname"><span class="paramname"><em>x7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>x_limit</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Traverse iZ bitmaps, emit surviving primes, and mark composites. </p>
<p>Consume iZ candidate bitmaps, emit primes, and mark root composites.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">primes</td><td>Output prime array. </td></tr>
    <tr><td class="paramname">x5</td><td>Bitmap for 6x-1 candidates. </td></tr>
    <tr><td class="paramname">x7</td><td>Bitmap for 6x+1 candidates. </td></tr>
    <tr><td class="paramname">x_limit</td><td>Exclusive x upper bound.</td></tr>
    <tr><td class="paramname">primes</td><td>Destination array for discovered primes. </td></tr>
    <tr><td class="paramname">x5</td><td>Bitmap for 6x-1 candidates. </td></tr>
    <tr><td class="paramname">x7</td><td>Bitmap for 6x+1 candidates. </td></tr>
    <tr><td class="paramname">x_limit</td><td>Exclusive x upper bound. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00070">70</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="bitmap_8c_source.html#l00233">bitmap_clear_steps_simd()</a>, <a class="el" href="bitmap_8c_source.html#l00137">bitmap_get_bit()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00024">iZ()</a>, and <a class="el" href="group__iz__arrays.html#ga51cf8a13f4a4ae5c076a1be3a3333a68">ui64_push()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00112">get_root_primes()</a>, <a class="el" href="prime__sieve_8c_source.html#l00444">SiZ()</a>, and <a class="el" href="prime__sieve_8c_source.html#l00516">SiZm()</a>.</p>

</div>
</div>
<a id="gab053af28699e3138640445b16a1311f7" name="gab053af28699e3138640445b16a1311f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab053af28699e3138640445b16a1311f7">&#9670;&#160;</a></span>range_info_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void range_info_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a> *</td>          <td class="paramname"><span class="paramname"><em>info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear all GMP fields owned by <code class="param">info</code>. </p>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00989">989</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="i_z__toolkit_8h_source.html#l00260">IZM_RANGE_INFO::Xe</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00259">IZM_RANGE_INFO::Xs</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00262">IZM_RANGE_INFO::Ye</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00261">IZM_RANGE_INFO::Ys</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00258">IZM_RANGE_INFO::Ze</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00257">IZM_RANGE_INFO::Zs</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00184">SiZ_count()</a>, and <a class="el" href="i_z__apps_8c_source.html#l00035">SiZ_stream()</a>.</p>

</div>
</div>
<a id="ga5ada19be750a6f9b0837805ef34a1de4" name="ga5ada19be750a6f9b0837805ef34a1de4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5ada19be750a6f9b0837805ef34a1de4">&#9670;&#160;</a></span>range_info_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_i_z_m___r_a_n_g_e___i_n_f_o.html">IZM_RANGE_INFO</a> range_info_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e.html">INPUT_SIEVE_RANGE</a> *</td>          <td class="paramname"><span class="paramname"><em>input_range</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>vx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map a decimal range input into iZm coordinates and segment bounds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_range</td><td>Range input (<span class="tt">start</span>, <span class="tt">range</span>). </td></tr>
    <tr><td class="paramname">vx</td><td>iZm segment width. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Initialized range-info object; <span class="tt">y_range &lt; 0</span> indicates invalid input or an unsupported y-span for the current implementation. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00944">944</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error()</a>, <a class="el" href="i_z__api_8h_source.html#l00127">INPUT_SIEVE_RANGE::range</a>, <a class="el" href="i_z__api_8h_source.html#l00126">INPUT_SIEVE_RANGE::start</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00256">IZM_RANGE_INFO::vx</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00260">IZM_RANGE_INFO::Xe</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00259">IZM_RANGE_INFO::Xs</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00263">IZM_RANGE_INFO::y_range</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00262">IZM_RANGE_INFO::Ye</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00261">IZM_RANGE_INFO::Ys</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00258">IZM_RANGE_INFO::Ze</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00257">IZM_RANGE_INFO::Zs</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00184">SiZ_count()</a>, and <a class="el" href="i_z__apps_8c_source.html#l00035">SiZ_stream()</a>.</p>

</div>
</div>
<a id="ga824821f174cc26db2d310a68e8c2f19e" name="ga824821f174cc26db2d310a68e8c2f19e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga824821f174cc26db2d310a68e8c2f19e">&#9670;&#160;</a></span>vx_collect_p_gaps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vx_collect_p_gaps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *</td>          <td class="paramname"><span class="paramname"><em>vx_obj</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract prime-gap encoding from a fully sieved segment. </p>
<p>Convert survivor bits into compact prime-gap encoding.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx_obj</td><td>Segment object.</td></tr>
  </table>
  </dd>
</dl>
<p>This routine must run after deterministic/probabilistic sieving is complete. It populates <a class="el" href="struct_v_x___s_e_g.html#a25bbcd26bb0e69a6b9584594a714b8b5" title="VX_SEG::p_gaps">VX_SEG::p_gaps</a> for downstream streaming and gap traversal.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx_obj</td><td>Segment object with validated prime survivors. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00787">787</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="bitmap_8c_source.html#l00137">bitmap_get_bit()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00190">VX_SEG::is_large_limit</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00196">VX_SEG::p_count</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00197">VX_SEG::p_gaps</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00192">VX_SEG::start_x</a>, <a class="el" href="group__iz__arrays.html#ga495a195fcf45ae02c9402bcb389e7343">ui16_init()</a>, <a class="el" href="group__iz__arrays.html#gaf19906d91639a464ff36cc425968bdae">ui16_push()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00847">vx_full_sieve()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00194">VX_SEG::x5</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00195">VX_SEG::x7</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00187">VX_SEG::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__toolkit_8c_source.html#l00847">vx_full_sieve()</a>.</p>

</div>
</div>
<a id="ga89a2804cb4fa979a32e4213ade786ec4" name="ga89a2804cb4fa979a32e4213ade786ec4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89a2804cb4fa979a32e4213ade786ec4">&#9670;&#160;</a></span>vx_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vx_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> **</td>          <td class="paramname"><span class="paramname"><em>vx_obj</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a VX segment and all owned resources. </p>
<p>Free all memory owned by a VX segment object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx_obj</td><td>Address of a <a class="el" href="struct_v_x___s_e_g.html" title="Runtime state for one VX segment at a specific y.">VX_SEG</a> pointer.</td></tr>
    <tr><td class="paramname">vx_obj</td><td>Address of the <a class="el" href="struct_v_x___s_e_g.html" title="Runtime state for one VX segment at a specific y.">VX_SEG</a> pointer to release. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00759">759</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="bitmap_8c_source.html#l00103">bitmap_free()</a>, and <a class="el" href="group__iz__arrays.html#ga6711fa1c3d7f6f57924486106423e18b">ui16_free()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00184">SiZ_count()</a>, and <a class="el" href="i_z__apps_8c_source.html#l00035">SiZ_stream()</a>.</p>

</div>
</div>
<a id="ga214f95ac7b685a7ff0c596afc70036b7" name="ga214f95ac7b685a7ff0c596afc70036b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga214f95ac7b685a7ff0c596afc70036b7">&#9670;&#160;</a></span>vx_full_sieve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vx_full_sieve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *</td>          <td class="paramname"><span class="paramname"><em>vx_obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>collect_p_gaps</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Complete segment processing (probabilistic stage and optional gaps). </p>
<p>This function performs the sieve process on a given vx and y defined in the <a class="el" href="struct_v_x___s_e_g.html" title="Runtime state for one VX segment at a specific y.">VX_SEG</a> structure, and stores the primes gaps in the vx_obj-&gt;p_gaps array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx_obj</td><td>Segment object. </td></tr>
    <tr><td class="paramname">collect_p_gaps</td><td>Non-zero to populate <a class="el" href="struct_v_x___s_e_g.html#a25bbcd26bb0e69a6b9584594a714b8b5" title="VX_SEG::p_gaps">VX_SEG::p_gaps</a>.</td></tr>
  </table>
  </dd>
</dl>
<p>Description: This function combines deterministic sieving and probabilistic primality tests to identify prime candidates in a standard VX segment of a specific y in the iZ-Matrix. It could be used to only count primes in the vx segment, and optionally populates the vx_obj-&gt;p_gaps array with prime gaps between consecutive primes detected in the segment.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx_obj</td><td>The <a class="el" href="struct_v_x___s_e_g.html" title="Runtime state for one VX segment at a specific y.">VX_SEG</a> to be processed. </td></tr>
    <tr><td class="paramname">collect_p_gaps</td><td>0 only counts primes and doesn't store prime gaps, other non-zero int values populates vx_obj-&gt;p_gaps with detected prime gaps. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00847">847</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="i_z__toolkit_8h_source.html#l00190">VX_SEG::is_large_limit</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00787">vx_collect_p_gaps()</a>, and <a class="el" href="i_z__toolkit_8c_source.html#l00633">vx_prob_sieve()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00184">SiZ_count()</a>, and <a class="el" href="i_z__toolkit_8c_source.html#l00787">vx_collect_p_gaps()</a>.</p>

</div>
</div>
<a id="ga234719b01a0e090a1f66ed7766fe6d0f" name="ga234719b01a0e090a1f66ed7766fe6d0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga234719b01a0e090a1f66ed7766fe6d0f">&#9670;&#160;</a></span>vx_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> * vx_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_i_z_m.html">IZM</a> *</td>          <td class="paramname"><span class="paramname"><em>iZm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>start_x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>end_x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>y_str</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>mr_rounds</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize and deterministically sieve one VX segment. </p>
<p>Initialize the members of the <a class="el" href="struct_v_x___s_e_g.html" title="Runtime state for one VX segment at a specific y.">VX_SEG</a> structure with the given parameters and defaults.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iZm</td><td>Initialized toolkit context. </td></tr>
    <tr><td class="paramname">start_x</td><td>Inclusive x start index. </td></tr>
    <tr><td class="paramname">end_x</td><td>Inclusive x end index. </td></tr>
    <tr><td class="paramname">y_str</td><td>Segment index y as a decimal string. </td></tr>
    <tr><td class="paramname">mr_rounds</td><td>Miller-Rabin rounds (0 uses default). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Initialized and partially processed segment, or NULL on failure.</dd></dl>
<p>Description: This function allocates memory for a <a class="el" href="struct_v_x___s_e_g.html" title="Runtime state for one VX segment at a specific y.">VX_SEG</a> structure and initializes its members. The count is initialized to 0, and the p_gaps array is allocated with an initial size of (vx/2).</p>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y_str</td><td>A character pointer representing a numeric string.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VX_SEG* A pointer to the initialized <a class="el" href="struct_v_x___s_e_g.html" title="Runtime state for one VX segment at a specific y.">VX_SEG</a> structure. NULL if memory allocation fails or y_str is not a numeric string. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00713">713</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="i_z__toolkit_8h_source.html#l00088">IZM::base_x5</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00089">IZM::base_x7</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00198">VX_SEG::bit_ops</a>, <a class="el" href="bitmap_8c_source.html#l00382">bitmap_clone()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00193">VX_SEG::end_x</a>, <a class="el" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error()</a>, <a class="el" href="utils_8h_source.html#l00052">MAX</a>, <a class="el" href="utils_8h_source.html#l00048">MIN</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00079">MR_ROUNDS</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00191">VX_SEG::mr_rounds</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00196">VX_SEG::p_count</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00197">VX_SEG::p_gaps</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00199">VX_SEG::p_test_ops</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00192">VX_SEG::start_x</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00086">IZM::vx</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00186">VX_SEG::vx</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00566">vx_det_sieve()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00529">vx_set_base_values()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00194">VX_SEG::x5</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00195">VX_SEG::x7</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00184">SiZ_count()</a>, and <a class="el" href="i_z__apps_8c_source.html#l00035">SiZ_stream()</a>.</p>

</div>
</div>
<a id="ga02e061a03533010221ce47c043ddc53c" name="ga02e061a03533010221ce47c043ddc53c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga02e061a03533010221ce47c043ddc53c">&#9670;&#160;</a></span>vx_search_prime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vx_search_prime </td>
          <td>(</td>
          <td class="paramtype">mpz_t</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>m_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>vx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>bit_size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Horizontal iZm/VX random-prime search. </p>
<p>horizontal search routine for generating a random prime.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Output prime. </td></tr>
    <tr><td class="paramname">m_id</td><td>Requested line id (-1, +1, or random when other value). </td></tr>
    <tr><td class="paramname">vx</td><td>Segment width. </td></tr>
    <tr><td class="paramname">bit_size</td><td>Target bit size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success, otherwise 0.</dd></dl>
<p>Description: This function searches for a prime number using the given parameters. It combines the iZ-Matrix filtering techniques with the Miller-Rabin primality test. The search is performed by finding suitable x values that do not correspond to composites of primes that divide vx. Then, it iterates over y values in the equation p = iZ(x + vx * y) until a prime is found.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The prime number found in the search. </td></tr>
    <tr><td class="paramname">m_id</td><td>The identifier (1 or -1) for the iZ matrix. </td></tr>
    <tr><td class="paramname">vx</td><td>The horizontal vector of the iZ matrix. </td></tr>
    <tr><td class="paramname">bit_size</td><td>The target bit size of the prime. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if a prime is found, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l01017">1017</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="int__arrays_8h_source.html#l00043">UI64_ARRAY::array</a>, <a class="el" href="bitmap_8c_source.html#l00210">bitmap_clear_steps()</a>, <a class="el" href="bitmap_8c_source.html#l00103">bitmap_free()</a>, <a class="el" href="bitmap_8c_source.html#l00137">bitmap_get_bit()</a>, <a class="el" href="bitmap_8c_source.html#l00057">bitmap_init()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00153">check_primality()</a>, <a class="el" href="int__arrays_8h_source.html#l00042">UI64_ARRAY::count</a>, <a class="el" href="utils_8c_source.html#l00486">gmp_seed_randstate()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00037">iZ_mpz()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00449">iZm_solve_for_x0_mpz()</a>, <a class="el" href="group__iz__logger.html#ga3dc3bd5ec0c013065ffc731ea33271d5">log_error()</a>, <a class="el" href="utils_8h_source.html#l00052">MAX</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00079">MR_ROUNDS</a>, <a class="el" href="prime__sieve_8c_source.html#l00516">SiZm()</a>, and <a class="el" href="group__iz__arrays.html#gab1a0ced5e600649da6e519693a3a2851">ui64_free()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00692">vx_random_prime()</a>.</p>

</div>
</div>
<a id="ga591a1d1fae4f8a241c6b6ed7f495eae6" name="ga591a1d1fae4f8a241c6b6ed7f495eae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga591a1d1fae4f8a241c6b6ed7f495eae6">&#9670;&#160;</a></span>vx_stream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vx_stream </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_x___s_e_g.html">VX_SEG</a> *</td>          <td class="paramname"><span class="paramname"><em>vx_obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stream segment primes to an output stream. </p>
<p>Stream segment primes to an output stream in traversal order.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vx_obj</td><td>Segment object. </td></tr>
    <tr><td class="paramname">output</td><td>Writable output stream (e.g. stdout or a file).</td></tr>
    <tr><td class="paramname">vx_obj</td><td>Segment object. </td></tr>
    <tr><td class="paramname">output</td><td>Destination stream (stdout or file). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l00866">866</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="bitmap_8c_source.html#l00159">bitmap_clear_bit()</a>, <a class="el" href="bitmap_8c_source.html#l00137">bitmap_get_bit()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00153">check_primality()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00190">VX_SEG::is_large_limit</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00037">iZ_mpz()</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00191">VX_SEG::mr_rounds</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00196">VX_SEG::p_count</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00199">VX_SEG::p_test_ops</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00192">VX_SEG::start_x</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00194">VX_SEG::x5</a>, <a class="el" href="i_z__toolkit_8h_source.html#l00195">VX_SEG::x7</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00188">VX_SEG::yvx</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00035">SiZ_stream()</a>.</p>

</div>
</div>
<a id="ga58ea9ced15462006d8a8c223719c57f4" name="ga58ea9ced15462006d8a8c223719c57f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga58ea9ced15462006d8a8c223719c57f4">&#9670;&#160;</a></span>vy_search_prime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vy_search_prime </td>
          <td>(</td>
          <td class="paramtype">mpz_t</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>m_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mpz_t</td>          <td class="paramname"><span class="paramname"><em>vx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Vertical iZm/VY random-prime search. </p>
<p>vertical search routine for generating a random prime.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Output prime. </td></tr>
    <tr><td class="paramname">m_id</td><td>Requested line id (-1, +1, or random when other value). </td></tr>
    <tr><td class="paramname">vx</td><td>Segment width. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success, otherwise 0.</dd></dl>
<p>Description: This function searches for a prime number using the given parameters. It combines the iZ-Matrix filtering techniques with the Miller-Rabin primality test. The search is performed by finding a suitable x value that does not correspond to a composite of a prime that divides vx. Then, it iterates over y value in the equation p = iZ(x + vx * y, m_id) until a prime is found.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The prime number found in the search. </td></tr>
    <tr><td class="paramname">m_id</td><td>The identifier (1 or -1) for the iZ matrix. </td></tr>
    <tr><td class="paramname">vx</td><td>The horizontal vector of the iZ matrix. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if a prime is found, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="i_z__toolkit_8c_source.html#l01114">1114</a> of file <a class="el" href="i_z__toolkit_8c_source.html">iZ_toolkit.c</a>.</p>

<p class="reference">References <a class="el" href="i_z__toolkit_8c_source.html#l00153">check_primality()</a>, <a class="el" href="utils_8c_source.html#l00486">gmp_seed_randstate()</a>, <a class="el" href="i_z__toolkit_8c_source.html#l00037">iZ_mpz()</a>, and <a class="el" href="i_z__toolkit_8h_source.html#l00079">MR_ROUNDS</a>.</p>

<p class="reference">Referenced by <a class="el" href="i_z__apps_8c_source.html#l00545">vy_random_prime()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
