\doxysection{Toolkit (i\+Z/\+i\+Zm) }
\hypertarget{group__iz__toolkit}{}\label{group__iz__toolkit}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}


Internal building blocks for SiZ and Si\+Zm implementations.  


\doxysubsubsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \doxymbox{\hyperlink{i_z__toolkit_8c}{i\+Z\+\_\+toolkit.\+c}}
\begin{DoxyCompactList}\small\item\em Implementation of iZ index space helpers and i\+Zm/\+\+VX segment machinery. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \doxymbox{\hyperlink{struct_i_z_m}{IZM}}
\begin{DoxyCompactList}\small\item\em Precomputed i\+Zm assets for repeated VX-\/segment sieving. \end{DoxyCompactList}\item 
struct \doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}}
\begin{DoxyCompactList}\small\item\em Runtime state for one VX segment at a specific y. \end{DoxyCompactList}\item 
struct \doxymbox{\hyperlink{struct_i_z_m___r_a_n_g_e___i_n_f_o}{IZM\+\_\+\+RANGE\+\_\+\+INFO}}
\begin{DoxyCompactList}\small\item\em Precomputed i\+Zm coordinates for an inclusive numeric interval. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_gaa00f10dbfb5d0730503a789900de9134}{MR\+\_\+\+ROUNDS}}~25
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \doxymbox{\hyperlink{group__iz__toolkit_gacf776a7cedd726d8362aaf344102365d}{i\+Zm\+\_\+construct\+\_\+vx\+\_\+base}} (uint64\+\_\+t vx, \doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}base\+\_\+x5, \doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}base\+\_\+x7)
\begin{DoxyCompactList}\small\item\em Build pre-\/sieved base bitmaps for a VX segment. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_i_z_m___r_a_n_g_e___i_n_f_o}{IZM\+\_\+\+RANGE\+\_\+\+INFO}} \doxymbox{\hyperlink{group__iz__toolkit_ga5ada19be750a6f9b0837805ef34a1de4}{range\+\_\+info\+\_\+init}} (\doxymbox{\hyperlink{struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e}{INPUT\+\_\+\+SIEVE\+\_\+\+RANGE}} \texorpdfstring{$\ast$}{*}input\+\_\+range, int vx)
\begin{DoxyCompactList}\small\item\em Map a decimal range input into i\+Zm coordinates and segment bounds. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_gab053af28699e3138640445b16a1311f7}{range\+\_\+info\+\_\+free}} (\doxymbox{\hyperlink{struct_i_z_m___r_a_n_g_e___i_n_f_o}{IZM\+\_\+\+RANGE\+\_\+\+INFO}} \texorpdfstring{$\ast$}{*}info)
\begin{DoxyCompactList}\small\item\em Clear all GMP fields owned by {\ttfamily info}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{iZ Mapping Helpers}
\begin{DoxyCompactItemize}
\item 
uint64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_gaffec7a5b407ee6c59ccc1678e0ab89ba}{iZ}} (uint64\+\_\+t x, int i)
\begin{DoxyCompactList}\small\item\em Map iZ coordinates to an integer:\+ {\ttfamily 6\texorpdfstring{$\ast$}{*}x + i}. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_gaa3f0472ebd680beaa6b0759acbedd9eb}{i\+Z\+\_\+mpz}} (mpz\+\_\+t z, mpz\+\_\+t x, int i)
\begin{DoxyCompactList}\small\item\em GMP variant of \doxylink{group__iz__toolkit_gaffec7a5b407ee6c59ccc1678e0ab89ba}{i\+Z()}. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga865e51a5e6f28945747e2ad6988c2e4e}{process\+\_\+i\+Z\+\_\+bitmaps}} (\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*}primes, \doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}x5, \doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}x7, uint64\+\_\+t x\+\_\+limit)
\begin{DoxyCompactList}\small\item\em Traverse iZ bitmaps, emit surviving primes, and mark composites. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_gadc4e21760e38081c6966fa9d9d23e940}{get\+\_\+root\+\_\+primes}} (\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*}primes, uint64\+\_\+t limit)
\begin{DoxyCompactList}\small\item\em Generate primes up to {\ttfamily limit} for deterministic sieving. \end{DoxyCompactList}\item 
int \doxymbox{\hyperlink{group__iz__toolkit_ga1dbb019b08a42984e1733f0c7c3881a0}{check\+\_\+primality}} (mpz\+\_\+t n, int rounds)
\begin{DoxyCompactList}\small\item\em Check the primality of a number using GMP\textquotesingle{}s probabilistic test. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{IZM Lifecycle}
\begin{DoxyCompactItemize}
\item 
\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__toolkit_gaeb29a4d0536bb0aa227e230539081d98}{i\+Zm\+\_\+init}} (size\+\_\+t vx)
\begin{DoxyCompactList}\small\item\em Allocate and initialize an \doxylink{struct_i_z_m}{IZM} object for a given VX. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__toolkit_gaa8c21336f708189a8d18f41085468c5c}{i\+Zm\+\_\+clone}} (\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*}src)
\begin{DoxyCompactList}\small\item\em Deep-\/copy an \doxylink{struct_i_z_m}{IZM} object for per-\/worker ownership. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga81a316b2719f678e9fbc4ac8c835460c}{i\+Zm\+\_\+free}} (\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}i\+Zm)
\begin{DoxyCompactList}\small\item\em Release an \doxylink{struct_i_z_m}{IZM} object and set the caller pointer to NULL. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{VX Selection Helpers}
\begin{DoxyCompactItemize}
\item 
uint64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_ga6170b19f9022bf256850f1f2ee6dd786}{compute\+\_\+vx\+\_\+k}} (int k)
\begin{DoxyCompactList}\small\item\em Calculate VX\+\_\+\{ {\ttfamily k} \}. \end{DoxyCompactList}\item 
uint64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_gac92eb547227979fc0774e0529efa6180}{compute\+\_\+l2\+\_\+vx}} (uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em Choose VX using an L2-\/cache-\/aware heuristic. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga23df437281a4315af3cff9b76fab9dd8}{compute\+\_\+max\+\_\+vx}} (mpz\+\_\+t vx, int bit\+\_\+size)
\begin{DoxyCompactList}\small\item\em Compute largest VX below 2\texorpdfstring{$^\wedge$}{\string^}bit\+\_\+size. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Modular Hit Solvers}
\begin{DoxyCompactItemize}
\item 
uint64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_ga596920e4772d76fe9dc61a541b282275}{i\+Zm\+\_\+solve\+\_\+for\+\_\+x0}} (int m\+\_\+id, uint64\+\_\+t p, uint64\+\_\+t vx, uint64\+\_\+t y)
\begin{DoxyCompactList}\small\item\em Solve first x-\/hit of prime {\ttfamily p} for line {\ttfamily m\+\_\+id} in segment y. \end{DoxyCompactList}\item 
uint64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_ga3ee0fd9e3f27fd5d30fddfe7d1056c57}{i\+Zm\+\_\+solve\+\_\+for\+\_\+x0\+\_\+mpz}} (int m\+\_\+id, uint64\+\_\+t p, uint64\+\_\+t vx, mpz\+\_\+t y)
\begin{DoxyCompactList}\small\item\em GMP variant of \doxylink{group__iz__toolkit_ga596920e4772d76fe9dc61a541b282275}{i\+Zm\+\_\+solve\+\_\+for\+\_\+x0()} for very large y. \end{DoxyCompactList}\item 
int64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_ga50cf18d6528c411820a9b081b13875ca}{i\+Zm\+\_\+solve\+\_\+for\+\_\+y0}} (int m\+\_\+id, uint64\+\_\+t p, uint64\+\_\+t vx, uint64\+\_\+t x)
\begin{DoxyCompactList}\small\item\em Solve first y-\/hit for fixed x in vertical (vy) scanning. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{VX Segment Lifecycle and Execution}
\begin{DoxyCompactItemize}
\item 
\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__toolkit_ga234719b01a0e090a1f66ed7766fe6d0f}{vx\+\_\+init}} (\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*}i\+Zm, int start\+\_\+x, int end\+\_\+x, char \texorpdfstring{$\ast$}{*}y\+\_\+str, int mr\+\_\+rounds)
\begin{DoxyCompactList}\small\item\em Initialize and deterministically sieve one VX segment. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga89a2804cb4fa979a32e4213ade786ec4}{vx\+\_\+free}} (\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}vx\+\_\+obj)
\begin{DoxyCompactList}\small\item\em Free a VX segment and all owned resources. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga824821f174cc26db2d310a68e8c2f19e}{vx\+\_\+collect\+\_\+p\+\_\+gaps}} (\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}vx\+\_\+obj)
\begin{DoxyCompactList}\small\item\em Extract prime-\/gap encoding from a fully sieved segment. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga214f95ac7b685a7ff0c596afc70036b7}{vx\+\_\+full\+\_\+sieve}} (\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}vx\+\_\+obj, int collect\+\_\+p\+\_\+gaps)
\begin{DoxyCompactList}\small\item\em Complete segment processing (probabilistic stage and optional gaps). \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga591a1d1fae4f8a241c6b6ed7f495eae6}{vx\+\_\+stream}} (\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}vx\+\_\+obj, FILE \texorpdfstring{$\ast$}{*}output)
\begin{DoxyCompactList}\small\item\em Stream segment primes to an output stream. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Random Prime Search Routines}
\begin{DoxyCompactItemize}
\item 
int \doxymbox{\hyperlink{group__iz__toolkit_ga02e061a03533010221ce47c043ddc53c}{vx\+\_\+search\+\_\+prime}} (mpz\+\_\+t p, int m\+\_\+id, int vx, int bit\+\_\+size)
\begin{DoxyCompactList}\small\item\em Horizontal i\+Zm/\+\+VX random-\/prime search. \end{DoxyCompactList}\item 
int \doxymbox{\hyperlink{group__iz__toolkit_ga58ea9ced15462006d8a8c223719c57f4}{vy\+\_\+search\+\_\+prime}} (mpz\+\_\+t p, int m\+\_\+id, mpz\+\_\+t vx)
\begin{DoxyCompactList}\small\item\em Vertical i\+Zm/\+\+VY random-\/prime search. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Toolkit Tests}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{group__iz__toolkit_gaa10871fd00b11d294cfe98df45120dc0}\label{group__iz__toolkit_gaa10871fd00b11d294cfe98df45120dc0} 
int {\bfseries TEST\+\_\+\+IZM} (int verbose)
\begin{DoxyCompactList}\small\item\em Run \doxylink{struct_i_z_m}{IZM} construction and solver tests. \end{DoxyCompactList}\item 
\Hypertarget{group__iz__toolkit_gab8ec56858686f5bbccad8bc101cb9f8d}\label{group__iz__toolkit_gab8ec56858686f5bbccad8bc101cb9f8d} 
int {\bfseries TEST\+\_\+\+VX\+\_\+\+SEG} (int verbose)
\begin{DoxyCompactList}\small\item\em Run VX segment tests. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Standard VX Sizes (primorial products excluding 2,3)}
\begin{DoxyCompactItemize}
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_ga6a2cce58f5622e3d2b97c2dd251aade1}{VX2}}~(5 \texorpdfstring{$\ast$}{*} 7ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_ga5272963aed063a5501e96731a4dc2334}{VX3}}~(\doxymbox{\hyperlink{group__iz__toolkit_ga6a2cce58f5622e3d2b97c2dd251aade1}{VX2}} \texorpdfstring{$\ast$}{*} 11ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_gad288993421c2fa2e3d37d449cc0134c9}{VX4}}~(\doxymbox{\hyperlink{group__iz__toolkit_ga5272963aed063a5501e96731a4dc2334}{VX3}} \texorpdfstring{$\ast$}{*} 13ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_ga70f1e9557da83099d06828cc5d9719b0}{VX5}}~(\doxymbox{\hyperlink{group__iz__toolkit_gad288993421c2fa2e3d37d449cc0134c9}{VX4}} \texorpdfstring{$\ast$}{*} 17ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_ga7510fdd07a68973d711e47ff3296e3ba}{VX6}}~(\doxymbox{\hyperlink{group__iz__toolkit_ga70f1e9557da83099d06828cc5d9719b0}{VX5}} \texorpdfstring{$\ast$}{*} 19ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_gac9b1091e8f0d8749a07c83b66d559ff4}{VX7}}~(\doxymbox{\hyperlink{group__iz__toolkit_ga7510fdd07a68973d711e47ff3296e3ba}{VX6}} \texorpdfstring{$\ast$}{*} 23ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_ga2c3010de7df0076f6693afe35114c236}{VX8}}~(\doxymbox{\hyperlink{group__iz__toolkit_gac9b1091e8f0d8749a07c83b66d559ff4}{VX7}} \texorpdfstring{$\ast$}{*} 29ULL)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Internal building blocks for SiZ and Si\+Zm implementations. 



\label{doc-define-members}
\Hypertarget{group__iz__toolkit_doc-define-members}
\doxysubsection{Macro Definition Documentation}
\Hypertarget{group__iz__toolkit_gaa00f10dbfb5d0730503a789900de9134}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!MR\_ROUNDS@{MR\_ROUNDS}}
\index{MR\_ROUNDS@{MR\_ROUNDS}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{MR\_ROUNDS}{MR\_ROUNDS}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gaa00f10dbfb5d0730503a789900de9134} 
\+\#define MR\+\_\+\+ROUNDS~25}

Default Miller-\/\+Rabin rounds used by toolkit search/\+sieve helpers. 

Definition at line \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00079}{79}} of file \doxymbox{\hyperlink{i_z__toolkit_8h_source}{i\+Z\+\_\+toolkit.\+h}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00819}{i\+Z\+\_\+next\+\_\+prime()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00713}{vx\+\_\+init()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l01017}{vx\+\_\+search\+\_\+prime()}}, and \doxymbox{\hyperlink{i_z__toolkit_8c_source_l01114}{vy\+\_\+search\+\_\+prime()}}.

\Hypertarget{group__iz__toolkit_ga6a2cce58f5622e3d2b97c2dd251aade1}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!VX2@{VX2}}
\index{VX2@{VX2}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{VX2}{VX2}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga6a2cce58f5622e3d2b97c2dd251aade1} 
\+\#define VX2~(5 \texorpdfstring{$\ast$}{*} 7ULL)}

35 

Definition at line \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00069}{69}} of file \doxymbox{\hyperlink{i_z__toolkit_8h_source}{i\+Z\+\_\+toolkit.\+h}}.

\Hypertarget{group__iz__toolkit_ga5272963aed063a5501e96731a4dc2334}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!VX3@{VX3}}
\index{VX3@{VX3}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{VX3}{VX3}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga5272963aed063a5501e96731a4dc2334} 
\+\#define VX3~(\doxymbox{\hyperlink{group__iz__toolkit_ga6a2cce58f5622e3d2b97c2dd251aade1}{VX2}} \texorpdfstring{$\ast$}{*} 11ULL)}

385 

Definition at line \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00070}{70}} of file \doxymbox{\hyperlink{i_z__toolkit_8h_source}{i\+Z\+\_\+toolkit.\+h}}.

\Hypertarget{group__iz__toolkit_gad288993421c2fa2e3d37d449cc0134c9}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!VX4@{VX4}}
\index{VX4@{VX4}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{VX4}{VX4}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gad288993421c2fa2e3d37d449cc0134c9} 
\+\#define VX4~(\doxymbox{\hyperlink{group__iz__toolkit_ga5272963aed063a5501e96731a4dc2334}{VX3}} \texorpdfstring{$\ast$}{*} 13ULL)}

5005 

Definition at line \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00071}{71}} of file \doxymbox{\hyperlink{i_z__toolkit_8h_source}{i\+Z\+\_\+toolkit.\+h}}.

\Hypertarget{group__iz__toolkit_ga70f1e9557da83099d06828cc5d9719b0}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!VX5@{VX5}}
\index{VX5@{VX5}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{VX5}{VX5}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga70f1e9557da83099d06828cc5d9719b0} 
\+\#define VX5~(\doxymbox{\hyperlink{group__iz__toolkit_gad288993421c2fa2e3d37d449cc0134c9}{VX4}} \texorpdfstring{$\ast$}{*} 17ULL)}

85085 

Definition at line \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00072}{72}} of file \doxymbox{\hyperlink{i_z__toolkit_8h_source}{i\+Z\+\_\+toolkit.\+h}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00819}{i\+Z\+\_\+next\+\_\+prime()}}, and \doxymbox{\hyperlink{i_z__apps_8c_source_l00692}{vx\+\_\+random\+\_\+prime()}}.

\Hypertarget{group__iz__toolkit_ga7510fdd07a68973d711e47ff3296e3ba}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!VX6@{VX6}}
\index{VX6@{VX6}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{VX6}{VX6}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga7510fdd07a68973d711e47ff3296e3ba} 
\+\#define VX6~(\doxymbox{\hyperlink{group__iz__toolkit_ga70f1e9557da83099d06828cc5d9719b0}{VX5}} \texorpdfstring{$\ast$}{*} 19ULL)}

1616615 

Definition at line \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00073}{73}} of file \doxymbox{\hyperlink{i_z__toolkit_8h_source}{i\+Z\+\_\+toolkit.\+h}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00819}{i\+Z\+\_\+next\+\_\+prime()}}, \doxymbox{\hyperlink{i_z__apps_8c_source_l00035}{Si\+Z\+\_\+stream()}}, and \doxymbox{\hyperlink{i_z__apps_8c_source_l00692}{vx\+\_\+random\+\_\+prime()}}.

\Hypertarget{group__iz__toolkit_gac9b1091e8f0d8749a07c83b66d559ff4}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!VX7@{VX7}}
\index{VX7@{VX7}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{VX7}{VX7}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gac9b1091e8f0d8749a07c83b66d559ff4} 
\+\#define VX7~(\doxymbox{\hyperlink{group__iz__toolkit_ga7510fdd07a68973d711e47ff3296e3ba}{VX6}} \texorpdfstring{$\ast$}{*} 23ULL)}

37260615 

Definition at line \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00074}{74}} of file \doxymbox{\hyperlink{i_z__toolkit_8h_source}{i\+Z\+\_\+toolkit.\+h}}.

\Hypertarget{group__iz__toolkit_ga2c3010de7df0076f6693afe35114c236}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!VX8@{VX8}}
\index{VX8@{VX8}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{VX8}{VX8}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga2c3010de7df0076f6693afe35114c236} 
\+\#define VX8~(\doxymbox{\hyperlink{group__iz__toolkit_gac9b1091e8f0d8749a07c83b66d559ff4}{VX7}} \texorpdfstring{$\ast$}{*} 29ULL)}

1080558835 

Definition at line \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00075}{75}} of file \doxymbox{\hyperlink{i_z__toolkit_8h_source}{i\+Z\+\_\+toolkit.\+h}}.



\label{doc-func-members}
\Hypertarget{group__iz__toolkit_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{group__iz__toolkit_ga1dbb019b08a42984e1733f0c7c3881a0}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!check\_primality@{check\_primality}}
\index{check\_primality@{check\_primality}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{check\_primality()}{check\_primality()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga1dbb019b08a42984e1733f0c7c3881a0} 
int check\+\_\+primality (\begin{DoxyParamCaption}\item[{mpz\+\_\+t}]{n}{, }\item[{int}]{rounds}{}\end{DoxyParamCaption})}



Check the primality of a number using GMP\textquotesingle{}s probabilistic test. 


\begin{DoxyParams}{Parameters}
{\em n} & Number to check. \\
\hline
{\em rounds} & Number of Miller-\/\+Rabin rounds. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Non-\/zero if probably prime, 0 if composite.
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em n} & Number to check. \\
\hline
{\em rounds} & Number of Miller-\/\+Rabin rounds. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Non-\/zero if probably prime, 0 if composite.
\end{DoxyReturn}
This function serves as a single source of truth for primality testing, wrapping GMP\textquotesingle{}s {\ttfamily mpz\+\_\+probab\+\_\+prime\+\_\+p} function, allowing for changes to the underlying primality testing method in the future without affecting the API. 

Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00153}{153}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



Referenced by \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00633}{vx\+\_\+prob\+\_\+sieve()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l01017}{vx\+\_\+search\+\_\+prime()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00866}{vx\+\_\+stream()}}, and \doxymbox{\hyperlink{i_z__toolkit_8c_source_l01114}{vy\+\_\+search\+\_\+prime()}}.

\Hypertarget{group__iz__toolkit_gac92eb547227979fc0774e0529efa6180}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!compute\_l2\_vx@{compute\_l2\_vx}}
\index{compute\_l2\_vx@{compute\_l2\_vx}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{compute\_l2\_vx()}{compute\_l2\_vx()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gac92eb547227979fc0774e0529efa6180} 
uint64\+\_\+t compute\+\_\+l2\+\_\+vx (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{n}{}\end{DoxyParamCaption})}



Choose VX using an L2-\/cache-\/aware heuristic. 

Choose a cache-\/aware VX size based on detected L2 capacity.


\begin{DoxyParams}{Parameters}
{\em n} & Target numeric limit. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Selected VX size.
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em n} & Target numeric sieve bound. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
L2 compatible VX size. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00306}{306}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{utils_8c_source_l00531}{get\+\_\+cpu\+\_\+\+L2\+\_\+cache\+\_\+size\+\_\+bits()}}, \doxymbox{\hyperlink{utils_8h_source_l00048}{MIN}}, and \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00010}{s\+\_\+primes}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00184}{Si\+Z\+\_\+count()}}, and \doxymbox{\hyperlink{prime__sieve_8c_source_l00516}{Si\+Zm()}}.

\Hypertarget{group__iz__toolkit_ga23df437281a4315af3cff9b76fab9dd8}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!compute\_max\_vx@{compute\_max\_vx}}
\index{compute\_max\_vx@{compute\_max\_vx}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{compute\_max\_vx()}{compute\_max\_vx()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga23df437281a4315af3cff9b76fab9dd8} 
void compute\+\_\+max\+\_\+vx (\begin{DoxyParamCaption}\item[{mpz\+\_\+t}]{vx}{, }\item[{int}]{bit\+\_\+size}{}\end{DoxyParamCaption})}



Compute largest VX below 2\texorpdfstring{$^\wedge$}{\string^}bit\+\_\+size. 

Compute the maximum vx such that vx \texorpdfstring{$<$}{<} 2\texorpdfstring{$^\wedge$}{\string^}bit\+\_\+size.


\begin{DoxyParams}{Parameters}
{\em vx} & Output mpz\+\_\+t containing VX. \\
\hline
{\em bit\+\_\+size} & Bit-\/size ceiling.\\
\hline
\end{DoxyParams}
Parameters:\+ 
\begin{DoxyParams}{Parameters}
{\em vx} & mpz\+\_\+t variable to store the computed maximum vx value. \\
\hline
{\em bit\+\_\+size} & Integer representing the bit size limit for vx. \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00331}{331}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{int__arrays_8h_source_l00043}{UI64\+\_\+\+ARRAY::\+array}}, and \doxymbox{\hyperlink{prime__sieve_8c_source_l00444}{Si\+Z()}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00545}{vy\+\_\+random\+\_\+prime()}}.

\Hypertarget{group__iz__toolkit_ga6170b19f9022bf256850f1f2ee6dd786}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!compute\_vx\_k@{compute\_vx\_k}}
\index{compute\_vx\_k@{compute\_vx\_k}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{compute\_vx\_k()}{compute\_vx\_k()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga6170b19f9022bf256850f1f2ee6dd786} 
uint64\+\_\+t compute\+\_\+vx\+\_\+k (\begin{DoxyParamCaption}\item[{int}]{k}{}\end{DoxyParamCaption})}



Calculate VX\+\_\+\{ {\ttfamily k} \}. 

Calculate a VX\+\_\+\{k\} as the product of the first k primes \texorpdfstring{$>$}{>} 3.


\begin{DoxyParams}{Parameters}
{\em k} & Number of multiplicative prime factors (\texorpdfstring{$>$}{>}3). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Selected VX size.
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em k} & number of consecutive primes (\texorpdfstring{$>$}{>} 3) to include in the product. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Computed VX\+\_\+k value. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00286}{286}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00010}{s\+\_\+primes}}.

\Hypertarget{group__iz__toolkit_gadc4e21760e38081c6966fa9d9d23e940}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!get\_root\_primes@{get\_root\_primes}}
\index{get\_root\_primes@{get\_root\_primes}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{get\_root\_primes()}{get\_root\_primes()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gadc4e21760e38081c6966fa9d9d23e940} 
void get\+\_\+root\+\_\+primes (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*}}]{primes}{, }\item[{uint64\+\_\+t}]{limit}{}\end{DoxyParamCaption})}



Generate primes up to {\ttfamily limit} for deterministic sieving. 

Generate root primes up to {\ttfamily limit} using iZ bitmap traversal.


\begin{DoxyParams}{Parameters}
{\em primes} & Output array, appended in ascending order. \\
\hline
{\em limit} & Numeric upper bound.\\
\hline
{\em primes} & Destination array. \\
\hline
{\em limit} & Numeric upper bound. \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00112}{112}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{bitmap_8c_source_l00103}{bitmap\+\_\+free()}}, \doxymbox{\hyperlink{bitmap_8c_source_l00057}{bitmap\+\_\+init()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00070}{process\+\_\+i\+Z\+\_\+bitmaps()}}, \doxymbox{\hyperlink{group__iz__arrays_gab1a0ced5e600649da6e519693a3a2851}{ui64\+\_\+free()}}, and \doxymbox{\hyperlink{group__iz__arrays_ga51cf8a13f4a4ae5c076a1be3a3333a68}{ui64\+\_\+push()}}.



Referenced by \doxymbox{\hyperlink{prime__sieve_8c_source_l00623}{Si\+Zm\+\_\+vy()}}.

\Hypertarget{group__iz__toolkit_gaffec7a5b407ee6c59ccc1678e0ab89ba}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!iZ@{iZ}}
\index{iZ@{iZ}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{iZ()}{iZ()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gaffec7a5b407ee6c59ccc1678e0ab89ba} 
uint64\+\_\+t iZ (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{x}{, }\item[{int}]{i}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Map iZ coordinates to an integer:\+ {\ttfamily 6\texorpdfstring{$\ast$}{*}x + i}. 


\begin{DoxyParams}{Parameters}
{\em x} & iZ x-\/coordinate. \\
\hline
{\em i} & Matrix identifier, typically -\/1 or +1. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Mapped integer value.
\end{DoxyReturn}
Map iZ coordinates to an integer:\+ {\ttfamily 6\texorpdfstring{$\ast$}{*}x + i}.

Parameters:\+ 
\begin{DoxyParams}{Parameters}
{\em x} & (uint64\+\_\+t) The value of {\ttfamily x} in {\ttfamily 6x + i}. \\
\hline
{\em i} & (int) The value of {\ttfamily i} in {\ttfamily 6x + i}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The computed value {\ttfamily 6x + i} as a 64-\/bit unsigned integer. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00024}{24}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



Referenced by \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00070}{process\+\_\+i\+Z\+\_\+bitmaps()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00516}{Si\+Zm()}}, and \doxymbox{\hyperlink{prime__sieve_8c_source_l00623}{Si\+Zm\+\_\+vy()}}.

\Hypertarget{group__iz__toolkit_gaa3f0472ebd680beaa6b0759acbedd9eb}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!iZ\_mpz@{iZ\_mpz}}
\index{iZ\_mpz@{iZ\_mpz}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{iZ\_mpz()}{iZ\_mpz()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gaa3f0472ebd680beaa6b0759acbedd9eb} 
void i\+Z\+\_\+mpz (\begin{DoxyParamCaption}\item[{mpz\+\_\+t}]{z}{, }\item[{mpz\+\_\+t}]{x}{, }\item[{int}]{i}{}\end{DoxyParamCaption})}



GMP variant of \doxylink{group__iz__toolkit_gaffec7a5b407ee6c59ccc1678e0ab89ba}{i\+Z()}. 


\begin{DoxyParams}{Parameters}
{\em z} & Output value. \\
\hline
{\em x} & Input x-\/coordinate. \\
\hline
{\em i} & Matrix identifier, typically -\/1 or +1.\\
\hline
\end{DoxyParams}
GMP variant of \doxylink{group__iz__toolkit_gaffec7a5b407ee6c59ccc1678e0ab89ba}{i\+Z()}.

Parameters:\+ 
\begin{DoxyParams}{Parameters}
{\em z} & (mpz\+\_\+t) The result of the calculation {\ttfamily 6x + i}. \\
\hline
{\em x} & (mpz\+\_\+t) The input value of {\ttfamily x} in {\ttfamily 6x + i}. \\
\hline
{\em i} & (int) The value of {\ttfamily i} in {\ttfamily 6x + i}. \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00037}{37}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00819}{i\+Z\+\_\+next\+\_\+prime()}}, \doxymbox{\hyperlink{i_z__apps_8c_source_l00184}{Si\+Z\+\_\+count()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00633}{vx\+\_\+prob\+\_\+sieve()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l01017}{vx\+\_\+search\+\_\+prime()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00529}{vx\+\_\+set\+\_\+base\+\_\+values()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00866}{vx\+\_\+stream()}}, and \doxymbox{\hyperlink{i_z__toolkit_8c_source_l01114}{vy\+\_\+search\+\_\+prime()}}.

\Hypertarget{group__iz__toolkit_gaa8c21336f708189a8d18f41085468c5c}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!iZm\_clone@{iZm\_clone}}
\index{iZm\_clone@{iZm\_clone}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{iZm\_clone()}{iZm\_clone()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gaa8c21336f708189a8d18f41085468c5c} 
\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*} i\+Zm\+\_\+clone (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*}}]{src}{}\end{DoxyParamCaption})}



Deep-\/copy an \doxylink{struct_i_z_m}{IZM} object for per-\/worker ownership. 

Deep-\/copy an \doxylink{struct_i_z_m}{IZM} object for independent worker usage.


\begin{DoxyParams}{Parameters}
{\em src} & Source \doxylink{struct_i_z_m}{IZM} instance. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Newly allocated clone, or NULL on failure.
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em src} & Source \doxylink{struct_i_z_m}{IZM} object. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Cloned \doxylink{struct_i_z_m}{IZM} object, or NULL on failure. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00232}{232}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{int__arrays_8h_source_l00043}{UI64\+\_\+\+ARRAY::\+array}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00088}{IZM::\+base\+\_\+x5}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00089}{IZM::\+base\+\_\+x7}}, \doxymbox{\hyperlink{bitmap_8c_source_l00382}{bitmap\+\_\+clone()}}, \doxymbox{\hyperlink{int__arrays_8h_source_l00041}{UI64\+\_\+\+ARRAY::\+capacity}}, \doxymbox{\hyperlink{int__arrays_8h_source_l00042}{UI64\+\_\+\+ARRAY::\+count}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00266}{i\+Zm\+\_\+free()}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00087}{IZM::\+k\+\_\+vx}}, \doxymbox{\hyperlink{group__iz__logger_ga3dc3bd5ec0c013065ffc731ea33271d5}{log\+\_\+error()}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00090}{IZM::\+root\+\_\+primes}}, \doxymbox{\hyperlink{group__iz__arrays_gaf9ef1b739df3c37089c62c7f1adbfdce}{ui64\+\_\+init()}}, and \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00086}{IZM::\+vx}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00184}{Si\+Z\+\_\+count()}}.

\Hypertarget{group__iz__toolkit_gacf776a7cedd726d8362aaf344102365d}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!iZm\_construct\_vx\_base@{iZm\_construct\_vx\_base}}
\index{iZm\_construct\_vx\_base@{iZm\_construct\_vx\_base}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{iZm\_construct\_vx\_base()}{iZm\_construct\_vx\_base()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gacf776a7cedd726d8362aaf344102365d} 
void i\+Zm\+\_\+construct\+\_\+vx\+\_\+base (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{vx}{, }\item[{\doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}}]{base\+\_\+x5}{, }\item[{\doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}}]{base\+\_\+x7}{}\end{DoxyParamCaption})}



Build pre-\/sieved base bitmaps for a VX segment. 

Constructs a pre-\/sieved i\+Zm base segment of size vx.


\begin{DoxyParams}{Parameters}
{\em vx} & Segment width. \\
\hline
{\em base\+\_\+x5} & Output bitmap for 6x-\/1 candidates. \\
\hline
{\em base\+\_\+x7} & Output bitmap for 6x+1 candidates.\\
\hline
\end{DoxyParams}
Description:\+ This function constructs a pre-\/sieved i\+Zm base segment of size vx. It marks all composites of small primes that divide vx in the bitmaps base\+\_\+x5 (i\+Z-\/) and base\+\_\+x7 (i\+Z+). This pre-\/sieved base can then be used as a template for sieving all vx segments.

Parameters:\+ 
\begin{DoxyParams}{Parameters}
{\em i\+Zm} & Pointer to the \doxylink{struct_i_z_m}{IZM} structure containing the base segment bitmaps. \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00363}{363}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{bitmap_8c_source_l00159}{bitmap\+\_\+clear\+\_\+bit()}}, \doxymbox{\hyperlink{bitmap_8c_source_l00233}{bitmap\+\_\+clear\+\_\+steps\+\_\+simd()}}, \doxymbox{\hyperlink{bitmap_8c_source_l00170}{bitmap\+\_\+set\+\_\+all()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00010}{s\+\_\+primes}}, and \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00013}{s\+\_\+primes\+\_\+count}}.



Referenced by \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00184}{i\+Zm\+\_\+init()}}, and \doxymbox{\hyperlink{prime__sieve_8c_source_l00516}{Si\+Zm()}}.

\Hypertarget{group__iz__toolkit_ga81a316b2719f678e9fbc4ac8c835460c}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!iZm\_free@{iZm\_free}}
\index{iZm\_free@{iZm\_free}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{iZm\_free()}{iZm\_free()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga81a316b2719f678e9fbc4ac8c835460c} 
void i\+Zm\+\_\+free (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{i\+Zm}{}\end{DoxyParamCaption})}



Release an \doxylink{struct_i_z_m}{IZM} object and set the caller pointer to NULL. 

Free the memory allocated for an \doxylink{struct_i_z_m}{IZM} structure.


\begin{DoxyParams}{Parameters}
{\em i\+Zm} & Address of an \doxylink{struct_i_z_m}{IZM} pointer.\\
\hline
\end{DoxyParams}
Parameters:\+ 
\begin{DoxyParams}{Parameters}
{\em i\+Zm} & A pointer to the \doxylink{struct_i_z_m}{IZM} structure to be freed. \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00266}{266}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{bitmap_8c_source_l00103}{bitmap\+\_\+free()}}, and \doxymbox{\hyperlink{group__iz__arrays_gab1a0ced5e600649da6e519693a3a2851}{ui64\+\_\+free()}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00819}{i\+Z\+\_\+next\+\_\+prime()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00232}{i\+Zm\+\_\+clone()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00184}{i\+Zm\+\_\+init()}}, \doxymbox{\hyperlink{i_z__apps_8c_source_l00184}{Si\+Z\+\_\+count()}}, and \doxymbox{\hyperlink{i_z__apps_8c_source_l00035}{Si\+Z\+\_\+stream()}}.

\Hypertarget{group__iz__toolkit_gaeb29a4d0536bb0aa227e230539081d98}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!iZm\_init@{iZm\_init}}
\index{iZm\_init@{iZm\_init}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{iZm\_init()}{iZm\_init()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gaeb29a4d0536bb0aa227e230539081d98} 
\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*} i\+Zm\+\_\+init (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{vx}{}\end{DoxyParamCaption})}



Allocate and initialize an \doxylink{struct_i_z_m}{IZM} object for a given VX. 

Initialize an i\+Zm structure for a given vx size.


\begin{DoxyParams}{Parameters}
{\em vx} & Segment width; must be odd, not divisible by 3, and \texorpdfstring{$>$}{>}= 35. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Initialized \doxylink{struct_i_z_m}{IZM} object, or NULL on failure.
\end{DoxyReturn}
This function initializes an i\+Zm structure for a specified vx size. It allocates memory for the structure, generates root primes for deterministic sieving, initializes base bitmaps, and constructs pre-\/sieved base segments for i\+Zm5 and i\+Zm7.

Parameters:\+ 
\begin{DoxyParams}{Parameters}
{\em vx} & The size of the segment for the i\+Zm structure.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the initialized \doxylink{struct_i_z_m}{IZM} structure. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00184}{184}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00088}{IZM::\+base\+\_\+x5}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00089}{IZM::\+base\+\_\+x7}}, \doxymbox{\hyperlink{bitmap_8c_source_l00057}{bitmap\+\_\+init()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00052}{compute\+\_\+k\+\_\+vx()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00363}{i\+Zm\+\_\+construct\+\_\+vx\+\_\+base()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00266}{i\+Zm\+\_\+free()}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00087}{IZM::\+k\+\_\+vx}}, \doxymbox{\hyperlink{group__iz__logger_ga3dc3bd5ec0c013065ffc731ea33271d5}{log\+\_\+error()}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00090}{IZM::\+root\+\_\+primes}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00444}{Si\+Z()}}, \doxymbox{\hyperlink{group__iz__arrays_gab1a0ced5e600649da6e519693a3a2851}{ui64\+\_\+free()}}, and \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00086}{IZM::\+vx}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00819}{i\+Z\+\_\+next\+\_\+prime()}}, \doxymbox{\hyperlink{i_z__apps_8c_source_l00184}{Si\+Z\+\_\+count()}}, and \doxymbox{\hyperlink{i_z__apps_8c_source_l00035}{Si\+Z\+\_\+stream()}}.

\Hypertarget{group__iz__toolkit_ga596920e4772d76fe9dc61a541b282275}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!iZm\_solve\_for\_x0@{iZm\_solve\_for\_x0}}
\index{iZm\_solve\_for\_x0@{iZm\_solve\_for\_x0}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{iZm\_solve\_for\_x0()}{iZm\_solve\_for\_x0()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga596920e4772d76fe9dc61a541b282275} 
uint64\+\_\+t i\+Zm\+\_\+solve\+\_\+for\+\_\+x0 (\begin{DoxyParamCaption}\item[{int}]{m\+\_\+id}{, }\item[{uint64\+\_\+t}]{p}{, }\item[{uint64\+\_\+t}]{vx}{, }\item[{uint64\+\_\+t}]{y}{}\end{DoxyParamCaption})}



Solve first x-\/hit of prime {\ttfamily p} for line {\ttfamily m\+\_\+id} in segment y. 

Compute the first composite hit of p in the yth vx segment in i\+Zm index space.


\begin{DoxyParams}{Parameters}
{\em m\+\_\+id} & Line id (-\/1 for x5, +1 for x7). \\
\hline
{\em p} & Prime used for marking. \\
\hline
{\em vx} & Segment width. \\
\hline
{\em y} & Segment index. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
First x index to clear for this prime/\+line.
\end{DoxyReturn}
Description:\+ This function solves for the smallest x that satisfies:\+ (x + vx \texorpdfstring{$\ast$}{*} y) ≡ x\+\_\+p (mod p), where x\+\_\+p is normalized based on the m\+\_\+id and p to either x\+\_\+p or p -\/ x\+\_\+p, then computes x and returns it.

Parameters:\+ 
\begin{DoxyParams}{Parameters}
{\em m\+\_\+id} & int matrix identifier (-\/1 for i\+Zm5, 1 for i\+Zm7). \\
\hline
{\em p} & Unsigned 64-\/bit integer parameter. \\
\hline
{\em vx} & size\+\_\+t parameter representing the vx value. \\
\hline
{\em y} & Unsigned 64-\/bit integer parameter.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The computed x value as a 64-\/bit unsigned integer. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00415}{415}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



Referenced by \doxymbox{\hyperlink{prime__sieve_8c_source_l00516}{Si\+Zm()}}, and \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00566}{vx\+\_\+det\+\_\+sieve()}}.

\Hypertarget{group__iz__toolkit_ga3ee0fd9e3f27fd5d30fddfe7d1056c57}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!iZm\_solve\_for\_x0\_mpz@{iZm\_solve\_for\_x0\_mpz}}
\index{iZm\_solve\_for\_x0\_mpz@{iZm\_solve\_for\_x0\_mpz}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{iZm\_solve\_for\_x0\_mpz()}{iZm\_solve\_for\_x0\_mpz()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga3ee0fd9e3f27fd5d30fddfe7d1056c57} 
uint64\+\_\+t i\+Zm\+\_\+solve\+\_\+for\+\_\+x0\+\_\+mpz (\begin{DoxyParamCaption}\item[{int}]{m\+\_\+id}{, }\item[{uint64\+\_\+t}]{p}{, }\item[{uint64\+\_\+t}]{vx}{, }\item[{mpz\+\_\+t}]{y}{}\end{DoxyParamCaption})}



GMP variant of \doxylink{group__iz__toolkit_ga596920e4772d76fe9dc61a541b282275}{i\+Zm\+\_\+solve\+\_\+for\+\_\+x0()} for very large y. 

Solve for x given m\+\_\+id, p, vx, and y using GMP. Same as above but using GMP. Suitable for arbitrary y values.


\begin{DoxyParams}{Parameters}
{\em m\+\_\+id} & Line id (-\/1 for x5, +1 for x7). \\
\hline
{\em p} & Prime used for marking. \\
\hline
{\em vx} & Segment width. \\
\hline
{\em y} & Segment index as mpz. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
First x index to clear for this prime/\+line.
\end{DoxyReturn}
Parameters:\+ 
\begin{DoxyParams}{Parameters}
{\em m\+\_\+id} & int matrix identifier (-\/1 for i\+Zm5, 1 for i\+Zm7). \\
\hline
{\em p} & Unsigned 64-\/bit integer parameter. \\
\hline
{\em vx} & Size\+\_\+t parameter representing the vx value. \\
\hline
{\em y} & mpz\+\_\+t parameter representing the y value.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The computed x value as a 64-\/bit unsigned integer. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00449}{449}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



Referenced by \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00566}{vx\+\_\+det\+\_\+sieve()}}, and \doxymbox{\hyperlink{i_z__toolkit_8c_source_l01017}{vx\+\_\+search\+\_\+prime()}}.

\Hypertarget{group__iz__toolkit_ga50cf18d6528c411820a9b081b13875ca}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!iZm\_solve\_for\_y0@{iZm\_solve\_for\_y0}}
\index{iZm\_solve\_for\_y0@{iZm\_solve\_for\_y0}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{iZm\_solve\_for\_y0()}{iZm\_solve\_for\_y0()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga50cf18d6528c411820a9b081b13875ca} 
int64\+\_\+t i\+Zm\+\_\+solve\+\_\+for\+\_\+y0 (\begin{DoxyParamCaption}\item[{int}]{m\+\_\+id}{, }\item[{uint64\+\_\+t}]{p}{, }\item[{uint64\+\_\+t}]{vx}{, }\item[{uint64\+\_\+t}]{x}{}\end{DoxyParamCaption})}



Solve first y-\/hit for fixed x in vertical (vy) scanning. 

Compute the first composite hit of p in the xth vy segment in i\+Zm of width vx.


\begin{DoxyParams}{Parameters}
{\em m\+\_\+id} & Line id (-\/1 for x5, +1 for x7). \\
\hline
{\em p} & Prime used for marking. \\
\hline
{\em vx} & Segment width. \\
\hline
{\em x} & Fixed x-\/coordinate. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
y index on success, -\/1 when no modular solution exists.
\end{DoxyReturn}
Description:\+ This function solves for the smallest y that satisfies the equation (x + vx \texorpdfstring{$\ast$}{*} y) ≡ x\+\_\+p (mod p), where x\+\_\+p is normalized based on the m\+\_\+id and p. The function checks if p and vx are co-\/primes, and if not, it returns -\/1 indicating no solution can be found. If they are co-\/primes, it calculates the multiplicative inverse of vx modulo p and computes y using the formula y = (delta \texorpdfstring{$\ast$}{*} vx\+\_\+inv) \% p, where delta is the difference between x\+\_\+p and x modulo p.

Parameters:\+ 
\begin{DoxyParams}{Parameters}
{\em m\+\_\+id} & int matrix identifier (-\/1 for i\+Zm5, 1 for i\+Zm7). \\
\hline
{\em p} & Unsigned 64-\/bit integer parameter. \\
\hline
{\em vx} & Size\+\_\+t parameter representing the vx value. \\
\hline
{\em x} & Unsigned 64-\/bit integer parameter.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The computed y value as a 64-\/bit unsigned integer. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00490}{490}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{utils_8c_source_l00425}{gcd()}}, and \doxymbox{\hyperlink{utils_8c_source_l00453}{modular\+\_\+inverse()}}.



Referenced by \doxymbox{\hyperlink{prime__sieve_8c_source_l00623}{Si\+Zm\+\_\+vy()}}.

\Hypertarget{group__iz__toolkit_ga865e51a5e6f28945747e2ad6988c2e4e}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!process\_iZ\_bitmaps@{process\_iZ\_bitmaps}}
\index{process\_iZ\_bitmaps@{process\_iZ\_bitmaps}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{process\_iZ\_bitmaps()}{process\_iZ\_bitmaps()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga865e51a5e6f28945747e2ad6988c2e4e} 
void process\+\_\+i\+Z\+\_\+bitmaps (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*}}]{primes}{, }\item[{\doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}}]{x5}{, }\item[{\doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}}]{x7}{, }\item[{uint64\+\_\+t}]{x\+\_\+limit}{}\end{DoxyParamCaption})}



Traverse iZ bitmaps, emit surviving primes, and mark composites. 

Consume iZ candidate bitmaps, emit primes, and mark root composites.


\begin{DoxyParams}{Parameters}
{\em primes} & Output prime array. \\
\hline
{\em x5} & Bitmap for 6x-\/1 candidates. \\
\hline
{\em x7} & Bitmap for 6x+1 candidates. \\
\hline
{\em x\+\_\+limit} & Exclusive x upper bound.\\
\hline
{\em primes} & Destination array for discovered primes. \\
\hline
{\em x5} & Bitmap for 6x-\/1 candidates. \\
\hline
{\em x7} & Bitmap for 6x+1 candidates. \\
\hline
{\em x\+\_\+limit} & Exclusive x upper bound. \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00070}{70}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{bitmap_8c_source_l00233}{bitmap\+\_\+clear\+\_\+steps\+\_\+simd()}}, \doxymbox{\hyperlink{bitmap_8c_source_l00137}{bitmap\+\_\+get\+\_\+bit()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00024}{i\+Z()}}, and \doxymbox{\hyperlink{group__iz__arrays_ga51cf8a13f4a4ae5c076a1be3a3333a68}{ui64\+\_\+push()}}.



Referenced by \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00112}{get\+\_\+root\+\_\+primes()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00444}{Si\+Z()}}, and \doxymbox{\hyperlink{prime__sieve_8c_source_l00516}{Si\+Zm()}}.

\Hypertarget{group__iz__toolkit_gab053af28699e3138640445b16a1311f7}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!range\_info\_free@{range\_info\_free}}
\index{range\_info\_free@{range\_info\_free}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{range\_info\_free()}{range\_info\_free()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_gab053af28699e3138640445b16a1311f7} 
void range\+\_\+info\+\_\+free (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_i_z_m___r_a_n_g_e___i_n_f_o}{IZM\+\_\+\+RANGE\+\_\+\+INFO}} \texorpdfstring{$\ast$}{*}}]{info}{}\end{DoxyParamCaption})}



Clear all GMP fields owned by {\ttfamily info}. 



Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00989}{989}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00260}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Xe}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00259}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Xs}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00262}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Ye}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00261}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Ys}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00258}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Ze}}, and \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00257}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Zs}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00184}{Si\+Z\+\_\+count()}}, and \doxymbox{\hyperlink{i_z__apps_8c_source_l00035}{Si\+Z\+\_\+stream()}}.

\Hypertarget{group__iz__toolkit_ga5ada19be750a6f9b0837805ef34a1de4}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!range\_info\_init@{range\_info\_init}}
\index{range\_info\_init@{range\_info\_init}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{range\_info\_init()}{range\_info\_init()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga5ada19be750a6f9b0837805ef34a1de4} 
\doxymbox{\hyperlink{struct_i_z_m___r_a_n_g_e___i_n_f_o}{IZM\+\_\+\+RANGE\+\_\+\+INFO}} range\+\_\+info\+\_\+init (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e}{INPUT\+\_\+\+SIEVE\+\_\+\+RANGE}} \texorpdfstring{$\ast$}{*}}]{input\+\_\+range}{, }\item[{int}]{vx}{}\end{DoxyParamCaption})}



Map a decimal range input into i\+Zm coordinates and segment bounds. 


\begin{DoxyParams}{Parameters}
{\em input\+\_\+range} & Range input ({\ttfamily start}, {\ttfamily range}). \\
\hline
{\em vx} & i\+Zm segment width. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Initialized range-\/info object; {\ttfamily y\+\_\+range \texorpdfstring{$<$}{<} 0} indicates invalid input or an unsupported y-\/span for the current implementation. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00944}{944}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{group__iz__logger_ga3dc3bd5ec0c013065ffc731ea33271d5}{log\+\_\+error()}}, \doxymbox{\hyperlink{i_z__api_8h_source_l00127}{INPUT\+\_\+\+SIEVE\+\_\+\+RANGE::\+range}}, \doxymbox{\hyperlink{i_z__api_8h_source_l00126}{INPUT\+\_\+\+SIEVE\+\_\+\+RANGE::\+start}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00256}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+vx}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00260}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Xe}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00259}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Xs}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00263}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+y\+\_\+range}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00262}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Ye}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00261}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Ys}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00258}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Ze}}, and \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00257}{IZM\+\_\+\+RANGE\+\_\+\+INFO::\+\+Zs}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00184}{Si\+Z\+\_\+count()}}, and \doxymbox{\hyperlink{i_z__apps_8c_source_l00035}{Si\+Z\+\_\+stream()}}.

\Hypertarget{group__iz__toolkit_ga824821f174cc26db2d310a68e8c2f19e}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!vx\_collect\_p\_gaps@{vx\_collect\_p\_gaps}}
\index{vx\_collect\_p\_gaps@{vx\_collect\_p\_gaps}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{vx\_collect\_p\_gaps()}{vx\_collect\_p\_gaps()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga824821f174cc26db2d310a68e8c2f19e} 
void vx\+\_\+collect\+\_\+p\+\_\+gaps (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}}]{vx\+\_\+obj}{}\end{DoxyParamCaption})}



Extract prime-\/gap encoding from a fully sieved segment. 

Convert survivor bits into compact prime-\/gap encoding.


\begin{DoxyParams}{Parameters}
{\em vx\+\_\+obj} & Segment object.\\
\hline
\end{DoxyParams}
This routine must run after deterministic/\+probabilistic sieving is complete. It populates \doxylink{struct_v_x___s_e_g_a25bbcd26bb0e69a6b9584594a714b8b5}{VX\+\_\+\+SEG::\+p\+\_\+gaps} for downstream streaming and gap traversal.


\begin{DoxyParams}{Parameters}
{\em vx\+\_\+obj} & Segment object with validated prime survivors. \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00787}{787}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{bitmap_8c_source_l00137}{bitmap\+\_\+get\+\_\+bit()}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00190}{VX\+\_\+\+SEG::\+is\+\_\+large\+\_\+limit}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00196}{VX\+\_\+\+SEG::\+p\+\_\+count}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00197}{VX\+\_\+\+SEG::\+p\+\_\+gaps}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00192}{VX\+\_\+\+SEG::\+start\+\_\+x}}, \doxymbox{\hyperlink{group__iz__arrays_ga495a195fcf45ae02c9402bcb389e7343}{ui16\+\_\+init()}}, \doxymbox{\hyperlink{group__iz__arrays_gaf19906d91639a464ff36cc425968bdae}{ui16\+\_\+push()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00847}{vx\+\_\+full\+\_\+sieve()}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00194}{VX\+\_\+\+SEG::\+x5}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00195}{VX\+\_\+\+SEG::\+x7}}, and \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00187}{VX\+\_\+\+SEG::\+y}}.



Referenced by \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00847}{vx\+\_\+full\+\_\+sieve()}}.

\Hypertarget{group__iz__toolkit_ga89a2804cb4fa979a32e4213ade786ec4}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!vx\_free@{vx\_free}}
\index{vx\_free@{vx\_free}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{vx\_free()}{vx\_free()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga89a2804cb4fa979a32e4213ade786ec4} 
void vx\+\_\+free (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{vx\+\_\+obj}{}\end{DoxyParamCaption})}



Free a VX segment and all owned resources. 

Free all memory owned by a VX segment object.


\begin{DoxyParams}{Parameters}
{\em vx\+\_\+obj} & Address of a \doxylink{struct_v_x___s_e_g}{VX\+\_\+\+SEG} pointer.\\
\hline
{\em vx\+\_\+obj} & Address of the \doxylink{struct_v_x___s_e_g}{VX\+\_\+\+SEG} pointer to release. \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00759}{759}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{bitmap_8c_source_l00103}{bitmap\+\_\+free()}}, and \doxymbox{\hyperlink{group__iz__arrays_ga6711fa1c3d7f6f57924486106423e18b}{ui16\+\_\+free()}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00184}{Si\+Z\+\_\+count()}}, and \doxymbox{\hyperlink{i_z__apps_8c_source_l00035}{Si\+Z\+\_\+stream()}}.

\Hypertarget{group__iz__toolkit_ga214f95ac7b685a7ff0c596afc70036b7}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!vx\_full\_sieve@{vx\_full\_sieve}}
\index{vx\_full\_sieve@{vx\_full\_sieve}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{vx\_full\_sieve()}{vx\_full\_sieve()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga214f95ac7b685a7ff0c596afc70036b7} 
void vx\+\_\+full\+\_\+sieve (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}}]{vx\+\_\+obj}{, }\item[{int}]{collect\+\_\+p\+\_\+gaps}{}\end{DoxyParamCaption})}



Complete segment processing (probabilistic stage and optional gaps). 

This function performs the sieve process on a given vx and y defined in the \doxylink{struct_v_x___s_e_g}{VX\+\_\+\+SEG} structure, and stores the primes gaps in the vx\+\_\+obj-\/\texorpdfstring{$>$}{>}p\+\_\+gaps array.


\begin{DoxyParams}{Parameters}
{\em vx\+\_\+obj} & Segment object. \\
\hline
{\em collect\+\_\+p\+\_\+gaps} & Non-\/zero to populate \doxylink{struct_v_x___s_e_g_a25bbcd26bb0e69a6b9584594a714b8b5}{VX\+\_\+\+SEG::\+p\+\_\+gaps}.\\
\hline
\end{DoxyParams}
Description:\+ This function combines deterministic sieving and probabilistic primality tests to identify prime candidates in a standard VX segment of a specific y in the i\+Z-\/\+Matrix. It could be used to only count primes in the vx segment, and optionally populates the vx\+\_\+obj-\/\texorpdfstring{$>$}{>}p\+\_\+gaps array with prime gaps between consecutive primes detected in the segment.


\begin{DoxyParams}{Parameters}
{\em vx\+\_\+obj} & The \doxylink{struct_v_x___s_e_g}{VX\+\_\+\+SEG} to be processed. \\
\hline
{\em collect\+\_\+p\+\_\+gaps} & 0 only counts primes and doesn\textquotesingle{}t store prime gaps, other non-\/zero int values populates vx\+\_\+obj-\/\texorpdfstring{$>$}{>}p\+\_\+gaps with detected prime gaps. \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00847}{847}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00190}{VX\+\_\+\+SEG::\+is\+\_\+large\+\_\+limit}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00787}{vx\+\_\+collect\+\_\+p\+\_\+gaps()}}, and \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00633}{vx\+\_\+prob\+\_\+sieve()}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00184}{Si\+Z\+\_\+count()}}, and \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00787}{vx\+\_\+collect\+\_\+p\+\_\+gaps()}}.

\Hypertarget{group__iz__toolkit_ga234719b01a0e090a1f66ed7766fe6d0f}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!vx\_init@{vx\_init}}
\index{vx\_init@{vx\_init}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{vx\_init()}{vx\_init()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga234719b01a0e090a1f66ed7766fe6d0f} 
\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*} vx\+\_\+init (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*}}]{i\+Zm}{, }\item[{int}]{start\+\_\+x}{, }\item[{int}]{end\+\_\+x}{, }\item[{char \texorpdfstring{$\ast$}{*}}]{y\+\_\+str}{, }\item[{int}]{mr\+\_\+rounds}{}\end{DoxyParamCaption})}



Initialize and deterministically sieve one VX segment. 

Initialize the members of the \doxylink{struct_v_x___s_e_g}{VX\+\_\+\+SEG} structure with the given parameters and defaults.


\begin{DoxyParams}{Parameters}
{\em i\+Zm} & Initialized toolkit context. \\
\hline
{\em start\+\_\+x} & Inclusive x start index. \\
\hline
{\em end\+\_\+x} & Inclusive x end index. \\
\hline
{\em y\+\_\+str} & Segment index y as a decimal string. \\
\hline
{\em mr\+\_\+rounds} & Miller-\/\+Rabin rounds (0 uses default). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Initialized and partially processed segment, or NULL on failure.
\end{DoxyReturn}
Description:\+ This function allocates memory for a \doxylink{struct_v_x___s_e_g}{VX\+\_\+\+SEG} structure and initializes its members. The count is initialized to 0, and the p\+\_\+gaps array is allocated with an initial size of (vx/\+2).

Parameters:\+ 
\begin{DoxyParams}{Parameters}
{\em y\+\_\+str} & A character pointer representing a numeric string.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
VX\+\_\+\+SEG\texorpdfstring{$\ast$}{*} A pointer to the initialized \doxylink{struct_v_x___s_e_g}{VX\+\_\+\+SEG} structure. NULL if memory allocation fails or y\+\_\+str is not a numeric string. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00713}{713}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00088}{IZM::\+base\+\_\+x5}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00089}{IZM::\+base\+\_\+x7}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00198}{VX\+\_\+\+SEG::\+bit\+\_\+ops}}, \doxymbox{\hyperlink{bitmap_8c_source_l00382}{bitmap\+\_\+clone()}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00193}{VX\+\_\+\+SEG::\+end\+\_\+x}}, \doxymbox{\hyperlink{group__iz__logger_ga3dc3bd5ec0c013065ffc731ea33271d5}{log\+\_\+error()}}, \doxymbox{\hyperlink{utils_8h_source_l00052}{MAX}}, \doxymbox{\hyperlink{utils_8h_source_l00048}{MIN}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00079}{MR\+\_\+\+ROUNDS}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00191}{VX\+\_\+\+SEG::\+mr\+\_\+rounds}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00196}{VX\+\_\+\+SEG::\+p\+\_\+count}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00197}{VX\+\_\+\+SEG::\+p\+\_\+gaps}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00199}{VX\+\_\+\+SEG::\+p\+\_\+test\+\_\+ops}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00192}{VX\+\_\+\+SEG::\+start\+\_\+x}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00086}{IZM::\+vx}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00186}{VX\+\_\+\+SEG::\+vx}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00566}{vx\+\_\+det\+\_\+sieve()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00529}{vx\+\_\+set\+\_\+base\+\_\+values()}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00194}{VX\+\_\+\+SEG::\+x5}}, and \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00195}{VX\+\_\+\+SEG::\+x7}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00184}{Si\+Z\+\_\+count()}}, and \doxymbox{\hyperlink{i_z__apps_8c_source_l00035}{Si\+Z\+\_\+stream()}}.

\Hypertarget{group__iz__toolkit_ga02e061a03533010221ce47c043ddc53c}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!vx\_search\_prime@{vx\_search\_prime}}
\index{vx\_search\_prime@{vx\_search\_prime}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{vx\_search\_prime()}{vx\_search\_prime()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga02e061a03533010221ce47c043ddc53c} 
int vx\+\_\+search\+\_\+prime (\begin{DoxyParamCaption}\item[{mpz\+\_\+t}]{p}{, }\item[{int}]{m\+\_\+id}{, }\item[{int}]{vx}{, }\item[{int}]{bit\+\_\+size}{}\end{DoxyParamCaption})}



Horizontal i\+Zm/\+\+VX random-\/prime search. 

horizontal search routine for generating a random prime.


\begin{DoxyParams}{Parameters}
{\em p} & Output prime. \\
\hline
{\em m\+\_\+id} & Requested line id (-\/1, +1, or random when other value). \\
\hline
{\em vx} & Segment width. \\
\hline
{\em bit\+\_\+size} & Target bit size. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success, otherwise 0.
\end{DoxyReturn}
Description:\+ This function searches for a prime number using the given parameters. It combines the i\+Z-\/\+Matrix filtering techniques with the Miller-\/\+Rabin primality test. The search is performed by finding suitable x values that do not correspond to composites of primes that divide vx. Then, it iterates over y values in the equation p = iZ(x + vx \texorpdfstring{$\ast$}{*} y) until a prime is found.


\begin{DoxyParams}{Parameters}
{\em p} & The prime number found in the search. \\
\hline
{\em m\+\_\+id} & The identifier (1 or -\/1) for the iZ matrix. \\
\hline
{\em vx} & The horizontal vector of the iZ matrix. \\
\hline
{\em bit\+\_\+size} & The target bit size of the prime. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if a prime is found, 0 otherwise. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l01017}{1017}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{int__arrays_8h_source_l00043}{UI64\+\_\+\+ARRAY::\+array}}, \doxymbox{\hyperlink{bitmap_8c_source_l00210}{bitmap\+\_\+clear\+\_\+steps()}}, \doxymbox{\hyperlink{bitmap_8c_source_l00103}{bitmap\+\_\+free()}}, \doxymbox{\hyperlink{bitmap_8c_source_l00137}{bitmap\+\_\+get\+\_\+bit()}}, \doxymbox{\hyperlink{bitmap_8c_source_l00057}{bitmap\+\_\+init()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00153}{check\+\_\+primality()}}, \doxymbox{\hyperlink{int__arrays_8h_source_l00042}{UI64\+\_\+\+ARRAY::\+count}}, \doxymbox{\hyperlink{utils_8c_source_l00486}{gmp\+\_\+seed\+\_\+randstate()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00037}{i\+Z\+\_\+mpz()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00449}{i\+Zm\+\_\+solve\+\_\+for\+\_\+x0\+\_\+mpz()}}, \doxymbox{\hyperlink{group__iz__logger_ga3dc3bd5ec0c013065ffc731ea33271d5}{log\+\_\+error()}}, \doxymbox{\hyperlink{utils_8h_source_l00052}{MAX}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00079}{MR\+\_\+\+ROUNDS}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00516}{Si\+Zm()}}, and \doxymbox{\hyperlink{group__iz__arrays_gab1a0ced5e600649da6e519693a3a2851}{ui64\+\_\+free()}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00692}{vx\+\_\+random\+\_\+prime()}}.

\Hypertarget{group__iz__toolkit_ga591a1d1fae4f8a241c6b6ed7f495eae6}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!vx\_stream@{vx\_stream}}
\index{vx\_stream@{vx\_stream}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{vx\_stream()}{vx\_stream()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga591a1d1fae4f8a241c6b6ed7f495eae6} 
void vx\+\_\+stream (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}}]{vx\+\_\+obj}{, }\item[{FILE \texorpdfstring{$\ast$}{*}}]{output}{}\end{DoxyParamCaption})}



Stream segment primes to an output stream. 

Stream segment primes to an output stream in traversal order.


\begin{DoxyParams}{Parameters}
{\em vx\+\_\+obj} & Segment object. \\
\hline
{\em output} & Writable output stream (e.\+g. stdout or a file).\\
\hline
{\em vx\+\_\+obj} & Segment object. \\
\hline
{\em output} & Destination stream (stdout or file). \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00866}{866}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{bitmap_8c_source_l00159}{bitmap\+\_\+clear\+\_\+bit()}}, \doxymbox{\hyperlink{bitmap_8c_source_l00137}{bitmap\+\_\+get\+\_\+bit()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00153}{check\+\_\+primality()}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00190}{VX\+\_\+\+SEG::\+is\+\_\+large\+\_\+limit}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00037}{i\+Z\+\_\+mpz()}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00191}{VX\+\_\+\+SEG::\+mr\+\_\+rounds}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00196}{VX\+\_\+\+SEG::\+p\+\_\+count}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00199}{VX\+\_\+\+SEG::\+p\+\_\+test\+\_\+ops}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00192}{VX\+\_\+\+SEG::\+start\+\_\+x}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00194}{VX\+\_\+\+SEG::\+x5}}, \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00195}{VX\+\_\+\+SEG::\+x7}}, and \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00188}{VX\+\_\+\+SEG::\+yvx}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00035}{Si\+Z\+\_\+stream()}}.

\Hypertarget{group__iz__toolkit_ga58ea9ced15462006d8a8c223719c57f4}\index{Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}!vy\_search\_prime@{vy\_search\_prime}}
\index{vy\_search\_prime@{vy\_search\_prime}!Toolkit (iZ/iZm)@{Toolkit (iZ/iZm)}}
\doxysubsubsection{\texorpdfstring{vy\_search\_prime()}{vy\_search\_prime()}}
{\footnotesize\ttfamily \label{group__iz__toolkit_ga58ea9ced15462006d8a8c223719c57f4} 
int vy\+\_\+search\+\_\+prime (\begin{DoxyParamCaption}\item[{mpz\+\_\+t}]{p}{, }\item[{int}]{m\+\_\+id}{, }\item[{mpz\+\_\+t}]{vx}{}\end{DoxyParamCaption})}



Vertical i\+Zm/\+\+VY random-\/prime search. 

vertical search routine for generating a random prime.


\begin{DoxyParams}{Parameters}
{\em p} & Output prime. \\
\hline
{\em m\+\_\+id} & Requested line id (-\/1, +1, or random when other value). \\
\hline
{\em vx} & Segment width. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success, otherwise 0.
\end{DoxyReturn}
Description:\+ This function searches for a prime number using the given parameters. It combines the i\+Z-\/\+Matrix filtering techniques with the Miller-\/\+Rabin primality test. The search is performed by finding a suitable x value that does not correspond to a composite of a prime that divides vx. Then, it iterates over y value in the equation p = iZ(x + vx \texorpdfstring{$\ast$}{*} y, m\+\_\+id) until a prime is found.


\begin{DoxyParams}{Parameters}
{\em p} & The prime number found in the search. \\
\hline
{\em m\+\_\+id} & The identifier (1 or -\/1) for the iZ matrix. \\
\hline
{\em vx} & The horizontal vector of the iZ matrix. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if a prime is found, 0 otherwise. 
\end{DoxyReturn}


Definition at line \doxymbox{\hyperlink{i_z__toolkit_8c_source_l01114}{1114}} of file \doxymbox{\hyperlink{i_z__toolkit_8c_source}{i\+Z\+\_\+toolkit.\+c}}.



References \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00153}{check\+\_\+primality()}}, \doxymbox{\hyperlink{utils_8c_source_l00486}{gmp\+\_\+seed\+\_\+randstate()}}, \doxymbox{\hyperlink{i_z__toolkit_8c_source_l00037}{i\+Z\+\_\+mpz()}}, and \doxymbox{\hyperlink{i_z__toolkit_8h_source_l00079}{MR\+\_\+\+ROUNDS}}.



Referenced by \doxymbox{\hyperlink{i_z__apps_8c_source_l00545}{vy\+\_\+random\+\_\+prime()}}.

