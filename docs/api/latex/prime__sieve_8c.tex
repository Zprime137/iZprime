\doxysection{src/\+prime\+\_\+sieve.c File Reference}
\hypertarget{prime__sieve_8c}{}\label{prime__sieve_8c}\index{src/prime\_sieve.c@{src/prime\_sieve.c}}


Implementations of classical and Si\+Z-\/family sieve algorithms.  


{\ttfamily \+\#include $<$i\+Z\+\_\+api.\+h$>$}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\+\#define \doxymbox{\hyperlink{prime__sieve_8c_aaf657e07f12cadbbe7a6ef0c3b9989f6}{N\+\_\+\+LIMIT}}~(1000000000000\+ULL)
\item 
\+\#define \doxymbox{\hyperlink{prime__sieve_8c_a2c99a620ba05d3c43fe2b6be2ea15a84}{ASSERT\+\_\+\+LIMIT}}(n)
\begin{DoxyCompactList}\small\item\em Assert that input n is within the valid range for sieve functions. \end{DoxyCompactList}\item 
\+\#define \doxymbox{\hyperlink{prime__sieve_8c_a3ff2231038faa777a7ae5660b1b06c89}{Pi}}(n)
\begin{DoxyCompactList}\small\item\em \doxylink{prime__sieve_8c_a3ff2231038faa777a7ae5660b1b06c89}{Pi(n)} is an approximation of the number of primes up to n, used for initial array sizing. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \doxymbox{\hyperlink{prime__sieve_8c_aad4755932b94cb8d5e3049984b515ead}{process\+\_\+\+N\+\_\+bitmap}} (\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*}primes, \doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}sieve\+\_\+bitmap, uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em A helper function to process the bitmap for the Sieve of Eratosthenes and collect primes. \end{DoxyCompactList}\end{DoxyCompactItemize}
\begin{Indent}\textbf{ Classic Prime Sieve Algorithms}\par
{\em Baseline sieves up to a numeric limit.

All classic sieve functions take a limit {\ttfamily n} and return an ascending list of primes \texorpdfstring{$<$}{<}= {\ttfamily n}. }\begin{DoxyCompactItemize}
\item 
\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__api_ga2df5338a07925f1aee4b301565a8b489}{SoE}} (uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em Optimized Sieve of Eratosthenes. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__api_ga51ffe428b73f193100ff6a1275c2c57f}{SSoE}} (uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em Segmented Sieve of Eratosthenes. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__api_ga41adac38b8d9dea30778f1286417c1ed}{So\+Eu}} (uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em Euler (linear) sieve. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__api_gab82ab3c7dbaa78d3da0338a405b84108}{SoS}} (uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em Sieve of Sundaram. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__api_ga415d41154325d73e264c51cebd4ab628}{SoA}} (uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em Sieve of Atkin. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ i\+Z-\/based Sieve Algorithms}\par
{\em Sieve family operating in the 6x-\/1 /\+ 6x+1 index space. }\begin{DoxyCompactItemize}
\item 
\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__api_gaeff7d8923d54b5d606c51301bc9bc0e7}{SiZ}} (uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em Solid Sieve-\/iZ (wheel 6, iZ index space). \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__api_ga9ca94c578547d87c05b381034897f3a6}{Si\+Zm}} (uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em Segmented Sieve-\/i\+Zm (VX segmented, horizontal processing). \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__api_ga1119ed76482796d548cee4f5a3ab8c06}{Si\+Zm\+\_\+vy}} (uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em Segmented Sieve-\/i\+Zm (vertical processing; faster, unordered output). \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}


\doxysubsection{Detailed Description}
Implementations of classical and Si\+Z-\/family sieve algorithms. 

This file contains the implementations of various prime sieving algorithms, including classical algorithms (So\+E/\+\+SSo\+E/\+\+So\+Eu/\+\+So\+S/\+\+SoA) as well as Si\+Z-\/family algorithms (Si\+Z/\+\+Si\+Zm/\+\+Si\+Zm\+\_\+vy). All functions are single-\/threaded, take an upper limit {\ttfamily n} and return a pointer to a \doxylink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY} containing the prime numbers up to {\ttfamily n}. 

Definition in file \doxymbox{\hyperlink{prime__sieve_8c_source}{prime\+\_\+sieve.\+c}}.



\label{doc-define-members}
\Hypertarget{prime__sieve_8c_doc-define-members}
\doxysubsection{Macro Definition Documentation}
\Hypertarget{prime__sieve_8c_a2c99a620ba05d3c43fe2b6be2ea15a84}\index{prime\_sieve.c@{prime\_sieve.c}!ASSERT\_LIMIT@{ASSERT\_LIMIT}}
\index{ASSERT\_LIMIT@{ASSERT\_LIMIT}!prime\_sieve.c@{prime\_sieve.c}}
\doxysubsubsection{\texorpdfstring{ASSERT\_LIMIT}{ASSERT\_LIMIT}}
{\footnotesize\ttfamily \label{prime__sieve_8c_a2c99a620ba05d3c43fe2b6be2ea15a84} 
\+\#define ASSERT\+\_\+\+LIMIT(\begin{DoxyParamCaption}\item[{}]{n}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{assert((n)\ >\ 10\ \&\&\ (n)\ <=\ \doxymbox{\hyperlink{prime__sieve_8c_aaf657e07f12cadbbe7a6ef0c3b9989f6}{N\_LIMIT}}\ \&\&\ \textcolor{stringliteral}{"{}Input\ must\ be\ in\ the\ range\ (10,\ 10\string^12)."{}})}

\end{DoxyCode}


Assert that input n is within the valid range for sieve functions. 



Definition at line \doxymbox{\hyperlink{prime__sieve_8c_source_l00023}{23}} of file \doxymbox{\hyperlink{prime__sieve_8c_source}{prime\+\_\+sieve.\+c}}.



Referenced by \doxymbox{\hyperlink{prime__sieve_8c_source_l00444}{Si\+Z()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00516}{Si\+Zm()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00623}{Si\+Zm\+\_\+vy()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00328}{So\+A()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00072}{So\+E()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00200}{So\+Eu()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00264}{So\+S()}}, and \doxymbox{\hyperlink{prime__sieve_8c_source_l00114}{SSo\+E()}}.

\Hypertarget{prime__sieve_8c_aaf657e07f12cadbbe7a6ef0c3b9989f6}\index{prime\_sieve.c@{prime\_sieve.c}!N\_LIMIT@{N\_LIMIT}}
\index{N\_LIMIT@{N\_LIMIT}!prime\_sieve.c@{prime\_sieve.c}}
\doxysubsubsection{\texorpdfstring{N\_LIMIT}{N\_LIMIT}}
{\footnotesize\ttfamily \label{prime__sieve_8c_aaf657e07f12cadbbe7a6ef0c3b9989f6} 
\+\#define N\+\_\+\+LIMIT~(1000000000000\+ULL)}

Maximum supported sieve limit for standard entry points (10\texorpdfstring{$^\wedge$}{\string^}12). 

Definition at line \doxymbox{\hyperlink{prime__sieve_8c_source_l00020}{20}} of file \doxymbox{\hyperlink{prime__sieve_8c_source}{prime\+\_\+sieve.\+c}}.

\Hypertarget{prime__sieve_8c_a3ff2231038faa777a7ae5660b1b06c89}\index{prime\_sieve.c@{prime\_sieve.c}!Pi@{Pi}}
\index{Pi@{Pi}!prime\_sieve.c@{prime\_sieve.c}}
\doxysubsubsection{\texorpdfstring{Pi}{Pi}}
{\footnotesize\ttfamily \label{prime__sieve_8c_a3ff2231038faa777a7ae5660b1b06c89} 
\+\#define Pi(\begin{DoxyParamCaption}\item[{}]{n}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{((n\ /\ log(n)))}

\end{DoxyCode}


\doxylink{prime__sieve_8c_a3ff2231038faa777a7ae5660b1b06c89}{Pi(n)} is an approximation of the number of primes up to n, used for initial array sizing. 



Definition at line \doxymbox{\hyperlink{prime__sieve_8c_source_l00026}{26}} of file \doxymbox{\hyperlink{prime__sieve_8c_source}{prime\+\_\+sieve.\+c}}.



Referenced by \doxymbox{\hyperlink{prime__sieve_8c_source_l00444}{Si\+Z()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00516}{Si\+Zm()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00623}{Si\+Zm\+\_\+vy()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00328}{So\+A()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00072}{So\+E()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00200}{So\+Eu()}}, \doxymbox{\hyperlink{prime__sieve_8c_source_l00264}{So\+S()}}, and \doxymbox{\hyperlink{prime__sieve_8c_source_l00114}{SSo\+E()}}.



\label{doc-func-members}
\Hypertarget{prime__sieve_8c_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{prime__sieve_8c_aad4755932b94cb8d5e3049984b515ead}\index{prime\_sieve.c@{prime\_sieve.c}!process\_N\_bitmap@{process\_N\_bitmap}}
\index{process\_N\_bitmap@{process\_N\_bitmap}!prime\_sieve.c@{prime\_sieve.c}}
\doxysubsubsection{\texorpdfstring{process\_N\_bitmap()}{process\_N\_bitmap()}}
{\footnotesize\ttfamily \label{prime__sieve_8c_aad4755932b94cb8d5e3049984b515ead} 
void process\+\_\+\+N\+\_\+bitmap (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*}}]{primes}{, }\item[{\doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}}]{sieve\+\_\+bitmap}{, }\item[{uint64\+\_\+t}]{n}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



A helper function to process the bitmap for the Sieve of Eratosthenes and collect primes. 


\begin{DoxyParams}{Parameters}
{\em primes} & Output prime array. \\
\hline
{\em sieve\+\_\+bitmap} & Candidate bitmap. \\
\hline
{\em n} & Inclusive numeric upper bound represented in {\ttfamily sieve\+\_\+bitmap}. \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{prime__sieve_8c_source_l00038}{38}} of file \doxymbox{\hyperlink{prime__sieve_8c_source}{prime\+\_\+sieve.\+c}}.



References \doxymbox{\hyperlink{bitmap_8c_source_l00233}{bitmap\+\_\+clear\+\_\+steps\+\_\+simd()}}, \doxymbox{\hyperlink{bitmap_8c_source_l00137}{bitmap\+\_\+get\+\_\+bit()}}, and \doxymbox{\hyperlink{group__iz__arrays_ga51cf8a13f4a4ae5c076a1be3a3333a68}{ui64\+\_\+push()}}.



Referenced by \doxymbox{\hyperlink{prime__sieve_8c_source_l00072}{So\+E()}}, and \doxymbox{\hyperlink{prime__sieve_8c_source_l00114}{SSo\+E()}}.

