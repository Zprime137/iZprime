\doxysection{include/\+i\+Z\+\_\+toolkit.h File Reference}
\hypertarget{i_z__toolkit_8h}{}\label{i_z__toolkit_8h}\index{include/iZ\_toolkit.h@{include/iZ\_toolkit.h}}


Core i\+Z/\+i\+Zm primitives used by Si\+Z-\/family algorithms.  


{\ttfamily \+\#include $<$utils.\+h$>$}\newline
{\ttfamily \+\#include $<$int\+\_\+arrays.\+h$>$}\newline
{\ttfamily \+\#include $<$bitmap.\+h$>$}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \doxymbox{\hyperlink{struct_i_z_m}{IZM}}
\begin{DoxyCompactList}\small\item\em Precomputed i\+Zm assets for repeated VX-\/segment sieving. \end{DoxyCompactList}\item 
struct \doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}}
\begin{DoxyCompactList}\small\item\em Runtime state for one VX segment at a specific y. \end{DoxyCompactList}\item 
struct \doxymbox{\hyperlink{struct_i_z_m___r_a_n_g_e___i_n_f_o}{IZM\+\_\+\+RANGE\+\_\+\+INFO}}
\begin{DoxyCompactList}\small\item\em Precomputed i\+Zm coordinates for an inclusive numeric interval. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_gaa00f10dbfb5d0730503a789900de9134}{MR\+\_\+\+ROUNDS}}~25
\end{DoxyCompactItemize}
\begin{Indent}\textbf{ Standard VX Sizes (primorial products excluding 2,3)}\par
\begin{DoxyCompactItemize}
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_ga6a2cce58f5622e3d2b97c2dd251aade1}{VX2}}~(5 \texorpdfstring{$\ast$}{*} 7ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_ga5272963aed063a5501e96731a4dc2334}{VX3}}~(\doxymbox{\hyperlink{group__iz__toolkit_ga6a2cce58f5622e3d2b97c2dd251aade1}{VX2}} \texorpdfstring{$\ast$}{*} 11ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_gad288993421c2fa2e3d37d449cc0134c9}{VX4}}~(\doxymbox{\hyperlink{group__iz__toolkit_ga5272963aed063a5501e96731a4dc2334}{VX3}} \texorpdfstring{$\ast$}{*} 13ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_ga70f1e9557da83099d06828cc5d9719b0}{VX5}}~(\doxymbox{\hyperlink{group__iz__toolkit_gad288993421c2fa2e3d37d449cc0134c9}{VX4}} \texorpdfstring{$\ast$}{*} 17ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_ga7510fdd07a68973d711e47ff3296e3ba}{VX6}}~(\doxymbox{\hyperlink{group__iz__toolkit_ga70f1e9557da83099d06828cc5d9719b0}{VX5}} \texorpdfstring{$\ast$}{*} 19ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_gac9b1091e8f0d8749a07c83b66d559ff4}{VX7}}~(\doxymbox{\hyperlink{group__iz__toolkit_ga7510fdd07a68973d711e47ff3296e3ba}{VX6}} \texorpdfstring{$\ast$}{*} 23ULL)
\item 
\+\#define \doxymbox{\hyperlink{group__iz__toolkit_ga2c3010de7df0076f6693afe35114c236}{VX8}}~(\doxymbox{\hyperlink{group__iz__toolkit_gac9b1091e8f0d8749a07c83b66d559ff4}{VX7}} \texorpdfstring{$\ast$}{*} 29ULL)
\end{DoxyCompactItemize}
\end{Indent}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \doxymbox{\hyperlink{group__iz__toolkit_gacf776a7cedd726d8362aaf344102365d}{i\+Zm\+\_\+construct\+\_\+vx\+\_\+base}} (uint64\+\_\+t vx, \doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}base\+\_\+x5, \doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}base\+\_\+x7)
\begin{DoxyCompactList}\small\item\em Build pre-\/sieved base bitmaps for a VX segment. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_i_z_m___r_a_n_g_e___i_n_f_o}{IZM\+\_\+\+RANGE\+\_\+\+INFO}} \doxymbox{\hyperlink{group__iz__toolkit_ga5ada19be750a6f9b0837805ef34a1de4}{range\+\_\+info\+\_\+init}} (\doxymbox{\hyperlink{struct_i_n_p_u_t___s_i_e_v_e___r_a_n_g_e}{INPUT\+\_\+\+SIEVE\+\_\+\+RANGE}} \texorpdfstring{$\ast$}{*}input\+\_\+range, int vx)
\begin{DoxyCompactList}\small\item\em Map a decimal range input into i\+Zm coordinates and segment bounds. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_gab053af28699e3138640445b16a1311f7}{range\+\_\+info\+\_\+free}} (\doxymbox{\hyperlink{struct_i_z_m___r_a_n_g_e___i_n_f_o}{IZM\+\_\+\+RANGE\+\_\+\+INFO}} \texorpdfstring{$\ast$}{*}info)
\begin{DoxyCompactList}\small\item\em Clear all GMP fields owned by {\ttfamily info}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\begin{Indent}\textbf{ iZ Mapping Helpers}\par
\begin{DoxyCompactItemize}
\item 
uint64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_gaffec7a5b407ee6c59ccc1678e0ab89ba}{iZ}} (uint64\+\_\+t x, int i)
\begin{DoxyCompactList}\small\item\em Map iZ coordinates to an integer:\+ {\ttfamily 6\texorpdfstring{$\ast$}{*}x + i}. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_gaa3f0472ebd680beaa6b0759acbedd9eb}{i\+Z\+\_\+mpz}} (mpz\+\_\+t z, mpz\+\_\+t x, int i)
\begin{DoxyCompactList}\small\item\em GMP variant of \doxylink{group__iz__toolkit_gaffec7a5b407ee6c59ccc1678e0ab89ba}{i\+Z()}. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga865e51a5e6f28945747e2ad6988c2e4e}{process\+\_\+i\+Z\+\_\+bitmaps}} (\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*}primes, \doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}x5, \doxymbox{\hyperlink{struct_b_i_t_m_a_p}{BITMAP}} \texorpdfstring{$\ast$}{*}x7, uint64\+\_\+t x\+\_\+limit)
\begin{DoxyCompactList}\small\item\em Traverse iZ bitmaps, emit surviving primes, and mark composites. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_gadc4e21760e38081c6966fa9d9d23e940}{get\+\_\+root\+\_\+primes}} (\doxymbox{\hyperlink{struct_u_i64___a_r_r_a_y}{UI64\+\_\+\+ARRAY}} \texorpdfstring{$\ast$}{*}primes, uint64\+\_\+t limit)
\begin{DoxyCompactList}\small\item\em Generate primes up to {\ttfamily limit} for deterministic sieving. \end{DoxyCompactList}\item 
int \doxymbox{\hyperlink{group__iz__toolkit_ga1dbb019b08a42984e1733f0c7c3881a0}{check\+\_\+primality}} (mpz\+\_\+t n, int rounds)
\begin{DoxyCompactList}\small\item\em Check the primality of a number using GMP\textquotesingle{}s probabilistic test. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ IZM Lifecycle}\par
\begin{DoxyCompactItemize}
\item 
\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__toolkit_gaeb29a4d0536bb0aa227e230539081d98}{i\+Zm\+\_\+init}} (size\+\_\+t vx)
\begin{DoxyCompactList}\small\item\em Allocate and initialize an \doxylink{struct_i_z_m}{IZM} object for a given VX. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__toolkit_gaa8c21336f708189a8d18f41085468c5c}{i\+Zm\+\_\+clone}} (\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*}src)
\begin{DoxyCompactList}\small\item\em Deep-\/copy an \doxylink{struct_i_z_m}{IZM} object for per-\/worker ownership. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga81a316b2719f678e9fbc4ac8c835460c}{i\+Zm\+\_\+free}} (\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}i\+Zm)
\begin{DoxyCompactList}\small\item\em Release an \doxylink{struct_i_z_m}{IZM} object and set the caller pointer to NULL. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ VX Selection Helpers}\par
\begin{DoxyCompactItemize}
\item 
uint64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_ga6170b19f9022bf256850f1f2ee6dd786}{compute\+\_\+vx\+\_\+k}} (int k)
\begin{DoxyCompactList}\small\item\em Calculate VX\+\_\+\{ {\ttfamily k} \}. \end{DoxyCompactList}\item 
uint64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_gac92eb547227979fc0774e0529efa6180}{compute\+\_\+l2\+\_\+vx}} (uint64\+\_\+t n)
\begin{DoxyCompactList}\small\item\em Choose VX using an L2-\/cache-\/aware heuristic. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga23df437281a4315af3cff9b76fab9dd8}{compute\+\_\+max\+\_\+vx}} (mpz\+\_\+t vx, int bit\+\_\+size)
\begin{DoxyCompactList}\small\item\em Compute largest VX below 2\texorpdfstring{$^\wedge$}{\string^}bit\+\_\+size. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ Modular Hit Solvers}\par
\begin{DoxyCompactItemize}
\item 
uint64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_ga596920e4772d76fe9dc61a541b282275}{i\+Zm\+\_\+solve\+\_\+for\+\_\+x0}} (int m\+\_\+id, uint64\+\_\+t p, uint64\+\_\+t vx, uint64\+\_\+t y)
\begin{DoxyCompactList}\small\item\em Solve first x-\/hit of prime {\ttfamily p} for line {\ttfamily m\+\_\+id} in segment y. \end{DoxyCompactList}\item 
uint64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_ga3ee0fd9e3f27fd5d30fddfe7d1056c57}{i\+Zm\+\_\+solve\+\_\+for\+\_\+x0\+\_\+mpz}} (int m\+\_\+id, uint64\+\_\+t p, uint64\+\_\+t vx, mpz\+\_\+t y)
\begin{DoxyCompactList}\small\item\em GMP variant of \doxylink{group__iz__toolkit_ga596920e4772d76fe9dc61a541b282275}{i\+Zm\+\_\+solve\+\_\+for\+\_\+x0()} for very large y. \end{DoxyCompactList}\item 
int64\+\_\+t \doxymbox{\hyperlink{group__iz__toolkit_ga50cf18d6528c411820a9b081b13875ca}{i\+Zm\+\_\+solve\+\_\+for\+\_\+y0}} (int m\+\_\+id, uint64\+\_\+t p, uint64\+\_\+t vx, uint64\+\_\+t x)
\begin{DoxyCompactList}\small\item\em Solve first y-\/hit for fixed x in vertical (vy) scanning. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ VX Segment Lifecycle and Execution}\par
\begin{DoxyCompactItemize}
\item 
\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{group__iz__toolkit_ga234719b01a0e090a1f66ed7766fe6d0f}{vx\+\_\+init}} (\doxymbox{\hyperlink{struct_i_z_m}{IZM}} \texorpdfstring{$\ast$}{*}i\+Zm, int start\+\_\+x, int end\+\_\+x, char \texorpdfstring{$\ast$}{*}y\+\_\+str, int mr\+\_\+rounds)
\begin{DoxyCompactList}\small\item\em Initialize and deterministically sieve one VX segment. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga89a2804cb4fa979a32e4213ade786ec4}{vx\+\_\+free}} (\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}vx\+\_\+obj)
\begin{DoxyCompactList}\small\item\em Free a VX segment and all owned resources. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga824821f174cc26db2d310a68e8c2f19e}{vx\+\_\+collect\+\_\+p\+\_\+gaps}} (\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}vx\+\_\+obj)
\begin{DoxyCompactList}\small\item\em Extract prime-\/gap encoding from a fully sieved segment. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga214f95ac7b685a7ff0c596afc70036b7}{vx\+\_\+full\+\_\+sieve}} (\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}vx\+\_\+obj, int collect\+\_\+p\+\_\+gaps)
\begin{DoxyCompactList}\small\item\em Complete segment processing (probabilistic stage and optional gaps). \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__iz__toolkit_ga591a1d1fae4f8a241c6b6ed7f495eae6}{vx\+\_\+stream}} (\doxymbox{\hyperlink{struct_v_x___s_e_g}{VX\+\_\+\+SEG}} \texorpdfstring{$\ast$}{*}vx\+\_\+obj, FILE \texorpdfstring{$\ast$}{*}output)
\begin{DoxyCompactList}\small\item\em Stream segment primes to an output stream. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ Random Prime Search Routines}\par
\begin{DoxyCompactItemize}
\item 
int \doxymbox{\hyperlink{group__iz__toolkit_ga02e061a03533010221ce47c043ddc53c}{vx\+\_\+search\+\_\+prime}} (mpz\+\_\+t p, int m\+\_\+id, int vx, int bit\+\_\+size)
\begin{DoxyCompactList}\small\item\em Horizontal i\+Zm/\+\+VX random-\/prime search. \end{DoxyCompactList}\item 
int \doxymbox{\hyperlink{group__iz__toolkit_ga58ea9ced15462006d8a8c223719c57f4}{vy\+\_\+search\+\_\+prime}} (mpz\+\_\+t p, int m\+\_\+id, mpz\+\_\+t vx)
\begin{DoxyCompactList}\small\item\em Vertical i\+Zm/\+\+VY random-\/prime search. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ Toolkit Tests}\par
\begin{DoxyCompactItemize}
\item 
int {\bfseries TEST\+\_\+\+IZM} (int verbose)
\begin{DoxyCompactList}\small\item\em Run \doxylink{struct_i_z_m}{IZM} construction and solver tests. \end{DoxyCompactList}\item 
int {\bfseries TEST\+\_\+\+VX\+\_\+\+SEG} (int verbose)
\begin{DoxyCompactList}\small\item\em Run VX segment tests. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}


\doxysubsection{Detailed Description}
Core i\+Z/\+i\+Zm primitives used by Si\+Z-\/family algorithms. 

This layer exposes index-\/space mapping helpers, VX sizing utilities, pre-\/sieved i\+Zm base construction, per-\/segment sieve objects, and internal prime-\/search routines used by high-\/level APIs in \doxylink{i_z__api_8h}{i\+Z\+\_\+api.\+h}. 

Definition in file \doxymbox{\hyperlink{i_z__toolkit_8h_source}{i\+Z\+\_\+toolkit.\+h}}.

